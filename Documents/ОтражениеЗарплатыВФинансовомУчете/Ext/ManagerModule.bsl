#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// СтандартныеПодсистемы.ВерсионированиеОбъектов

// Определяет настройки объекта для подсистемы ВерсионированиеОбъектов.
//
// Параметры:
//  Настройки - Структура - настройки подсистемы.
Процедура ПриОпределенииНастроекВерсионированияОбъектов(Настройки) Экспорт

КонецПроцедуры

// Конец СтандартныеПодсистемы.ВерсионированиеОбъектов

// Заполняет список команд создания на основании.
// 
// Параметры:
//   КомандыСоздатьНаОсновании - ТаблицаЗначений - состав полей см. в функции ВводНаОсновании.СоздатьКоллекциюКомандСоздатьНаОсновании
//
Процедура ДобавитьКомандыСозданияНаОсновании(КомандыСоздатьНаОсновании) Экспорт



КонецПроцедуры

// Заполняет список команд создания на основании.
// 
// Параметры:
//   КомандыСоздатьНаОсновании - ТаблицаЗначений - состав полей см. в функции ВводНаОсновании.СоздатьКоллекциюКомандСоздатьНаОсновании
//
// Возвращаемое значение:
//   КомандыСоздатьНаОсновании - ТаблицаЗначений - состав полей см. в функции ВводНаОсновании.СоздатьКоллекциюКомандСоздатьНаОсновании
//
Функция ДобавитьКомандуСоздатьНаОсновании(КомандыСоздатьНаОсновании) Экспорт
	
	Если ПравоДоступа("Добавление", Метаданные.Документы.ОтражениеЗарплатыВФинансовомУчете) Тогда
		
		КомандаСоздатьНаОсновании = КомандыСоздатьНаОсновании.Добавить();
		КомандаСоздатьНаОсновании.Идентификатор = Метаданные.Документы.ОтражениеЗарплатыВФинансовомУчете.ПолноеИмя();
		КомандаСоздатьНаОсновании.Представление = ВводНаОсновании.ПредставлениеОбъекта(Метаданные.Документы.ОтражениеЗарплатыВФинансовомУчете);
		КомандаСоздатьНаОсновании.ПроверкаПроведенияПередСозданиемНаОсновании = Истина;
		КомандаСоздатьНаОсновании.ФункциональныеОпции = "ИспользоватьРасчетЗарплатыРасширенная,УправлениеПредприятием,КомплекснаяАвтоматизация";
		
		Возврат КомандаСоздатьНаОсновании;
		
	КонецЕсли;
	
	Возврат Неопределено;
	
КонецФункции

// Формирует документ отражения зарплаты за период по указанной организации. Вызывается
// при автоматическом выполнении операций закрытия месяца.
// 
// Параметры:
//   Организации - СправочникСсылка.Организации - Организация, по которой формируется документ
//   Период - Дата - Период, за который формируется документ
//
Процедура ОтражениеЗарплатыПриЗакрытииМесяца(Организации, Период) Экспорт
	
	Если Не ПолучитьФункциональнуюОпцию("ИспользоватьНачислениеЗарплатыУТ") Тогда
		Возврат;
	КонецЕсли;
	
	ПроверитьБлокировкуВходящихДанныхПриОбновленииИБ(НСтр("ru='Отражение зарплаты при закрытии месяца'"));
	
	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	ОтражениеЗарплатыВФинансовомУчете.Ссылка КАК Ссылка,
	|	ОтражениеЗарплатыВФинансовомУчете.Организация КАК Организация,
	|	ОтражениеЗарплатыВФинансовомУчете.Проведен КАК Проведен
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете КАК ОтражениеЗарплатыВФинансовомУчете
	|ГДЕ
	|	(ОтражениеЗарплатыВФинансовомУчете.Организация В(&Организации) ИЛИ &ПоВсемОрганизациям)
	|	И НАЧАЛОПЕРИОДА(ОтражениеЗарплатыВФинансовомУчете.ПериодРегистрации, МЕСЯЦ) = &НачалоМесяца
	|	И НЕ ОтражениеЗарплатыВФинансовомУчете.ПометкаУдаления
	|
	|УПОРЯДОЧИТЬ ПО
	|	Организация,
	|	Проведен УБЫВ");
	
	Запрос.УстановитьПараметр("Организации", Организации);
	Запрос.УстановитьПараметр("ПоВсемОрганизациям", НЕ ЗначениеЗаполнено(Организации));
	Запрос.УстановитьПараметр("НачалоМесяца", НачалоМесяца(Период));
	
	СуществующиеДокументы = Запрос.Выполнить().Выбрать();
	
	Для Каждого Организация Из Организации Цикл
		
		ДокументыПоОрганизацииОбработаны = Ложь;
		
		ДокументОбъект = Неопределено;
		
		СуществующиеДокументы.Сбросить();
		
		Пока СуществующиеДокументы.НайтиСледующий(Новый Структура("Организация, Проведен", Организация, Истина)) Цикл
			
			ДокументОбъект = СуществующиеДокументы.Ссылка.ПолучитьОбъект();
			
			Если ДокументОбъект.ПроверитьЗаполнение() Тогда
				ДокументОбъект.Записать(РежимЗаписиДокумента.Проведение);
			КонецЕсли;
			
			ДокументыПоОрганизацииОбработаны = Истина;
			
		КонецЦикла;
		
		Если ДокументыПоОрганизацииОбработаны Тогда
			Продолжить;
		КонецЕсли;
		
		СуществующиеДокументы.Сбросить();
		
		Если СуществующиеДокументы.НайтиСледующий(Новый Структура("Организация, Проведен", Организация, Ложь)) Тогда
			ДокументОбъект = СуществующиеДокументы.Ссылка.ПолучитьОбъект();
			ДокументОбъект.НачисленнаяЗарплатаИВзносы.Очистить();
			ДокументОбъект.НачисленнаяЗарплатаИВзносыПоФизлицам.Очистить();
			ДокументОбъект.НачисленныйНДФЛ.Очистить();
			ДокументОбъект.УдержаннаяЗарплата.Очистить();
			ДокументОбъект.ФизическиеЛица.Очистить();
			ДокументОбъект.Записать(РежимЗаписиДокумента.Запись);
		КонецЕсли;;
		
		Если ДокументОбъект = Неопределено Тогда
			ДокументОбъект = Документы.ОтражениеЗарплатыВФинансовомУчете.СоздатьДокумент();
		КонецЕсли;
		
		ДокументОбъект.Заполнить(Неопределено);
		ДокументОбъект.Организация = Организация;
		ДокументОбъект.ПериодРегистрации = НачалоМесяца(Период);
		ДокументОбъект.Дата = КонецМесяца(Период);
		ДокументОбъект.Сводно = Ложь;
		
		// Заполнение табличных частей
		
		СтруктураПараметров = Новый Структура("Организация, ПериодРегистрации", ДокументОбъект.Организация, ДокументОбъект.ПериодРегистрации);
		
		СписокТаблиц = Новый СписокЗначений;
		СписокТаблиц.Добавить("НачисленнаяЗарплатаИВзносы",  Нстр("ru = 'Начисленная зарплата и взносы'"));
		СписокТаблиц.Добавить("НачисленныйНДФЛ",             Нстр("ru = 'Начисленый НДФЛ'"));
		СписокТаблиц.Добавить("УдержаннаяЗарплата",          Нстр("ru = 'Удержанная зарплата'"));
		СписокТаблиц.Добавить("НачисленныеПроцентыПоЗаймам", Нстр("ru = 'Начисленные проценты по займам'"));
		
		СтрокаСписокТаблиц = "НачисленнаяЗарплатаИВзносы, НачисленныйНДФЛ, УдержаннаяЗарплата, НачисленныеПроцентыПоЗаймам";
		
		СтруктураПараметров.Вставить("СтрокаСписокТаблиц", СтрокаСписокТаблиц);
		СтруктураПараметров.Вставить("СписокТаблиц", СписокТаблиц);
		
		АдресХранилища = ПоместитьВоВременноеХранилище(Неопределено);
		ПодготовитьДанныеДляЗаполнения(СтруктураПараметров, АдресХранилища);
		
		Результат = Новый Структура;
		Результат.Вставить("АдресХранилища", АдресХранилища);
		Результат.Вставить("СтрокаСписокТаблиц", СтрокаСписокТаблиц);
		Результат.Вставить("СписокТаблиц", СписокТаблиц);
		Результат.Вставить("ТекстОповещения", );
		Результат.Вставить("ПояснениеОповещения", );
		Результат.Вставить("ЕстьДанныеДляЗаполнения", Ложь);
		Результат.Вставить("Сводно", ДокументОбъект.Сводно);
		Результат.Вставить("ЗаполнятьАналитики", Истина);
		
		ЗаполнениеПослеВыполненияДлительнойОперации(ДокументОбъект, Результат);
		
		Если ДокументОбъект.НачисленнаяЗарплатаИВзносы.Количество() = 0 И
			ДокументОбъект.НачисленныйНДФЛ.Количество() = 0 И
			ДокументОбъект.УдержаннаяЗарплата.Количество() = 0 И
			ДокументОбъект.НачисленныеПроцентыПоЗаймам.Количество() = 0 Тогда
			
			Продолжить;
		КонецЕсли;
		
		ДокументОбъект.Записать(РежимЗаписиДокумента.Запись);
		
		Если ДокументОбъект.ПроверитьЗаполнение() Тогда
			ДокументОбъект.Записать(РежимЗаписиДокумента.Проведение);
		КонецЕсли;
		
	КонецЦикла;
	
КонецПроцедуры

// Возвращает строку с наименованием колонок взносов, через запятую.
// 
// Возвращаемое значение:
//   Строка - строка колонок для суммирования, перечисленных через запятую.
//
Функция КолонкиДляСуммирования(ВключатьФССНС = Истина) Экспорт
	
	// 4D:ERP для Беларуси, Яна, 04.09.2017 10:42:40 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	//Результат = "ПФРСтраховая, ПФРНакопительная, ПФРПоСуммарномуТарифу, ПФРСПревышения, ПФРДоПредельнойВеличины,
	//	|ФСС, ФФОМС, ТФОМС, ПФРНаДоплатуЛетчикам, ПФРНаДоплатуШахтерам, ПФРЗаЗанятыхНаПодземныхИВредныхРаботах,
	//	|ПФРЗаЗанятыхНаТяжелыхИПрочихРаботах,
	//	|ПФРЗаЗанятыхНаПодземныхИВредныхРаботахБезСпецОценки, ПФРЗаЗанятыхНаПодземныхИВредныхРаботахСпецОценка,
	//	|ПФРЗаЗанятыхНаТяжелыхИПрочихРаботахБезСпецОценки, ПФРЗаЗанятыхНаТяжелыхИПрочихРаботахСпецОценка";
	//
	//Если ВключатьФССНС Тогда
	//	Результат = Результат + ", ФССНесчастныеСлучаи";
	//КонецЕсли;
	//
	//Возврат Результат;
	Возврат "ФСЗН, Белгосстрах";
	// }
	// 4D
	
КонецФункции

// Процедура заполняет структуру данных для заполнения документа отражения зарплаты.
// 
// Параметры:
//   СтруктураПараметров - Структура - параметры заполнения, содержит имена таблиц, организацию и период регистрации.
//   АдресХранилища - Строка - Адрес хранилища для помещения результата заполнения.
//
Процедура ПодготовитьДанныеДляЗаполнения(СтруктураПараметров, АдресХранилища) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	ДанныеДляЗаполнения = Новый Структура;
	
	// получим отражение в учете
	УстановитьПривилегированныйРежим(Истина);
	ДанныеДляОтражения = ОтражениеЗарплатыВБухучете.ДанныеДляОтраженияЗарплатыВБухучете( 
		СтруктураПараметров.ПериодРегистрации,
		СтруктураПараметров.Организация,
		СтруктураПараметров.СтрокаСписокТаблиц);
	
	ВыделитьОтпускаЗаСчетОценочныхОбязательств(ДанныеДляОтражения, СтруктураПараметров);
	
	// удалим из списка таблиц к заполнению подразделений таблицу с НДФЛ
	ТаблицыДляЗаполненияПодразделений = СтрЗаменить(СтруктураПараметров.СтрокаСписокТаблиц, "НачисленныйНДФЛ","");
	ОрганизационнаяСтруктура.ДополнитьДанныеДокументаМестомВСтруктуреПредприятия(ДанныеДляОтражения, ТаблицыДляЗаполненияПодразделений);
	
	ИменаТаблиц = Новый Массив;
	ИменаТаблиц.Добавить("НачисленнаяЗарплатаИВзносы");
	ИменаТаблиц.Добавить("НачисленныйНДФЛ");
	ИменаТаблиц.Добавить("УдержаннаяЗарплата");
	
	Для Каждого ИмяТаблицы Из ИменаТаблиц Цикл
		
		Колонка = ДанныеДляОтражения[ИмяТаблицы].Колонки.Найти("МестоВСтруктуреПредприятия");
		
		Если Колонка <> Неопределено Тогда
			Колонка.Имя = "ПодразделениеПредприятия";
		Иначе
			ДанныеДляОтражения[ИмяТаблицы].Колонки.Добавить(
				"ПодразделениеПредприятия", Новый ОписаниеТипов("СправочникСсылка.СтруктураПредприятия"));
		КонецЕсли;
		
		КолонкаПодразделение = ДанныеДляОтражения[ИмяТаблицы].Колонки.Найти("Подразделение");
		Если КолонкаПодразделение <> Неопределено Тогда
			ДанныеДляОтражения[ИмяТаблицы].Колонки.Удалить(КолонкаПодразделение);
		КонецЕсли;
		
	КонецЦикла;
	
	ЗаполнитьПодразделениеПредприятияНачисленоСдельно(ДанныеДляОтражения, СтруктураПараметров);
	
	// Сведения о начисленных процентах по займам, погашенным через кассу или безналичным платежом.
	Если ДанныеДляОтражения.Свойство("УдержаннаяЗарплата") Тогда
		
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	&Организация КАК Организация,
		|	ВзаиморасчетыПоЗаймамСотрудникам.ФизическоеЛицо КАК ФизическоеЛицо,
		|	СУММА(ВзаиморасчетыПоЗаймамСотрудникам.Проценты) КАК Сумма,
		|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоПроцентовПоЗайму) КАК ВидОперации,
		|	ВзаиморасчетыПоЗаймамСотрудникам.Регистратор.Подразделение КАК ПодразделениеПредприятия
		|ИЗ
		|	РегистрНакопления.ВзаиморасчетыПоЗаймамСотрудникам КАК ВзаиморасчетыПоЗаймамСотрудникам
		|ГДЕ
		|	ВзаиморасчетыПоЗаймамСотрудникам.Организация = &Организация
		|	И (ВзаиморасчетыПоЗаймамСотрудникам.Регистратор ССЫЛКА Документ.ПриходныйКассовыйОрдер
		|			ИЛИ ВзаиморасчетыПоЗаймамСотрудникам.Регистратор ССЫЛКА Документ.ПоступлениеБезналичныхДенежныхСредств)
		|	И ВзаиморасчетыПоЗаймамСотрудникам.Период МЕЖДУ &НачалоПериода И &КонецПериода
		|	И ВзаиморасчетыПоЗаймамСотрудникам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
		|
		|СГРУППИРОВАТЬ ПО
		|	ВзаиморасчетыПоЗаймамСотрудникам.ФизическоеЛицо,
		|	ВзаиморасчетыПоЗаймамСотрудникам.Регистратор.Подразделение";
		
		Запрос.УстановитьПараметр("НачалоПериода", НачалоМесяца(СтруктураПараметров.ПериодРегистрации));
		Запрос.УстановитьПараметр("КонецПериода", КонецМесяца(СтруктураПараметров.ПериодРегистрации));
		Запрос.УстановитьПараметр("Организация", СтруктураПараметров.Организация);
		
		Результат = Запрос.Выполнить();
		
		Выборка = Результат.Выбрать();
		
		Пока Выборка.Следующий() Цикл
			ЗаполнитьЗначенияСвойств(ДанныеДляОтражения.УдержаннаяЗарплата.Добавить(), Выборка);
		КонецЦикла;
		
	КонецЕсли;
	
	ДанныеДляЗаполнения.Вставить("РезультатОтраженияЗарплаты", ДанныеДляОтражения);
	
	ПоместитьВоВременноеХранилище(ДанныеДляЗаполнения, АдресХранилища);
	
КонецПроцедуры

// Процедура дополнительной обработки данных перед отражением в учете.
// 
// Параметры:
//   Объект - ДанныеФормыСтруктура, Структура - объект, в который будет помещен результат
//   Параметры - Структура - дополнительные параметры обработки
//   ЗаполнитьСводнуюТаблицу - Булево - Истина, если требуется заполнить сводную таблицу начислений
//
Процедура ЗаполнениеПослеВыполненияДлительнойОперации(Объект, Параметры, ЗаполнитьСводнуюТаблицу = Истина) Экспорт
	
	СтруктураДанных = ПолучитьИзВременногоХранилища(Параметры.АдресХранилища);
	Если ТипЗнч(СтруктураДанных) <> Тип("Структура") Тогда
		Возврат;
	КонецЕсли;
	
	КолонкиДляСуммированияСтрокой = Документы.ОтражениеЗарплатыВФинансовомУчете.КолонкиДляСуммирования();
	
	КолонкиДляСуммирования = Новый Структура(КолонкиДляСуммированияСтрокой);
	
	РезультатОтраженияЗарплаты = Неопределено;
	Если СтруктураДанных.Свойство("РезультатОтраженияЗарплаты", РезультатОтраженияЗарплаты) Тогда
		
		Параметры.ТекстОповещения = НСтр("ru = 'Заполнено строк'");
		
		Если РезультатОтраженияЗарплаты.Свойство("НачисленнаяЗарплатаИВзносы") И РезультатОтраженияЗарплаты.НачисленнаяЗарплатаИВзносы.Количество() > 0 Тогда
			
			Для Каждого Строка Из РезультатОтраженияЗарплаты.НачисленнаяЗарплатаИВзносы Цикл
				
				ВзносыВсего = 0;
				Для Каждого Колонка Из КолонкиДляСуммирования Цикл
					ВзносыВсего = ВзносыВсего + Строка[Колонка.Ключ];
				КонецЦикла;
				
				Если ВзносыВсего = 0 И Строка.Сумма = 0 Тогда
					Продолжить;
				КонецЕсли;
				
				НоваяСтрока = Объект.НачисленнаяЗарплатаИВзносыПоФизлицам.Добавить();
				ЗаполнитьЗначенияСвойств(НоваяСтрока, Строка);
				НоваяСтрока.ВзносыВсего = ВзносыВсего;
				
				Если Строка.ВидОперации = Перечисления.ВидыОперацийПоЗарплате.НачисленоСдельноДоход Или
					Строка.ВидОперации = Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы Тогда
					
					НоваяСтрока.СпособОтраженияЗарплатыВБухучете = Справочники.СпособыОтраженияЗарплатыВБухУчете.ПустаяСсылка();
					
				КонецЕсли;
				
			КонецЦикла;
			
			Если ЗаполнитьСводнуюТаблицу Тогда
				
				Если Параметры.Сводно Тогда
					КолонкаВидНачисления = "ВидНачисленияОплатыТрудаДляНУ, ";
				Иначе
					КолонкаВидНачисления = "";
				КонецЕсли;
				
				ТаблицаИтоги = Объект.НачисленнаяЗарплатаИВзносыПоФизлицам.Выгрузить(,КолонкаВидНачисления + "ПодразделениеПредприятия, ВидОперации, СпособОтраженияЗарплатыВБухучете,
					|ОблагаетсяЕНВД, Сумма, ВзносыВсего," + КолонкиДляСуммированияСтрокой);
					
				ТаблицаИтоги.Свернуть(КолонкаВидНачисления + "ПодразделениеПредприятия, ВидОперации, СпособОтраженияЗарплатыВБухучете,
					|ОблагаетсяЕНВД",
					"Сумма, ВзносыВсего,"+КолонкиДляСуммированияСтрокой);
				
				ТаблицаИтоги.Сортировать("ПодразделениеПредприятия");
				
				ОбщегоНазначенияКлиентСервер.ДополнитьТаблицу(ТаблицаИтоги, Объект.НачисленнаяЗарплатаИВзносы);
				
				Если Объект.НачисленнаяЗарплатаИВзносы.Количество() > 0 Тогда
					
					Параметры.ЕстьДанныеДляЗаполнения = Истина;
					
					Параметры.ПояснениеОповещения = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru = 'Начисленния: %1'"),
						Объект.НачисленнаяЗарплатаИВзносы.Количество());
					
				КонецЕсли;
				
				Если Параметры.Сводно Тогда
					Объект.НачисленнаяЗарплатаИВзносыПоФизлицам.Очистить();
				КонецЕсли;
				
			КонецЕсли;
			
		КонецЕсли;
		
		Если РезультатОтраженияЗарплаты.Свойство("НачисленныйНДФЛ") И РезультатОтраженияЗарплаты.НачисленныйНДФЛ.Количество() > 0 Тогда
			
			// 4D:ERP для Беларуси, АлексейЧ, 14.12.2017 12:04:35 
			// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
			// Добавляем к продоходному налогу взнося в пенсионный фонд
			// {
			Если Параметры.Сводно Тогда
				// 4D:ERP для Беларуси, АлексейЧ, 20.02.2018 15:57:58 
				// Ошибка в документе "Отражение зарплаты в финансовом учете", № 17972
				// {
				
				//ТаблицаИтогиНДФЛ = РезультатОтраженияЗарплаты.НачисленныйНДФЛ.Скопировать(, "ПодразделениеПредприятия, Сумма, СуммаПенсионныйФонд, ВидОперации, РегистрацияВНалоговомОргане");
				ТаблицаИтогиНДФЛ = РезультатОтраженияЗарплаты.НачисленныйНДФЛ.Скопировать(, "ПодразделениеПредприятия, Сумма, ВидОперации, РегистрацияВНалоговомОргане");
				ТаблицаИтогиНДФЛ.Колонки.Добавить("СуммаПенсионныйФонд");
				ИтогПоПенсионномуДляНДФЛ = РезультатОтраженияЗарплаты.НачисленнаяЗарплатаИВзносы.ВыгрузитьКолонку("ПенсионныйФонд");
				ТаблицаИтогиНДФЛ.ЗагрузитьКолонку(ИтогПоПенсионномуДляНДФЛ, "СуммаПенсионныйФонд");
				// }
				// 4D
				ТаблицаИтогиНДФЛ.Свернуть("ПодразделениеПредприятия, ВидОперации, РегистрацияВНалоговомОргане", "Сумма, СуммаПенсионныйФонд");
				ТаблицаИтогиНДФЛ.Сортировать("ПодразделениеПредприятия, ВидОперации, РегистрацияВНалоговомОргане");
			Иначе
				// 4D:ERP для Беларуси, АлексейЧ, 20.02.2018 15:57:58 
				// Ошибка в документе "Отражение зарплаты в финансовом учете", № 17972
				// {
				
				//ТаблицаИтогиНДФЛ = РезультатОтраженияЗарплаты.НачисленныйНДФЛ.Скопировать(, "ФизическоеЛицо, ПодразделениеПредприятия, Сумма, СуммаПенсионныйФонд, ВидОперации, РегистрацияВНалоговомОргане");
				ТаблицаИтогиНДФЛ = РезультатОтраженияЗарплаты.НачисленныйНДФЛ.Скопировать(, "ФизическоеЛицо, ПодразделениеПредприятия, Сумма, ВидОперации, РегистрацияВНалоговомОргане");
				ТаблицаИтогиНДФЛ.Колонки.Добавить("СуммаПенсионныйФонд");
				ИтогПоПенсионномуДляНДФЛ = РезультатОтраженияЗарплаты.НачисленнаяЗарплатаИВзносы.ВыгрузитьКолонку("ПенсионныйФонд");
				ТаблицаИтогиНДФЛ.ЗагрузитьКолонку(ИтогПоПенсионномуДляНДФЛ, "СуммаПенсионныйФонд");
				// }
				// 4D
				ТаблицаИтогиНДФЛ.Свернуть("ФизическоеЛицо, ПодразделениеПредприятия, ВидОперации, РегистрацияВНалоговомОргане", "Сумма, СуммаПенсионныйФонд");
				ТаблицаИтогиНДФЛ.Сортировать("ФизическоеЛицо, ВидОперации, ПодразделениеПредприятия, РегистрацияВНалоговомОргане");
			КонецЕсли;
			
			Для Каждого Строка Из ТаблицаИтогиНДФЛ Цикл
				
				Если Строка.Сумма = 0 И Строка.СуммаПенсионныйФонд = 0 Тогда
					Продолжить;
				КонецЕсли;
			// }
			// 4D
				
				// данные по НДФЛ с дивидендов исключаются т.к. дивиденды и НДФЛ с них начисляет отдельный документ
				Если Строка.ВидОперации = Перечисления.ВидыОперацийПоЗарплате.НФДЛДивидендыСотрудникам 
					Или Строка.ВидОперации = Перечисления.ВидыОперацийПоЗарплате.НФДЛДивиденды Тогда
					Продолжить;
				КонецЕсли;
				
				ЗаполнитьЗначенияСвойств(Объект.НачисленныйНДФЛ.Добавить(), Строка);
			КонецЦикла;
			
			Если Объект.НачисленныйНДФЛ.Количество() > 0 Тогда
				
				Если ЗначениеЗаполнено(Параметры.ПояснениеОповещения) Тогда
					Параметры.ПояснениеОповещения = Параметры.ПояснениеОповещения + СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru = ', НДФЛ: %1'"),
						Объект.НачисленныйНДФЛ.Количество());
				Иначе
					Параметры.ПояснениеОповещения = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru = 'НДФЛ: %1'"),
						Объект.НачисленныйНДФЛ.Количество());
				КонецЕсли;
				
				Параметры.ЕстьДанныеДляЗаполнения = Истина;
				
			КонецЕсли;
			
		КонецЕсли;
		
		Если ТипЗнч(Объект) = Тип("Структура") Тогда
			УдержаннаяЗарплата = Объект.УдержаннаяЗарплата.Скопировать();
			НачисленныеПроцентыПоЗаймам = Объект.НачисленныеПроцентыПоЗаймам.Скопировать();
		Иначе
			УдержаннаяЗарплата = Объект.УдержаннаяЗарплата.Выгрузить();
			НачисленныеПроцентыПоЗаймам = Объект.НачисленныеПроцентыПоЗаймам.Выгрузить();
		КонецЕсли;
		
		Если РезультатОтраженияЗарплаты.Свойство("УдержаннаяЗарплата")
			И РезультатОтраженияЗарплаты.УдержаннаяЗарплата.Количество() > 0 Тогда
			
			Для Каждого Строка Из РезультатОтраженияЗарплаты.УдержаннаяЗарплата Цикл
				
				Если Строка.Сумма = 0 Тогда
					Продолжить;
				КонецЕсли;
				
				Если Строка.ВидОперации = Перечисления.ВидыОперацийПоЗарплате.НачисленоПроцентовПоЗайму Тогда
					ЗаполнитьЗначенияСвойств(НачисленныеПроцентыПоЗаймам.Добавить(), Строка);
				Иначе
					НоваяСтрока = УдержаннаяЗарплата.Добавить();
					ЗаполнитьЗначенияСвойств(НоваяСтрока, Строка);
				КонецЕсли;
			КонецЦикла;
			
		КонецЕсли;
		
		ТаблицыДляЗаполненияСтатейПоУмолчанию = "";
		
		Если Параметры.СписокТаблиц.НайтиПоЗначению("УдержаннаяЗарплата") <> Неопределено Тогда
			
			Если УдержаннаяЗарплата.Количество() > 0 И Параметры.ЗаполнятьАналитики Тогда
				
				Если ТипЗнч(Объект) = Тип("Структура") Тогда
					Объект.УдержаннаяЗарплата = УдержаннаяЗарплата;
				Иначе
					Объект.УдержаннаяЗарплата.Загрузить(УдержаннаяЗарплата);
				КонецЕсли;
				
				ТаблицыДляЗаполненияСтатейПоУмолчанию = "УдержаннаяЗарплата";
				
				Если ЗначениеЗаполнено(Параметры.ПояснениеОповещения) Тогда
					Параметры.ПояснениеОповещения = Параметры.ПояснениеОповещения + СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru = ', удержанния: %1'"),
						Объект.УдержаннаяЗарплата.Количество());
				Иначе
					Параметры.ПояснениеОповещения = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru = 'Удержанния: %1'"),
						Объект.УдержаннаяЗарплата.Количество());
				КонецЕсли;
				
				Параметры.ЕстьДанныеДляЗаполнения = Истина;
				
			КонецЕсли;
			
		КонецЕсли;
		
		Если Параметры.СписокТаблиц.НайтиПоЗначению("НачисленныеПроцентыПоЗаймам") <> Неопределено Тогда
			
			Если НачисленныеПроцентыПоЗаймам.Количество() > 0 И Параметры.ЗаполнятьАналитики Тогда
				
				Если ТипЗнч(Объект) = Тип("Структура") Тогда
					Объект.НачисленныеПроцентыПоЗаймам = НачисленныеПроцентыПоЗаймам;
				Иначе
					Объект.НачисленныеПроцентыПоЗаймам.Загрузить(НачисленныеПроцентыПоЗаймам);
				КонецЕсли;
				
				ТаблицыДляЗаполненияСтатейПоУмолчанию = ТаблицыДляЗаполненияСтатейПоУмолчанию + ", " + "НачисленныеПроцентыПоЗаймам";
				
				Если ЗначениеЗаполнено(Параметры.ПояснениеОповещения) Тогда
					Параметры.ПояснениеОповещения = Параметры.ПояснениеОповещения + СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru = ', проценты по займам: %1'"),
						Объект.НачисленныеПроцентыПоЗаймам.Количество());
				Иначе
					Параметры.ПояснениеОповещения = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru = 'Проценты по займам: %1'"),
						Объект.НачисленныеПроцентыПоЗаймам.Количество());
				КонецЕсли;
				
				Параметры.ЕстьДанныеДляЗаполнения = Истина;
				
			КонецЕсли;
			
		КонецЕсли;
		
		Если ЗначениеЗаполнено(ТаблицыДляЗаполненияСтатейПоУмолчанию) Тогда
			ЗаполнитьСтатьиАналитикуРасходовПоУмолчанию(Объект, ТаблицыДляЗаполненияСтатейПоУмолчанию);
		КонецЕсли;
		
	КонецЕсли;
	
	Если Не Параметры.ЕстьДанныеДляЗаполнения Тогда
		Параметры.ТекстОповещения = НСтр("ru = 'Начисления не заполнены'");
		Параметры.ПояснениеОповещения = НСтр("ru = 'В информационной базе отсутствуют данные для заполнения.'");
	КонецЕсли;
	
КонецПроцедуры

//	Создает в менеджере таблицу с аналитикой других документов
//
//	Параметры:
//		МенеджерВременныхТаблиц - МенеджерВременныхТаблиц - менеджер,
//		ТекущийДокумент - ДокументСсылка.ОтражениеЗарплатыВФинансовомУчете - текущий документ,
//		ДатаАктуальности - Дата - дата, до которой обрабатываются документы,
//		ИмяТаблицы - Строка - имя таблицы, для которой строится аналитика.
//
Процедура СоздатьВТАналитикаДругихДокументов(МенеджерВременныхТаблиц, ТекущийДокумент, ДатаАктуальности, ИмяТаблицы = "") Экспорт
	
	// Получаем последние используемые значения по совпадающим сочетаниям заполненных полей
	
	ТекстЗапросаУдержаннаяЗарплата = 
	"ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.АлиментыПрочиеИсполнительныеЛисты) КАК ВидОперации,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоИсполнительнымДокументамРаботников) КАК СчетУчета,
	|	ЛОЖЬ КАК АналитикаПоРаботникам,
	|	ИСТИНА КАК АналитикаПоКонтрагентам
	|ПОМЕСТИТЬ ВТСчетаПоОперациям
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ВозмещениеУщерба),
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоВозмещениюМатериальногоУщерба),
	|	ИСТИНА,
	|	ЛОЖЬ
	|
	// 4D:ERP для Беларуси, Екатерина, 03.02.2016 15:41:06 
	// , №10801
	// {
	// Действие не требуется
	// }
	// 4D
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.УдержаниеЗаОтпуск),
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоПрочимОперациям),
	|	ИСТИНА,
	|	ЛОЖЬ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.УдержаниеНеизрасходованныхПодотчетныхСумм),
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами),
	|	ИСТИНА,
	|	ЛОЖЬ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.УдержаниеПоПрочимОперациямСРаботниками),
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоПрочимОперациям),
	|	ИСТИНА,
	|	ЛОЖЬ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ПогашениеЗаймов),
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоПредоставленнымЗаймам),
	|	ИСТИНА,
	|	ЛОЖЬ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ПроцентыПоЗайму),
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоПредоставленнымЗаймам),
	|	ИСТИНА,
	|	ЛОЖЬ
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	НезаполненнаяАналитика.ВидОперации КАК ВидОперации,
	|	Удержания.СтатьяАктивовПассивов КАК СтатьяАктивовПассивов,
	|	Удержания.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
	|	НезаполненнаяАналитика.ФизическоеЛицо,
	|	НезаполненнаяАналитика.ПодразделениеПредприятия,
	|	Документы.Дата КАК Дата,
	|	Удержания.СчетУчета,
	|	Удержания.Субконто1,
	|	Удержания.Субконто2,
	|	Удержания.Субконто3,
	|	Удержания.Контрагент
	|ПОМЕСТИТЬ ВТАналитикаДругихДокументовУдержания
	|ИЗ
	|	ВТНезаполненнаяАналитика КАК НезаполненнаяАналитика
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ОтражениеЗарплатыВФинансовомУчете.УдержаннаяЗарплата КАК Удержания
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ОтражениеЗарплатыВФинансовомУчете КАК Документы
	|			ПО Удержания.Ссылка = Документы.Ссылка
	|		ПО НезаполненнаяАналитика.ВидОперации = Удержания.ВидОперации
	|			И Удержания.ФизическоеЛицо = НезаполненнаяАналитика.ФизическоеЛицо
	|			И Удержания.ПодразделениеПредприятия = НезаполненнаяАналитика.ПодразделениеПредприятия
	|			И НезаполненнаяАналитика.Контрагент = Удержания.Контрагент
	|ГДЕ
	|	Удержания.Ссылка <> &ТекущийДокумент
	|	И Документы.ПериодРегистрации <= &ДатаАктуальности
	|	И Документы.Проведен
	|	И Удержания.СтатьяАктивовПассивов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ПустаяСсылка)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ВТАналитикаДругихДокументовУдержания.ВидОперации,
	|	ВТАналитикаДругихДокументовУдержания.ФизическоеЛицо,
	|	ВТАналитикаДругихДокументовУдержания.ПодразделениеПредприятия,
	|	МАКСИМУМ(ВТАналитикаДругихДокументовУдержания.Дата) КАК Дата,
	|	ВТАналитикаДругихДокументовУдержания.Контрагент
	|ПОМЕСТИТЬ ВТЕдинственныеЗначенияСтатьи
	|ИЗ
	|	ВТАналитикаДругихДокументовУдержания КАК ВТАналитикаДругихДокументовУдержания
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТАналитикаДругихДокументовУдержания.ФизическоеЛицо,
	|	ВТАналитикаДругихДокументовУдержания.ПодразделениеПредприятия,
	|	ВТАналитикаДругихДокументовУдержания.ВидОперации,
	|	ВТАналитикаДругихДокументовУдержания.Контрагент
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТАналитикаДругихДокументовУдержания.ВидОперации,
	|	ВТАналитикаДругихДокументовУдержания.ФизическоеЛицо,
	|	ВТАналитикаДругихДокументовУдержания.ПодразделениеПредприятия,
	|	ВТАналитикаДругихДокументовУдержания.СтатьяАктивовПассивов,
	|	ВТАналитикаДругихДокументовУдержания.АналитикаАктивовПассивов,
	|	ВТАналитикаДругихДокументовУдержания.СчетУчета КАК СчетУчета,
	|	ВТАналитикаДругихДокументовУдержания.Субконто1 КАК Субконто1,
	|	ВТАналитикаДругихДокументовУдержания.Субконто2 КАК Субконто2,
	|	ВТАналитикаДругихДокументовУдержания.Субконто3 КАК Субконто3,
	|	ВТАналитикаДругихДокументовУдержания.Контрагент
	|ПОМЕСТИТЬ ВТЗаполненнаяСтатьяПассивов
	|ИЗ
	|	ВТАналитикаДругихДокументовУдержания КАК ВТАналитикаДругихДокументовУдержания
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТЕдинственныеЗначенияСтатьи КАК ВТЕдинственныеЗначенияСтатьи
	|		ПО ВТЕдинственныеЗначенияСтатьи.ВидОперации = ВТАналитикаДругихДокументовУдержания.ВидОперации
	|			И ВТЕдинственныеЗначенияСтатьи.ФизическоеЛицо = ВТАналитикаДругихДокументовУдержания.ФизическоеЛицо
	|			И ВТЕдинственныеЗначенияСтатьи.ПодразделениеПредприятия = ВТАналитикаДругихДокументовУдержания.ПодразделениеПредприятия
	|			И ВТЕдинственныеЗначенияСтатьи.Дата = ВТАналитикаДругихДокументовУдержания.Дата
	|			И ВТАналитикаДругихДокументовУдержания.Контрагент = ВТЕдинственныеЗначенияСтатьи.Контрагент
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	НезаполненнаяАналитика.ВидОперации КАК ВидОперации,
	|	НезаполненнаяАналитика.ФизическоеЛицо,
	|	НезаполненнаяАналитика.ПодразделениеПредприятия,
	|	ВТЗаполненнаяСтатьяПассивов.СтатьяАктивовПассивов,
	|	ВТЗаполненнаяСтатьяПассивов.АналитикаАктивовПассивов,
	|	ВЫБОР
	|		КОГДА ВТЗаполненнаяСтатьяПассивов.СчетУчета ЕСТЬ NULL 
	|			ТОГДА ВТСчетаПоОперациям.СчетУчета
	|		ИНАЧЕ ВТЗаполненнаяСтатьяПассивов.СчетУчета
	|	КОНЕЦ КАК СчетУчета,
	|	ВЫБОР
	|		КОГДА ВТЗаполненнаяСтатьяПассивов.СчетУчета ЕСТЬ NULL 
	|				И ВТСчетаПоОперациям.АналитикаПоРаботникам
	|			ТОГДА НезаполненнаяАналитика.ФизическоеЛицо
	|		КОГДА ВТЗаполненнаяСтатьяПассивов.СчетУчета ЕСТЬ NULL 
	|				И ВТСчетаПоОперациям.АналитикаПоКонтрагентам
	|			ТОГДА НезаполненнаяАналитика.Контрагент
	|		ИНАЧЕ ВТЗаполненнаяСтатьяПассивов.Субконто1
	|	КОНЕЦ КАК Субконто1,
	|	ВТЗаполненнаяСтатьяПассивов.Субконто2,
	|	ВТЗаполненнаяСтатьяПассивов.Субконто3
	|ПОМЕСТИТЬ ЗаполненнаяСтатьяПассивов
	|ИЗ
	|	ВТНезаполненнаяАналитика КАК НезаполненнаяАналитика
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗаполненнаяСтатьяПассивов КАК ВТЗаполненнаяСтатьяПассивов
	|		ПО НезаполненнаяАналитика.ВидОперации = ВТЗаполненнаяСтатьяПассивов.ВидОперации
	|			И НезаполненнаяАналитика.ФизическоеЛицо = ВТЗаполненнаяСтатьяПассивов.ФизическоеЛицо
	|			И НезаполненнаяАналитика.ПодразделениеПредприятия = ВТЗаполненнаяСтатьяПассивов.ПодразделениеПредприятия
	|			И НезаполненнаяАналитика.Контрагент = ВТЗаполненнаяСтатьяПассивов.Контрагент
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСчетаПоОперациям КАК ВТСчетаПоОперациям
	|		ПО НезаполненнаяАналитика.ВидОперации = ВТСчетаПоОперациям.ВидОперации
	|;";
	
	ТекстЗапросаНачисленныеПроцентыПоЗаймам = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Документы.Дата КАК Дата,
	|	Проценты.ФизическоеЛицо КАК ФизическоеЛицо,
	|	Проценты.ПодразделениеПредприятия КАК ПодразделениеПредприятия,
	|	Проценты.СтатьяДоходов КАК СтатьяДоходов,
	|	Проценты.АналитикаДоходов КАК АналитикаДоходов
	|ПОМЕСТИТЬ ВТАналитикаДругихДокументовПроценты
	|ИЗ
	|	ВТНезаполненнаяАналитикаДоходов КАК ВТНезаполненнаяАналитикаДоходов
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныеПроцентыПоЗаймам КАК Проценты
	|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтражениеЗарплатыВФинансовомУчете КАК Документы
	|			ПО Проценты.Ссылка = Документы.Ссылка
	|		ПО ВТНезаполненнаяАналитикаДоходов.ФизическоеЛицо = Проценты.ФизическоеЛицо
	|			И ВТНезаполненнаяАналитикаДоходов.ПодразделениеПредприятия = Проценты.ПодразделениеПредприятия
	|ГДЕ
	|	Проценты.Ссылка <> &ТекущийДокумент
	|	И Документы.ПериодРегистрации <= &ДатаАктуальности
	|	И Документы.Проведен
	|	И Проценты.СтатьяДоходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТАналитикаДругихДокументовПроценты.ФизическоеЛицо,
	|	ВТАналитикаДругихДокументовПроценты.ПодразделениеПредприятия,
	|	МАКСИМУМ(ВТАналитикаДругихДокументовПроценты.Дата) КАК Дата
	|ПОМЕСТИТЬ ВТЕдинственноеЗначениеСтатьиДоходов
	|ИЗ
	|	ВТАналитикаДругихДокументовПроценты КАК ВТАналитикаДругихДокументовПроценты
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТАналитикаДругихДокументовПроценты.ФизическоеЛицо,
	|	ВТАналитикаДругихДокументовПроценты.ПодразделениеПредприятия
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТЕдинственноеЗначениеСтатьиДоходов.ФизическоеЛицо,
	|	ВТЕдинственноеЗначениеСтатьиДоходов.ПодразделениеПредприятия,
	|	ВТАналитикаДругихДокументовПроценты.СтатьяДоходов,
	|	ВТАналитикаДругихДокументовПроценты.АналитикаДоходов
	|ПОМЕСТИТЬ ВТЗаполненнаяСтатьяДоходов
	|ИЗ
	|	ВТЕдинственноеЗначениеСтатьиДоходов КАК ВТЕдинственноеЗначениеСтатьиДоходов
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТАналитикаДругихДокументовПроценты КАК ВТАналитикаДругихДокументовПроценты
	|		ПО ВТЕдинственноеЗначениеСтатьиДоходов.ФизическоеЛицо = ВТАналитикаДругихДокументовПроценты.ФизическоеЛицо
	|			И ВТЕдинственноеЗначениеСтатьиДоходов.Дата = ВТАналитикаДругихДокументовПроценты.Дата
	|			И ВТЕдинственноеЗначениеСтатьиДоходов.ПодразделениеПредприятия = ВТАналитикаДругихДокументовПроценты.ПодразделениеПредприятия";
	
	Если ИмяТаблицы = "" Тогда
		ТекстЗапроса = ТекстЗапросаУдержаннаяЗарплата + ТекстЗапросаНачисленныеПроцентыПоЗаймам;
	ИначеЕсли ИмяТаблицы = "УдержаннаяЗарплата" Тогда
		ТекстЗапроса = ТекстЗапросаУдержаннаяЗарплата;
	Иначе
		ТекстЗапроса = ТекстЗапросаНачисленныеПроцентыПоЗаймам;
	КонецЕсли;
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("ТекущийДокумент", ТекущийДокумент);
	Запрос.УстановитьПараметр("ДатаАктуальности", ДатаАктуальности);
	Запрос.Выполнить();
	
КонецПроцедуры

// Возвращает текст запроса для отражения в регл. учете.
// 
// Возвращаемое значение:
//   Строка - текст отражения в регл. учете
//
Функция ТекстОтраженияВРеглУчете() Экспорт

#Область ТекстЗапросаНачисленоПостатьям
	ТекстЗапросаНачисленоПостатьям = "
	// зарплата и взносы на расходы по статьям
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	СУММА(Строки.Сумма) КАК Сумма,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.СтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.СтатьяРасходов КАК СубконтоДт1,
	|	Строки.АналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА Строки.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы) ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Строки.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|			ТОГДА ""Начисление заработной платы""
	|		ИНАЧЕ ""Начисление взносов с заработной платы""
	|	КОНЕЦ КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации НЕ В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы))
	|	И Строки.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	И Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|СГРУППИРОВАТЬ ПО
	|	Операция.Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ),
	|	Операция.Организация,
	|	Строки.АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА Строки.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ,
	|	Строки.СчетКт,
	|	Строки.ФизическоеЛицо,
	|	Строки.СубконтоКт2,
	|	Строки.СтатьяРасходов,
	|	Строки.Подразделение,
	|	Строки.НаправлениеДеятельности,
	|	Строки.СтатьяРасходов,
	|	Строки.Подразделение,
	|	Строки.ТипНалога
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// зарплата и взносы на прочие операции (устаревшее)
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	СУММА(Строки.Сумма) КАК Сумма,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Строки.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|			ТОГДА ""Начисление заработной платы""
	|		ИНАЧЕ ""Начисление взносов с заработной платы""
	|	КОНЕЦ КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации НЕ В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы))
	|	И Строки.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации)
	|	И Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|СГРУППИРОВАТЬ ПО
	|	Операция.Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ),
	|	Операция.Организация,
	|	Строки.СчетКт,
	|	Строки.ФизическоеЛицо,
	|	Строки.СубконтоКт2,
	|	Строки.Подразделение,
	|	Строки.Подразделение,
	|	Строки.ТипНалога
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// зарплата и взносы на пассивы
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	СУММА(Строки.Сумма) КАК Сумма,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.АналитикаАктивовПассивов КАК НаправлениеДеятельностиДт,
	|	
	|	Строки.СчетУчета КАК СчетДт,
	|	Строки.Субконто1 КАК СубконтоДт1,
	|	Строки.Субконто2 КАК СубконтоДт2,
	|	Строки.Субконто3 КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Строки.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|			ТОГДА ""Начисление заработной платы""
	|		ИНАЧЕ ""Начисление взносов с заработной платы""
	|	КОНЕЦ КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации НЕ В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы))
	|	И Строки.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	И Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиАктивовПассивов
	|
	|СГРУППИРОВАТЬ ПО
	|	Операция.Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ),
	|	Операция.Организация,
	|	Строки.АналитикаРасходов,
	|	Строки.СчетКт,
	|	Строки.ФизическоеЛицо,
	|	Строки.СубконтоКт2,
	|	Строки.СтатьяРасходов,
	|	Строки.Подразделение,
	|	Строки.СтатьяРасходов,
	|	Строки.АналитикаАктивовПассивов,
	|	Строки.СчетУчета,
	|	Строки.Субконто1,
	|	Строки.Субконто2,
	|	Строки.Субконто3,
	|	Строки.ТипНалога
	|";
	
#КонецОбласти

// Отпуск за счет обязательств и резервов: одинаковое отражение в бухгалтерском и налоговом учетах
#Область ТекстЗапросаЕжегодныйОтпускОценочныеОбязательстваИРезервы
	ТекстЗапросаЕжегодныйОтпускОценочныеОбязательстваИРезервы = "
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Строки.Сумма КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	НЕОПРЕДЕЛЕНО КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) ТОГДА
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОценочныеОбязательстваПоВознаграждениям)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОценочныеОбязательстваПостраховымВзносам)
	|	КОНЕЦ КАК СчетДт,
	
	|	ЗНАЧЕНИЕ(Справочник.Резервы.РезервЕжегодныхОтпусков) КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Отпуск за счет обязательств и резервов"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы))
	|";

#КонецОбласти

// Отпуск за счет обязательств: отражение резервов только в БУ, в НУ на счета затрат
#Область ТекстЗапросаЕжегодныйОтпускОценочныеОбязательства

	ТекстЗапросаЕжегодныйОтпускОценочныеОбязательства = "
	// резервы в БУ
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Строки.Сумма КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	НЕОПРЕДЕЛЕНО КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) ТОГДА
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОценочныеОбязательстваПоВознаграждениям)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОценочныеОбязательстваПостраховымВзносам)
	|	КОНЕЦ КАК СчетДт,
	
	|	ЗНАЧЕНИЕ(Справочник.Резервы.РезервЕжегодныхОтпусков) КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	Строки.Сумма КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	Строки.Сумма КАК СуммаВРКт,
	|	""Отпуск за счет обязательств"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства))
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// расходы в НУ по статьям
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	0 КАК Сумма,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.СтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	
	|	Строки.СтатьяРасходов КАК СубконтоДт1,
	|	Строки.АналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА Строки.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы) ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Строки.Сумма КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	- Строки.Сумма КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Строки.Сумма КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	- Строки.Сумма КАК СуммаВРКт,
	|	""Отпуск за счет обязательств"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства))
	|	И Строки.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	И Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// расходы в НУ по прочим операциям (устаревшее)
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	0 КАК Сумма,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Строки.Сумма КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	- Строки.Сумма КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Строки.Сумма КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	- Строки.Сумма КАК СуммаВРКт,
	|	""Отпуск за счет обязательств"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства))
	|	И Строки.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации)
	|	И Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// расходы в НУ на пассивы
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	0 КАК Сумма,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	Строки.СчетУчета КАК СчетДт,
	|	
	|	Строки.Субконто1 КАК СубконтоДт1,
	|	Строки.Субконто2 КАК СубконтоДт2,
	|	Строки.Субконто3 КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Строки.Сумма КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	- Строки.Сумма КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Строки.Сумма КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	- Строки.Сумма КАК СуммаВРКт,
	|	""Отпуск за счет обязательств"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства))
	|	И Строки.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	И Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиАктивовПассивов
	|";

#КонецОбласти

// Отпуск за счет резервов: отражение резервов только в НУ, в БУ на счета затрат
#Область ТекстЗапросаЕжегодныйОтпускРезервы
	
	ТекстЗапросаЕжегодныйОтпускРезервы = "
	// резервы в НУ
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	0 КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	НЕОПРЕДЕЛЕНО КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) ТОГДА
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОценочныеОбязательстваПоВознаграждениям)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОценочныеОбязательстваПостраховымВзносам)
	|	КОНЕЦ КАК СчетДт,
	
	|	ЗНАЧЕНИЕ(Справочник.Резервы.РезервЕжегодныхОтпусков) КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Строки.Сумма КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	- Строки.Сумма КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Строки.Сумма КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	- Строки.Сумма КАК СуммаВРКт,
	|	""Отпуск за счет резервов"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы))
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// расходы в БУ по статьям
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Строки.Сумма КАК Сумма,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.СтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	
	|	Строки.СтатьяРасходов КАК СубконтоДт1,
	|	Строки.АналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА Строки.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы) ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	Строки.Сумма КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	Строки.Сумма КАК СуммаВРКт,
	|	""Отпуск за счет резервов"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы))
	|	И Строки.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	И Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// расходы в БУ по прочим операциям (устаревшее)
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Строки.Сумма КАК Сумма,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	Строки.Сумма КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	Строки.Сумма КАК СуммаВРКт,
	|	""Отпуск за счет резервов"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы))
	|	И Строки.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации)
	|	И Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// расходы в БУ на пассивы
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Строки.Сумма КАК Сумма,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	Строки.СчетУчета КАК СчетДт,
	|	
	|	Строки.Субконто1 КАК СубконтоДт1,
	|	Строки.Субконто2 КАК СубконтоДт2,
	|	Строки.Субконто3 КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	Строки.Сумма КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 10:50:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Для отчислений в Белгосстрах указываем СУБКОНТО1 - Контрагент Белгосстрах, СУБКОНТО2 - Договор с Белгосстрах
	// {
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА Строки.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Операция.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Строки.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	Строки.Сумма КАК СуммаВРКт,
	|	""Отпуск за счет резервов"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		НачисленнаяЗарплатаИВзносы КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|
	|ГДЕ
	|	Строки.ВидОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы))
	|	И Строки.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	И Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиАктивовПассивов
	|";
	
#КонецОбласти

#Область ТекстЗапросаНачисленоСдельно
	ТекстЗапросаНачисленоСдельно = "
	// прямые производственные
	|ВЫБРАТЬ
	|	Строки.Регистратор КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Строки.Период, МЕСЯЦ) КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Сумма(Строки.СуммаРегл) КАК Сумма,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.ВидРабот КАК СубконтоДт1,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.СдельнаяОплатаТруда) КАК СубконтоДт2,
	|	Строки.ГруппаПродукции КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	// 4D:ERP для Беларуси, АлексейЧ, 27.11.2017 21:35:55 
	// // Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|
	|	ВтСчета.СчетКт КАК СчетКт,
	|	ВЫБОР КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) ТОГДА
	|			Строки.ФизическоеЛицо
	|		 КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|			Строки.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|			Строки.ВидПлатежаВГосБюджет
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) ТОГДА
	|			Строки.ВидНачисленияОплатыТруда
	|		  КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|			Строки.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Строки.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|			ТОГДА ""Начисление сдельной заработной платы""
	|		ИНАЧЕ ""Начисление взносов со сдельной заработной платы""
	|	КОНЕЦ КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ОтражениеЗарплатыВФинансовомУчете КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		(
	|			ВЫБРАТЬ 
	|					ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) 					КАК ТипНалога,
	|					ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда)	КАК СчетКт	// (Кт 70)
	// 4D:ERP для Беларуси, Екатерина, 03.02.2016 15:58:46 
	// , №10801
	// {
	|			ОБЪЕДИНИТЬ ВСЕ 
	|
	|			ВЫБРАТЬ 
	|					ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ФСЗН)								КАК ТипНалога,
	|					ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ФСС)								КАК СчетКт		// (Кт 69.01)
	|			
	|			ОБЪЕДИНИТЬ ВСЕ 
	|					
	|			ВЫБРАТЬ 
	|					ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.Белгосстрах)						КАК ТипНалога,
	|					ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию)	КАК СчетКт	    // (Кт 76.08)
	// }
	// 4D
	|		) КАК ВтСчета
	|	ПО
	|		Строки.ТипНалога = ВтСчета.ТипНалога
	|	
	|ГДЕ
	|	Строки.ВидРабот <> ЗНАЧЕНИЕ(Справочник.ВидыРаботСотрудников.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	Строки.Регистратор,
	|	КОНЕЦПЕРИОДА(Строки.Период, МЕСЯЦ),
	|	Строки.Организация,
	|	Строки.Подразделение,
	|	Строки.НаправлениеДеятельности,
	|	Строки.ВидРабот,
	|	Строки.ГруппаПродукции,
	|	Строки.ВидНачисленияОплатыТруда,
	|	ВтСчета.СчетКт,
	|	Строки.ФизическоеЛицо,
	|	Строки.Организация.КонтрагентБелгосстрах,
	|	Строки.Организация.ДоговорБелгосстрах,
	|	Строки.ВидПлатежаВГосБюджет,
	|	Строки.ТипНалога
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// на расходы
	|ВЫБРАТЬ
	|	Строки.Регистратор КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Строки.Период, МЕСЯЦ) КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Сумма(Строки.СуммаРегл) КАК Сумма,
	|
	|	ВЫБОР 
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL ТОГДА
	|			ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	ИНАЧЕ
	|			ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации)
	|	КОНЕЦ КАК ВидСчетаДт,
	|
	|	ВЫБОР
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL ТОГДА
	|			Строки.СтатьяРасходов
	|	ИНАЧЕ
	|			НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|
	|	ВЫБОР
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL ТОГДА
	|			Строки.Подразделение
	|	ИНАЧЕ
	|			НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|
	|	ВЫБОР
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL ТОГДА
	|			Строки.СтатьяРасходов
	|	ИНАЧЕ
	|			НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоДт1,
	|
	|	ВЫБОР
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL ТОГДА
	|			Строки.АналитикаРасходов
	|	ИНАЧЕ
	|			НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоДт2,
	|
	|	ВЫБОР
	|		КОГДА НЕ СтатьиСтроительства.Ссылка ЕСТЬ NULL ТОГДА
	|			ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL ТОГДА
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	ИНАЧЕ
	|		НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ВтСчета.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 27.11.2017 21:35:55 
	// // Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	ВЫБОР КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) ТОГДА
	|		Строки.ФизическоеЛицо
	|		  КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Строки.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ВидПлатежаВГосБюджет
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) ТОГДА
	|		Строки.ВидНачисленияОплатыТруда
	|			КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|		Строки.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоКт2,
	// }
	// 4D
	|
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Строки.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|			ТОГДА ""Начисление сдельной заработной платы""
	|		ИНАЧЕ ""Начисление взносов со сдельной заработной платы""
	|	КОНЕЦ КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ОтражениеЗарплатыВФинансовомУчете КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		(
	|			ВЫБРАТЬ 
	|					ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) КАК ТипНалога,				
	|					ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) КАК СчетКт	// (Кт 70)
	// 4D:ERP для Беларуси, Екатерина, 03.02.2016 15:55:39 
	// , №10801
	// {
	|			ОБЪЕДИНИТЬ ВСЕ 
	|
	|			ВЫБРАТЬ 
	|					ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ФСЗН) КАК ТипНалога,						
	|					ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ФСС) КАК СчетКт	// (Кт 69.01)
	|
	|			ОБЪЕДИНИТЬ ВСЕ 
	|
	|			ВЫБРАТЬ 
	|					ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.Белгосстрах) КАК ТипНалога,		
	|					ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) КАК СчетКт  // (Кт 76.08)
	// }
	// 4D
	|		) КАК ВтСчета
	|	ПО
	|		Строки.ТипНалога = ВтСчета.ТипНалога
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
	|	ПО
	|		Строки.СтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
	|		И СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиСтроительства
	|	ПО
	|		Строки.СтатьяРасходов = СтатьиСтроительства.Ссылка
	|		И СтатьиСтроительства.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|
	|ГДЕ
	|	Не Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиАктивовПассивов
	|	И Строки.ВидРабот = ЗНАЧЕНИЕ(Справочник.ВидыРаботСотрудников.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	Строки.Регистратор,
	|	КОНЕЦПЕРИОДА(Строки.Период, МЕСЯЦ),
	|	Строки.Организация,
	|	ВЫБОР
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL 
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL 
	|			ТОГДА Строки.СтатьяРасходов
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL 
	|			ТОГДА Строки.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL 
	|			ТОГДА Строки.СтатьяРасходов
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL 
	|			ТОГДА Строки.АналитикаРасходов
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ СтатьиСтроительства.Ссылка ЕСТЬ NULL
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL 
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВтСчета.СчетКт,
	|	ВЫБОР
	|		КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда)
	|			ТОГДА Строки.ФизическоеЛицо
	|		КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию)
	|			ТОГДА Строки.Организация.КонтрагентБелгосстрах
	|		ИНАЧЕ Строки.ВидПлатежаВГосБюджет
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда)
	|			ТОГДА Строки.ВидНачисленияОплатыТруда
	|		КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию)
	|			ТОГДА Строки.Организация.ДоговорБелгосстрах
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	Строки.Подразделение,
	|	Строки.НаправлениеДеятельности,
	|	Строки.ТипНалога
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// на прочие пассивы
	|ВЫБРАТЬ
	|	Строки.Регистратор КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Строки.Период, МЕСЯЦ) КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Сумма(Строки.СуммаРегл) КАК Сумма,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.АналитикаАктивовПассивов КАК НаправлениеДеятельностиДт,
	|
	|	Строки.СчетУчета КАК СчетДт,
	|
	|	Строки.Субконто1 КАК СубконтоДт1,
	|	Строки.Субконто2 КАК СубконтоДт2,
	|	Строки.Субконто3 КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ВтСчета.СчетКт КАК СчетКт,
	// 4D:ERP для Беларуси, АлексейЧ, 27.11.2017 21:35:55 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	ВЫБОР КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) ТОГДА
	|		Строки.ФизическоеЛицо
	|			КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|				Строки.Организация.КонтрагентБелгосстрах
	|	ИНАЧЕ
	|		Строки.ВидПлатежаВГосБюджет
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) ТОГДА
	|		Строки.ВидНачисленияОплатыТруда
	|			КОГДА ВтСчета.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) ТОГДА
	|				Строки.Организация.ДоговорБелгосстрах
	|	ИНАЧЕ
	|		Неопределено
	|	КОНЕЦ КАК СубконтоКт2,
	|
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Строки.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|			ТОГДА ""Начисление сдельной заработной платы""
	|		ИНАЧЕ ""Начисление взносов со сдельной заработной платы""
	|	КОНЕЦ КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ОтражениеЗарплатыВФинансовомУчете КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		(
	|			ВЫБРАТЬ 
	|				ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) КАК ТипНалога, 				
	|				ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) КАК СчетКт	// (Кт 70)
	// 4D:ERP для Беларуси, Екатерина, 03.02.2016 15:52:19 
	// , №10801
	// {
	|			ОБЪЕДИНИТЬ ВСЕ 
	|
	|			ВЫБРАТЬ 
	|				ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ФСЗН) КАК ТипНалога,						
	|				ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ФСС) КАК СчетКт	// (Кт 69.01)
	|
	|			ОБЪЕДИНИТЬ ВСЕ 
	|
	|			ВЫБРАТЬ 
	|				ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.Белгосстрах) КАК ТипНалога,		
	|				ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию) КАК СчетКт  // (Кт 76.08)
	// }
	// 4D
	|		) КАК ВтСчета
	|	ПО
	|		Строки.ТипНалога = ВтСчета.ТипНалога
	|	
	|ГДЕ
	|	Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиАктивовПассивов
	|	И Строки.ВидРабот = ЗНАЧЕНИЕ(Справочник.ВидыРаботСотрудников.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	Строки.Регистратор,
	|	КОНЕЦПЕРИОДА(Строки.Период, МЕСЯЦ),
	|	Строки.Организация,
	|	Строки.Подразделение,
	|	Строки.СчетУчета,
	|	ВтСчета.СчетКт,
	|	Строки.АналитикаАктивовПассивов,
	|	Строки.Субконто1,
	|	Строки.Субконто2,
	|	Строки.Субконто3,
	|	Строки.ФизическоеЛицо,
	|	Строки.ВидНачисленияОплатыТруда,
	|	Строки.ТипНалога,
	|	Строки.Организация.КонтрагентБелгосстрах,
	|	Строки.Организация.ДоговорБелгосстрах,
	|	Строки.ВидПлатежаВГосБюджет
	|";
#КонецОбласти

#Область ТекстЗапросаНДФЛ
	ТекстЗапросаНДФЛ = "
	// НДФЛ, НФДЛДивидендыСотрудникам
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Сумма(Строки.Сумма) КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) КАК СчетДт,
	|	ВЫБОР КОГДА Операция.ПроводкиПоРаботникам 
	|		ТОГДА Строки.ФизическоеЛицо
	|	ИНАЧЕ
	|		Значение(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДФЛ) КАК СчетКт,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.Налог) КАК СубконтоКт1,
	|	Строки.РегистрацияВНалоговомОргане КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	// 4D:ERP для Беларуси, АлексейЧ, 06.12.2017 10:07:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	""Подоходный налог"" КАК Содержание
	// }
	// 4D
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|ГДЕ
	|	Строки.ВидОперации В (Значение(Перечисление.ВидыОперацийПоЗарплате.НДФЛ),
	|		Значение(Перечисление.ВидыОперацийПоЗарплате.НФДЛДивидендыСотрудникам))
	|
	|СГРУППИРОВАТЬ ПО
	|	Операция.Ссылка,
	|	Строки.РегистрацияВНалоговомОргане,
	|	Операция.Организация,
	|	ВЫБОР
	|		КОГДА Операция.ПроводкиПоРаботникам
	|			ТОГДА Строки.ФизическоеЛицо
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ),
	|	Строки.ПодразделениеПредприятия,
	|	Строки.ПодразделениеПредприятия
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// 4D:ERP для Беларуси, АлексейЧ, 06.12.2017 10:07:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	//
	// Пенсионный фонд
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Сумма(Строки.СуммаПенсионныйФонд) КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) КАК СчетДт,
	|	ВЫБОР КОГДА Операция.ПроводкиПоРаботникам 
	|		ТОГДА Строки.ФизическоеЛицо
	|	ИНАЧЕ
	|		Значение(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПФР) КАК СчетКт,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.Налог) КАК СубконтоКт1,
	|	Операция.Организация.КонтрагентБелгосстрах КАК СубконтоКт2,
	//|	Строки.РегистрацияВНалоговомОргане КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Пенсионный фонд"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|ГДЕ
	|	Строки.ВидОперации В (Значение(Перечисление.ВидыОперацийПоЗарплате.НДФЛ),
	|		Значение(Перечисление.ВидыОперацийПоЗарплате.НФДЛДивидендыСотрудникам))//,
	//|		Значение(Перечисление.ВидыОперацийПоЗарплате.ПенсионныйФонд))
	|
	|СГРУППИРОВАТЬ ПО
	|	Операция.Ссылка,
	|   Операция.Организация.КонтрагентБелгосстрах,
	//|	Строки.РегистрацияВНалоговомОргане,
	|	Операция.Организация,
	|	ВЫБОР
	|		КОГДА Операция.ПроводкиПоРаботникам
	|			ТОГДА Строки.ФизическоеЛицо
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ),
	|	Строки.ПодразделениеПредприятия,
	|	Строки.ПодразделениеПредприятия
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// }
	// 4D
	// НДФЛДоходыКонтрагентов
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Сумма(Строки.Сумма) КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасчетыСРазнымиДебиторамиИКредиторами) КАК СчетДт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДФЛ) КАК СчетКт,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.Налог) КАК СубконтоКт1,
	|	Строки.РегистрацияВНалоговомОргане КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	// 4D:ERP для Беларуси, АлексейЧ, 06.12.2017 10:07:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	""Подоходный налог (доходы контрагентов)"" КАК Содержание
	// }
	// 4D
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|ГДЕ
	|	Строки.ВидОперации В (Значение(Перечисление.ВидыОперацийПоЗарплате.НДФЛДоходыКонтрагентов),
	|		Значение(Перечисление.ВидыОперацийПоЗарплате.НДФЛРасчетыСБывшимиСотрудниками))
	|
	|СГРУППИРОВАТЬ ПО
	|	Операция.Ссылка,
	|	Строки.РегистрацияВНалоговомОргане,
	|	Операция.Организация,
	|	ВЫБОР
	|		КОГДА Операция.ПроводкиПоРаботникам
	|			ТОГДА Строки.ФизическоеЛицо
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ),
	|	Строки.ПодразделениеПредприятия,
	|	Строки.ПодразделениеПредприятия
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// НДФЛПередачаЗадолженностиВНалоговыйОрган
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	-Сумма(Строки.Сумма) КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) КАК СчетДт,
	|	ВЫБОР КОГДА Операция.ПроводкиПоРаботникам 
	|		ТОГДА Строки.ФизическоеЛицо
	|	ИНАЧЕ
	|		Значение(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДФЛ) КАК СчетКт,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.Налог) КАК СубконтоКт1,
	|	Строки.РегистрацияВНалоговомОргане КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	// 4D:ERP для Беларуси, АлексейЧ, 06.12.2017 10:07:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	""Подоходный налог (передача задолженности в налоговый орган)"" КАК Содержание
	// }
	// 4D
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|ГДЕ
	|	Строки.ВидОперации = Значение(Перечисление.ВидыОперацийПоЗарплате.НДФЛПередачаЗадолженностиВНалоговыйОрган)
	|
	|СГРУППИРОВАТЬ ПО
	|	Операция.Ссылка,
	|	Строки.РегистрацияВНалоговомОргане,
	|	Операция.Организация,
	|	ВЫБОР
	|		КОГДА Операция.ПроводкиПоРаботникам
	|			ТОГДА Строки.ФизическоеЛицо
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ),
	|	Строки.ПодразделениеПредприятия,
	|	Строки.ПодразделениеПредприятия
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// НДФЛПрочиеРасчетыСПерсоналом
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Сумма(Строки.Сумма) КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоПрочимОперациям) КАК СчетДт,
	|	Строки.ФизическоеЛицо КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДФЛ) КАК СчетКт,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.Налог) КАК СубконтоКт1,
	|	Строки.РегистрацияВНалоговомОргане КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	// 4D:ERP для Беларуси, АлексейЧ, 06.12.2017 10:07:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	""Подоходный налог (прочие расчеты с персоналом)"" КАК Содержание
	// }
	// 4D
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|ГДЕ
	|	Строки.ВидОперации = Значение(Перечисление.ВидыОперацийПоЗарплате.НДФЛПрочиеРасчетыСПерсоналом)
	|
	|СГРУППИРОВАТЬ ПО
	|	Операция.Ссылка,
	|	Строки.РегистрацияВНалоговомОргане,
	|	Операция.Организация,
	|	Строки.ФизическоеЛицо,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ),
	|	Строки.ПодразделениеПредприятия,
	|	Строки.ПодразделениеПредприятия
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// НДФЛДоначисленныйПоРезультатамПроверки
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Сумма(Строки.Сумма) КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) КАК СчетДт,
	|	ВЫБОР КОГДА Операция.ПроводкиПоРаботникам 
	|		ТОГДА Строки.ФизическоеЛицо
	|	ИНАЧЕ
	|		Значение(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДФЛ) КАК СчетКт,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.НалогАкт) КАК СубконтоКт1,
	|	Строки.РегистрацияВНалоговомОргане КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	// 4D:ERP для Беларуси, АлексейЧ, 06.12.2017 10:07:15 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	""Подоходный налог (доначисленный по результатам проверки)"" КАК Содержание
	// }
	// 4D
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|ГДЕ
	|	Строки.ВидОперации = Значение(Перечисление.ВидыОперацийПоЗарплате.НДФЛДоначисленныйПоРезультатамПроверки)
	|
	|СГРУППИРОВАТЬ ПО
	|	Операция.Ссылка,
	|	Строки.РегистрацияВНалоговомОргане,
	|	Операция.Организация,
	|	ВЫБОР
	|		КОГДА Операция.ПроводкиПоРаботникам
	|			ТОГДА Строки.ФизическоеЛицо
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ),
	|	Строки.ПодразделениеПредприятия,
	|	Строки.ПодразделениеПредприятия
	|";
#КонецОбласти

#Область ТекстЗапросаУдержания
	ТекстЗапросаУдержания = "
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	Строки.НомерСтроки КАК ИдентификаторСтроки,
	|
	|	Строки.Сумма КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) КАК СчетДт,
	|	ВЫБОР КОГДА (Операция.Сводно Или Не Операция.ПроводкиПоРаботникам) ТОГДА
	|		НЕОПРЕДЕЛЕНО
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	Строки.СчетУчета КАК СчетКт,
	|	Строки.Субконто1 КАК СубконтоКт1,
	|	Строки.Субконто2 КАК СубконтоКт2,
	|	Строки.Субконто3 КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	Строки.ВидОперации КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете.УдержаннаяЗарплата КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|ГДЕ
	|	Строки.ВидОперации НЕ В (Значение(Перечисление.ВидыОперацийПоЗарплате.ВозвратИзлишнеВыплаченныхСуммВследствиеСчетныхОшибок))
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// Возврат излишне выплаченных суммы вследствие счетных ошибок
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Строки.Сумма КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда) КАК СчетДт,
	|	ВЫБОР КОГДА (Операция.Сводно Или Не Операция.ПроводкиПоРаботникам) ТОГДА
	|		НЕОПРЕДЕЛЕНО
	|	ИНАЧЕ
	|		Строки.ФизическоеЛицо
	|	КОНЕЦ КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	Строки.СтатьяДоходов КАК АналитикаУчетаКт,
	|	Строки.ПодразделениеПредприятия КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Возврат излишне выплаченных суммы вследствие счетных ошибок"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете.УдержаннаяЗарплата КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|ГДЕ
	|	Строки.ВидОперации В (Значение(Перечисление.ВидыОперацийПоЗарплате.ВозвратИзлишнеВыплаченныхСуммВследствиеСчетныхОшибок))
	|";
	
#КонецОбласти
	
#Область ТекстЗапросаНачисленныеПроцентыПоЗаймам
	
	ТекстЗапросаНачисленныеПроцентыПоЗаймам = "
	// Начисленные проценты по займам
	|ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	КОНЕЦПЕРИОДА(Операция.ПериодРегистрации, МЕСЯЦ) КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Строки.Сумма КАК Сумма,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоПредоставленнымЗаймам) КАК СчетДт,
	|	Строки.ФизическоеЛицо КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	Строки.СтатьяДоходов КАК АналитикаУчетаКт,
	|	Строки.ПодразделениеПредприятия КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.ПодразделениеПредприятия КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Начисленные проценты по займам"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныеПроцентыПоЗаймам КАК Строки
	|	ПО
	|		Строки.Ссылка = Операция.Ссылка
	|";
	
#КонецОбласти
	
	Возврат                   ТекстЗапросаНачисленоПостатьям
		+ " ОБЪЕДИНИТЬ ВСЕ" + ТекстЗапросаЕжегодныйОтпускОценочныеОбязательстваИРезервы
		+ " ОБЪЕДИНИТЬ ВСЕ" + ТекстЗапросаЕжегодныйОтпускРезервы
		+ " ОБЪЕДИНИТЬ ВСЕ" + ТекстЗапросаЕжегодныйОтпускОценочныеОбязательства
		+ " ОБЪЕДИНИТЬ ВСЕ" + ТекстЗапросаНачисленоСдельно
		+ " ОБЪЕДИНИТЬ ВСЕ" + ТекстЗапросаНДФЛ
		+ " ОБЪЕДИНИТЬ ВСЕ" + ТекстЗапросаУдержания
		+ " ОБЪЕДИНИТЬ ВСЕ" + ТекстЗапросаНачисленныеПроцентыПоЗаймам
		+ "";
	
КонецФункции

// Функция возвращает текст запроса дополнительных временных таблиц, 
// необходимых для отражения в регламентированном учете
//
// Возвращаемое значение:
//   Строка - текст построения временной таблицы для отражения в регл. учете
//
Функция ТекстЗапросаВТОтраженияВРеглУчете() Экспорт
	
	ТекстыЗапроса = Новый СписокЗначений;
	
	ТекстЗапроса = 
		ТекстЗапросаВтСписокСпособовОтражения(Неопределено, ТекстыЗапроса) +
		";
		|////////////////////////////////////////////////////////////////////////////////
		|" +
		ТекстЗапросаТаблицаНачисленнаяЗарплатаИВзносы(Неопределено, ТекстыЗапроса) +
		"ВЫБРАТЬ
		|	ВТНачисленнаяЗарплатаИВзносы.Ссылка,
		|	МАКСИМУМ(ВТНачисленнаяЗарплатаИВзносы.НомерСтроки) КАК НомерСтроки,
		|	ВТНачисленнаяЗарплатаИВзносы.Подразделение,
		|	ВТНачисленнаяЗарплатаИВзносы.НаправлениеДеятельности,
		|	ВТНачисленнаяЗарплатаИВзносы.ВидОперации,
		|	ВТНачисленнаяЗарплатаИВзносы.СтатьяРасходов,
		|	ВТНачисленнаяЗарплатаИВзносы.АналитикаРасходов,
		|	ВТНачисленнаяЗарплатаИВзносы.АналитикаАктивовПассивов,
		|	ВТНачисленнаяЗарплатаИВзносы.СчетУчета,
		|	ВТНачисленнаяЗарплатаИВзносы.Субконто1,
		|	ВТНачисленнаяЗарплатаИВзносы.Субконто2,
		|	ВТНачисленнаяЗарплатаИВзносы.Субконто3,
		|	МАКСИМУМ(ВТНачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ) КАК ВидНачисленияОплатыТрудаДляНУ,
		|	СУММА(ВТНачисленнаяЗарплатаИВзносы.Сумма) КАК Сумма,
		|	ВТНачисленнаяЗарплатаИВзносы.ФизическоеЛицо КАК ФизическоеЛицо,
		|	ВТНачисленнаяЗарплатаИВзносы.СчетКт КАК СчетКт,
		|	ВЫБОР
		|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL 
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
		|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации)
		|	КОНЕЦ КАК ВидСчетаДт,
		|	СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходов КАК ВариантРаспределенияРасходов,
		|	ВЫБОР
		|		КОГДА ВТНачисленнаяЗарплатаИВзносы.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
		|			ТОГДА ВТНачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ
		|		ИНАЧЕ ВТНачисленнаяЗарплатаИВзносы.ВидПлатежаВГосБюджет
		|	КОНЕЦ КАК СубконтоКт2,
		|	ВТНачисленнаяЗарплатаИВзносы.ТипНалога КАК ТипНалога
		|ПОМЕСТИТЬ НачисленнаяЗарплатаИВзносы
		|ИЗ
		|	ВТНачисленнаяЗарплатаИВзносы КАК ВТНачисленнаяЗарплатаИВзносы
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
		|	ПО 
		|		ВТНачисленнаяЗарплатаИВзносы.СтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
		|		И (СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы))
		|
		|ГДЕ
		|	ВТНачисленнаяЗарплатаИВзносы.Сумма <> 0
		|
		|СГРУППИРОВАТЬ ПО
		|	ВТНачисленнаяЗарплатаИВзносы.Ссылка,
		|	ВТНачисленнаяЗарплатаИВзносы.Подразделение,
		|	ВТНачисленнаяЗарплатаИВзносы.НаправлениеДеятельности,
		|	ВТНачисленнаяЗарплатаИВзносы.ВидОперации,
		|	ВТНачисленнаяЗарплатаИВзносы.СтатьяРасходов,
		|	ВТНачисленнаяЗарплатаИВзносы.АналитикаРасходов,
		|	ВТНачисленнаяЗарплатаИВзносы.АналитикаАктивовПассивов,
		|	ВТНачисленнаяЗарплатаИВзносы.СчетУчета,
		|	ВТНачисленнаяЗарплатаИВзносы.Субконто1,
		|	ВТНачисленнаяЗарплатаИВзносы.Субконто2,
		|	ВТНачисленнаяЗарплатаИВзносы.Субконто3,
		|	ВТНачисленнаяЗарплатаИВзносы.СчетКт,
		|	ВЫБОР
		|		КОГДА СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL 
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
		|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации)
		|	КОНЕЦ,
		|	СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходов,
		|	ВТНачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
		|	ВЫБОР
		|		КОГДА ВТНачисленнаяЗарплатаИВзносы.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
		|			ТОГДА ВТНачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ
		|		ИНАЧЕ ВТНачисленнаяЗарплатаИВзносы.ВидПлатежаВГосБюджет
		|	КОНЕЦ,
		|	ВТНачисленнаяЗарплатаИВзносы.ТипНалога
		|;";
		
		Возврат ТекстЗапроса;
		
	КонецФункции

// Функция возвращает статью активов пассивов по умолчанию для заполнения в табличной части Удержания.
// Вызывается из формы документа, а также используется правилами загрузки данных из ЗУП25.
//
// Параметры:
//   ФизическоеЛицо - СправочникСсылка.ФизическиеЛица - физическое лицо, работник,
//   ПодразделениеПредприятия - СправочникСсылка.СтруктураПредприятия - управленческое подразделение,
//   ВидОперации - ПеречислениеСсылка.ВидыОперацийПоЗарплате - вид операции,
//   Контрагент - СправочникСсылка.Контрагенты - контрагент, соответствующий физическому лицу,
//   ТекущийДокумент - ДокументСсылка.ОтражениеЗарплатыВФинансовомУчете - текущий документ,
//   ДатаАктуальности - Дата - дата, до которой обрабатываются документы.
//
// Возвращаемое значение:
//   Структура - структура с полями СтатьяАктивовПассивов, АналитикаАктивовПассивов, СчетУчета, Субконто1, Субконто2, Субконто3, ПредставлениеОтраженияВРеглУчете.
//
Функция СтатьяАктивовПассивовПоУмолчанию(ФизическоеЛицо, ПодразделениеПредприятия, ВидОперации, Контрагент, ТекущийДокумент, ДатаАктуальности) Экспорт
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	&ФизическоеЛицо КАК ФизическоеЛицо,
	|	&ПодразделениеПредприятия КАК ПодразделениеПредприятия,
	|	&ВидОперации КАК ВидОперации,
	|	&Контрагент КАК Контрагент
	|ПОМЕСТИТЬ ВТНезаполненнаяАналитика";
	
	МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("ФизическоеЛицо",           ФизическоеЛицо);
	Запрос.УстановитьПараметр("ПодразделениеПредприятия", ПодразделениеПредприятия);
	Запрос.УстановитьПараметр("ВидОперации",              ВидОперации);
	Запрос.УстановитьПараметр("Контрагент",               Контрагент);
	Запрос.Выполнить();
	
	Документы.ОтражениеЗарплатыВФинансовомУчете.СоздатьВТАналитикаДругихДокументов(МенеджерВременныхТаблиц, ТекущийДокумент, ДатаАктуальности, "УдержаннаяЗарплата");
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	АналитикаДругихДокументов.ФизическоеЛицо КАК ФизическоеЛицо,
	|	АналитикаДругихДокументов.ВидОперации КАК ВидОперации,
	|	АналитикаДругихДокументов.СтатьяАктивовПассивов КАК СтатьяАктивовПассивов,
	|	АналитикаДругихДокументов.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
	|	АналитикаДругихДокументов.СчетУчета КАК СчетУчета,
	|	АналитикаДругихДокументов.Субконто1 КАК Субконто1,
	|	АналитикаДругихДокументов.Субконто2 КАК Субконто2,
	|	АналитикаДругихДокументов.Субконто3 КАК Субконто3
	|ИЗ
	|	ЗаполненнаяСтатьяПассивов КАК АналитикаДругихДокументов";
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;
	РезультатЗапроса = Запрос.Выполнить();
	
	СтатьяАналитикаРасходов = Новый Структура("СтатьяАктивовПассивов, АналитикаАктивовПассивов, СчетУчета, Субконто1, Субконто2, Субконто3, ПредставлениеОтраженияВРеглУчете");
	
	Выборка = РезультатЗапроса.Выбрать();
	Если Выборка.Следующий() Тогда
		ЗаполнитьЗначенияСвойств(СтатьяАналитикаРасходов, Выборка);
	КонецЕсли;
	
	СтатьяАналитикаРасходов.ПредставлениеОтраженияВРеглУчете = РеглУчетВызовСервера.ПредставлениеОтраженияВРеглУчете(СтатьяАналитикаРасходов);
	
	Возврат СтатьяАналитикаРасходов;
	
КонецФункции

// Функция возвращает статью доходов по умолчанию для заполнения в табличной части начисленных процентов по займам.
// Вызывается из формы документа, а также используется правилами загрузки данных из ЗУП25.
//
// Параметры:
//   ФизическоеЛицо - СправочникСсылка.ФизическиеЛица - физическое лицо, работник,
//   ПодразделениеПредприятия - СправочникСсылка.СтруктураПредприятия - управленческое подразделение,
//   ТекущийДокумент - ДокументСсылка.ОтражениеЗарплатыВФинансовомУчете - текущий документ,
//   ДатаАктуальности - Дата - дата, до которой обрабатываются документы.
//
// Возвращаемое значение:
//   Структура - структура с полями СтатьяДоходов, АналитикаДоходов.
//
Функция СтатьяДоходовПоУмолчанию(ФизическоеЛицо, ПодразделениеПредприятия, ТекущийДокумент, ДатаАктуальности) Экспорт
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	&ФизическоеЛицо КАК ФизическоеЛицо,
	|	&ПодразделениеПредприятия КАК ПодразделениеПредприятия
	|ПОМЕСТИТЬ ВТНезаполненнаяАналитикаДоходов";
	
	МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("ФизическоеЛицо", ФизическоеЛицо);
	Запрос.УстановитьПараметр("ПодразделениеПредприятия", ПодразделениеПредприятия);
	Запрос.Выполнить();
	
	Документы.ОтражениеЗарплатыВФинансовомУчете.СоздатьВТАналитикаДругихДокументов(МенеджерВременныхТаблиц, ТекущийДокумент, ДатаАктуальности, "НачисленныеПроцентыПоЗаймам");
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ЗаполненнаяСтатьяДоходов.ФизическоеЛицо КАК ФизическоеЛицо,
	|	ЗаполненнаяСтатьяДоходов.СтатьяДоходов КАК СтатьяДоходов,
	|	ЗаполненнаяСтатьяДоходов.АналитикаДоходов КАК АналитикаДоходов
	|ИЗ
	|	ВТЗаполненнаяСтатьяДоходов КАК ЗаполненнаяСтатьяДоходов";
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;
	РезультатЗапроса = Запрос.Выполнить();
	
	СтатьяАналитикаДоходов = Новый Структура("СтатьяДоходов, АналитикаДоходов");
	
	Выборка = РезультатЗапроса.Выбрать();
	Если Выборка.Следующий() Тогда
		ЗаполнитьЗначенияСвойств(СтатьяАналитикаДоходов, Выборка);
	КонецЕсли;
	
	Возврат СтатьяАналитикаДоходов;
	
КонецФункции

// Получает списки с элементами выбора по видам.
// Параметры:
//	Организация - СправочникСсылка.Организации, организация по которой требуется учетную политику.
//	Дата - Дата, дата на которую требуется получить учетную политику.
//	ТребуемыеСписки - Массив - Строка, перечень видов списков, которые необходимо получить.
// Возвращаемое значение:
//	Структура
//		*
//		*
//
Процедура ЗаполнитьСпискиВыбораЭлементов(Элементы, Организация, Период, СписокЭлементов) Экспорт

	ПараметрыУП = Неопределено;
	Если ЗначениеЗаполнено(Организация) И ЗначениеЗаполнено(Период) Тогда
		ПараметрыУП = РегистрыСведений.УчетнаяПолитикаОрганизаций.ПараметрыУчетнойПолитики(Организация, Период);
	КонецЕсли;
	
	ПредставленияЭлементов = Новый Соответствие;
	ПредставленияЭлементов.Вставить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства, 
		НСтр("ru = 'Отпуск за счет обязательств'"));
	ПредставленияЭлементов.Вставить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы, 
		НСтр("ru = 'Отпуск за счет резервов'"));
	ПредставленияЭлементов.Вставить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы, 
		НСтр("ru = 'Отпуск за счет обязательств и резервов'"));
	ПредставленияЭлементов.Вставить(Перечисления.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпуска, 
		НСтр("ru = 'Компенсация отпуска'"));
	ПредставленияЭлементов.Вставить(Перечисления.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства, 
		НСтр("ru = 'Компенсация отпуска за счет обязательств'"));
		
	НеиспользуемыеОперации = Новый Массив;
	НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.Депонирование);
	НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.СписаниеДепонента);
	НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.РасходыПоСтрахованиюБюджет);
	НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.Дивиденды);
	НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.ДивидендыСотрудников);
	НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервыБУ);
	НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервыНУ);
	НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.НачисленоПроцентовПоЗайму);
	
	Если ПолучитьФункциональнуюОпцию("ИспользоватьНачислениеЗарплаты") Тогда
		
		Если Не ПараметрыУП = Неопределено И Не ПараметрыУП.ФормироватьРезервОтпусковБУ Тогда
			
			// Не ведутся ни в БУ ни в НУ.
			НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства);
			НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы);
			НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы);
			НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства);
			
		ИначеЕсли Не ПараметрыУП = Неопределено И Не ПараметрыУП.ФормироватьРезервОтпусковНУ Тогда
			
			// Ведутся только в БУ.
			НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы);
			НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы);
			
		Иначе
			
			// Ведутся в БУ и НУ.
			НеиспользуемыеОперации.Добавить(Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства);
			
		КонецЕсли;
		
	КонецЕсли;
	
	Для Каждого Элемент Из СписокЭлементов Цикл
		
		Элементы[Элемент].СписокВыбора.Очистить();
		
		ПараметрыВыбора = ПараметрыВыбораСтруктурой(Элементы[Элемент].ПараметрыВыбора);
		СписокВыбора = Перечисления.ВидыОперацийПоЗарплате.ПолучитьДанныеВыбора(ПараметрыВыбора);
		
		Индекс = 0;
		Пока Индекс < СписокВыбора.Количество() Цикл
			
			ЭлементВыбора = СписокВыбора[Индекс];
			
			Если Не НеиспользуемыеОперации.Найти(ЭлементВыбора.Значение) = Неопределено Тогда
				
				СписокВыбора.Удалить(ЭлементВыбора);
				Продолжить;
				
			КонецЕсли;
			
			Индекс = Индекс + 1;

			ПредставлениеЭлемента = ПредставленияЭлементов.Получить(ЭлементВыбора.Значение);
			Если Не ПредставлениеЭлемента = Неопределено Тогда
				ЭлементВыбора.Представление = ПредставлениеЭлемента;
			КонецЕсли;
			
			ЗаполнитьЗначенияСвойств(Элементы[Элемент].СписокВыбора.Добавить(), ЭлементВыбора);
			
		КонецЦикла;
		
	КонецЦикла;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#Область Проведение

Процедура ИнициализироватьДанныеДокумента(ДокументСсылка, ДополнительныеСвойства, Регистры = Неопределено) Экспорт
	
	Запрос = Новый Запрос;
	ЗаполнитьПараметрыИнициализации(Запрос, ДокументСсылка);
	
	ТекстыЗапроса = Новый СписокЗначений;
	
	ТекстЗапросаТаблицаТрудозатратыНезавершенногоПроизводства(Запрос, ТекстыЗапроса, Регистры);
	ТекстЗапросаТаблицаОтражениеЗарплатыВФинансовомУчете(Запрос, ТекстыЗапроса, Регистры);
	
	ТекстЗапросаТаблицаПрочиеРасходы(Запрос, ТекстыЗапроса, Регистры);
	ТекстЗапросаТаблицаПартииПрочихРасходов(Запрос, ТекстыЗапроса, Регистры);
	
	ТекстЗапросаТаблицаДвиженияДоходыРасходыПрочиеАктивыПассивы(Запрос, ТекстыЗапроса, Регистры);
	ТекстЗапросаТаблицаДвиженияДенежныеСредстваДоходыРасходы(Запрос, ТекстыЗапроса, Регистры);
	ТекстЗапросаТаблицаПрочиеАктивыПассивы(Запрос, ТекстыЗапроса, Регистры);
	
	ТекстЗапросаТаблицаПрочиеДоходы(Запрос, ТекстыЗапроса, Регистры);
	ТекстЗапросаТаблицаДенежныеСредстваУПодотчетныхЛиц(Запрос, ТекстыЗапроса, Регистры);
	
	ТекстЗапросаТаблицаОтражениеДокументовВРеглУчете(Запрос, ТекстыЗапроса, Регистры);
	ТекстЗапросаТаблицаПорядокОтраженияПрочихОпераций(Запрос, ТекстыЗапроса, Регистры);
	
	// Формирование запроса и заполнение таблиц
	ПроведениеСерверУТ.ИницализироватьТаблицыДляДвижений(Запрос, ТекстыЗапроса, ДополнительныеСвойства.ТаблицыДляДвижений, Истина);
	
КонецПроцедуры

Процедура ЗаполнитьПараметрыИнициализации(Запрос, ДокументСсылка)
	
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("Ссылка", ДокументСсылка);
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Реквизиты.Ссылка                                 КАК Ссылка,
	|	Реквизиты.Дата                                   КАК Дата,
	|	КОНЕЦПЕРИОДА(Реквизиты.ПериодРегистрации, МЕСЯЦ) КАК ПериодРегистрации,
	|	Реквизиты.Организация                            КАК Организация,
	|	Не Реквизиты.Сводно                              КАК ДетализацияПоФизлицам,
	|	Реквизиты.Сводно                                 КАК Сводно,
	|	Реквизиты.ПроводкиПоРаботникам                   КАК ПроводкиПоРаботникам
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете КАК Реквизиты
	|ГДЕ
	|	Реквизиты.Ссылка = &Ссылка";
	
	Реквизиты = Запрос.Выполнить().Выбрать();
	Реквизиты.Следующий();
	
	ВалютаРегл = Константы.ВалютаРегламентированногоУчета.Получить();
	Коэффициенты = РаботаСКурсамивалютУТ.ПолучитьКоэффициентыПересчетаВалюты(
		ВалютаРегл,
		ВалютаРегл,
		Реквизиты.ПериодРегистрации);
	
	Запрос.УстановитьПараметр("Ссылка",                                 Реквизиты.Ссылка);
	Запрос.УстановитьПараметр("Период",                                 Реквизиты.ПериодРегистрации);
	Запрос.УстановитьПараметр("Дата",                                   Реквизиты.Дата);
	Запрос.УстановитьПараметр("Организация",                            Реквизиты.Организация);
	Запрос.УстановитьПараметр("ДетализацияПоФизлицам",                  Реквизиты.ДетализацияПоФизлицам);
	Запрос.УстановитьПараметр("ДатаНачала",                             НачалоМесяца(Реквизиты.ПериодРегистрации));
	Запрос.УстановитьПараметр("ДатаОкончания",                          КонецМесяца(Реквизиты.ПериодРегистрации));
	Запрос.УстановитьПараметр("КоэффициентПересчетаВВалютуУпр",         Коэффициенты.КоэффициентПересчетаВВалютуУПР);
	Запрос.УстановитьПараметр("Сводно",                                 Реквизиты.Сводно);
	Запрос.УстановитьПараметр("ПроводкиПоРаботникам",                   Реквизиты.ПроводкиПоРаботникам);
	Запрос.УстановитьПараметр("ВалютаРегл",                             Константы.ВалютаРегламентированногоУчета.Получить());
	Запрос.УстановитьПараметр("ИспользоватьУчетПрочихАктивовПассивов",  ПолучитьФункциональнуюОпцию("ИспользоватьУчетПрочихАктивовПассивов"));
	
КонецПроцедуры

#Область УстановкаВременныхТаблицИПараметров

Функция ТекстЗапросаВтНачисленнаяЗарплатаИВзносы(Запрос, ТекстыЗапроса)
	
	ТекстЗапросаВтТаблицаДокументовКОтражению(Запрос, ТекстыЗапроса);
	
	ТекстЗапросаВтСписокСпособовОтражения(Запрос, ТекстыЗапроса);
	
	ТекстЗапросаТаблицаНачисленнаяЗарплатаИВзносы(Запрос, ТекстыЗапроса);
	
	Возврат "";
	
КонецФункции

Функция ТекстЗапросаВтТаблицаДокументовКОтражению(Запрос, ТекстыЗапроса)
	
	ИмяРегистра = "ВтТаблицаДокументовКОтражению";
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Документ.Ссылка КАК Ссылка
	|ПОМЕСТИТЬ ДокументыКОтражению
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете КАК Документ
	|ГДЕ
	|	Документ.Ссылка = &Ссылка";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаВтСписокСпособовОтражения(Запрос, ТекстыЗапроса)
	
	ИмяРегистра = "ВтСписокСпособовОтражения";
	
	ТекстЗапроса =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	НачисленнаяЗарплата.СпособОтраженияЗарплатыВБухучете КАК СпособОтражения
	|ПОМЕСТИТЬ ВтСписокСпособовОтражения
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленнаяЗарплатаИВзносы КАК НачисленнаяЗарплата
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДокументыКОтражению КАК ДокументыКОтражению
	|		ПО НачисленнаяЗарплата.Ссылка = ДокументыКОтражению.Ссылка";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаНачисленнаяЗарплатаИВзносы(Запрос, ТекстыЗапроса)
	
#Область ВтТаблицаДанныхСпособовОтражения
	
	ИмяРегистра = "ВтТаблицаДанныхСпособовОтражения";
	
	ТекстЗапросаВтТаблицаДанныхСпособовОтражения = Справочники.СпособыОтраженияЗарплатыВБухУчете.ТекстЗапросаДанныхСпособов("ВтТаблицаДанныхСпособовОтражения");
	
	ТекстыЗапроса.Добавить(ТекстЗапросаВтТаблицаДанныхСпособовОтражения, ИмяРегистра);
	
#КонецОбласти
	
#Область ВТТаблицаДокумента
	
	ИмяРегистра = "ВТТаблицаДокумента";
	ТекстЗапросаВТТаблицаДокумента =
	"ВЫБРАТЬ
	|	ЗарплатаСводно.Ссылка КАК Ссылка,
	|	ЗарплатаСводно.Ссылка.Организация КАК Организация,
	|	ЗарплатаСводно.НомерСтроки КАК НомерСтроки,
	|	ЗарплатаСводно.ПодразделениеПредприятия КАК Подразделение,
	|	ЗарплатаСводно.ВидОперации КАК ВидОперации,
	|	ЗарплатаСводно.ОблагаетсяЕНВД КАК ОблагаетсяЕНВД,
	|	ЗарплатаСводно.СпособОтраженияЗарплатыВБухучете КАК СпособОтраженияЗарплатыВБухучете,
	|	ВЫБОР
	|		КОГДА ЗарплатаСводно.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НатуральныйДоход)
	|			ТОГДА 0
	|		ИНАЧЕ ЗарплатаСводно.Сумма
	|	КОНЕЦ КАК Сумма,
	// 4D:ERP для Беларуси, Яна, 04.09.2017 11:17:05 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	ЗарплатаСводно.ФСЗН КАК ФСЗН,
	//|	ЗарплатаСводно.ПенсионныйФонд КАК ПенсионныйФонд,
	|	ЗарплатаСводно.Белгосстрах КАК Белгосстрах,
	//|	ЗарплатаСводно.ПС КАК ПС,
	//|	ЗарплатаСводно.СС КАК СС,
	// }
	// 4D	
	|	ЗарплатаСводно.ВидНачисленияОплатыТрудаДляНУ КАК ВидНачисленияОплатыТрудаДляНУ,
	|	ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка) КАК ФизическоеЛицо,
	|	ЗарплатаСводно.ВзносыВсего
	|ПОМЕСТИТЬ ВТТаблицаДокумента
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленнаяЗарплатаИВзносы КАК ЗарплатаСводно
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДокументыКОтражению КАК ДокументыКОтражению
	|		ПО ЗарплатаСводно.Ссылка = ДокументыКОтражению.Ссылка
	|ГДЕ
	|	ЗарплатаСводно.Ссылка.Сводно
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ЗарплатаДетально.Ссылка,
	|	ЗарплатаДетально.Ссылка.Организация КАК Организация,
	|	ЗарплатаДетально.НомерСтроки,
	|	ЗарплатаДетально.ПодразделениеПредприятия,
	|	ЗарплатаДетально.ВидОперации,
	|	ЗарплатаДетально.ОблагаетсяЕНВД КАК ОблагаетсяЕНВД,
	|	ЗарплатаДетально.СпособОтраженияЗарплатыВБухучете,
	|	СУММА(ВЫБОР
	|		КОГДА ЗарплатаДетально.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НатуральныйДоход)
	|			ТОГДА 0
	|		ИНАЧЕ ЗарплатаДетально.Сумма
	|	КОНЕЦ),
	// 4D:ERP для Беларуси, Яна, 04.09.2017 11:17:05 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	СУММА(ЗарплатаДетально.ФСЗН),
	//|	СУММА(ЗарплатаДетально.ПенсионныйФонд),
	|	СУММА(ЗарплатаДетально.Белгосстрах),
	//|	СУММА(ЗарплатаДетально.ПС),
	//|	СУММА(ЗарплатаДетально.СС),
	// }
	// 4D
	|	ЗарплатаДетально.ВидНачисленияОплатыТрудаДляНУ,
	|	ВЫБОР КОГДА ЗарплатаДетально.Ссылка.ПроводкиПоРаботникам ТОГДА
	|		ЗарплатаДетально.ФизическоеЛицо
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ КАК ФизическоеЛицо,
	|	СУММА(ЗарплатаДетально.ВзносыВсего)
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленнаяЗарплатаИВзносыПоФизлицам КАК ЗарплатаДетально
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДокументыКОтражению КАК ДокументыКОтражению
	|		ПО ЗарплатаДетально.Ссылка = ДокументыКОтражению.Ссылка
	|ГДЕ
	|	НЕ ЗарплатаДетально.Ссылка.Сводно
	|
	|СГРУППИРОВАТЬ ПО
	|
	|	ЗарплатаДетально.Ссылка,
	|	ЗарплатаДетально.Ссылка.Организация,
	|	ЗарплатаДетально.НомерСтроки,
	|	ЗарплатаДетально.ПодразделениеПредприятия,
	|	ЗарплатаДетально.ВидОперации,
	|	ЗарплатаДетально.ОблагаетсяЕНВД,
	|	ЗарплатаДетально.СпособОтраженияЗарплатыВБухучете,
	|	ЗарплатаДетально.ВидНачисленияОплатыТрудаДляНУ,
	|	ВЫБОР КОГДА ЗарплатаДетально.Ссылка.ПроводкиПоРаботникам ТОГДА
	|		ЗарплатаДетально.ФизическоеЛицо
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ";
	
	ТекстыЗапроса.Добавить(ТекстЗапросаВТТаблицаДокумента, ИмяРегистра);
	
#КонецОбласти

#Область ТаблицаДокумента
	
	ИмяРегистра = "ТаблицаДокумента";
	ТекстЗапросаТаблицаДокумента =
	// сумма оплаты труда
	"ВЫБРАТЬ
	|	НачисленнаяЗарплатаИВзносы.Ссылка КАК Ссылка,
	|	НачисленнаяЗарплатаИВзносы.НомерСтроки КАК НомерСтроки,
	|	НачисленнаяЗарплатаИВзносы.Подразделение КАК Подразделение,
	|	НачисленнаяЗарплатаИВзносы.ВидОперации КАК ВидОперации,
	|	СтатьиРасходов.СтатьяРасходов КАК СтатьяРасходов,
	|	СтатьиРасходов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.АналитикаРасходов = ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Подразделение
	|		КОГДА СтатьиРасходов.АналитикаРасходов = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.ФизическоеЛицо
	|		КОГДА СтатьиРасходов.АналитикаРасходов = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Организация
	|		ИНАЧЕ СтатьиРасходов.АналитикаРасходов
	|	КОНЕЦ КАК АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивов = ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Подразделение
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивов = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.ФизическоеЛицо
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивов = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Организация
	|		ИНАЧЕ СтатьиРасходов.АналитикаАктивовПассивов
	|	КОНЕЦ КАК АналитикаАктивовПассивов,
	|	СтатьиРасходов.СчетУчета КАК СчетУчета,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.Субконто1 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.ФизическоеЛицо
	|		ИНАЧЕ СтатьиРасходов.Субконто1
	|	КОНЕЦ КАК Субконто1,
	|	СтатьиРасходов.Субконто2 КАК Субконто2,
	|	СтатьиРасходов.Субконто3 КАК Субконто3,
	|	НачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ КАК ВидНачисленияОплатыТрудаДляНУ,
	|	НачисленнаяЗарплатаИВзносы.Сумма КАК Сумма,
	|	ВЫБОР
	|		КОГДА НачисленнаяЗарплатаИВзносы.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ВыплатыБывшимСотрудникам)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|		ИНАЧЕ НачисленнаяЗарплатаИВзносы.ФизическоеЛицо
	|	КОНЕЦ КАК ФизическоеЛицо,
	|	ВЫБОР
	|		КОГДА НачисленнаяЗарплатаИВзносы.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ВыплатыБывшимСотрудникам)
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасчетыСРазнымиДебиторамиИКредиторами)
	|		КОГДА НачисленнаяЗарплатаИВзносы.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ПрочиеРасчетыСПерсоналом)
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоПрочимОперациям)
	|		КОГДА НачисленнаяЗарплатаИВзносы.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ДоходыКонтрагентов)
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасчетыСРазнымиДебиторамиИКредиторами)
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда)
	|	КОНЕЦ КАК СчетКт,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) КАК ТипНалога,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.ПустаяСсылка) КАК ВидПлатежаВГосБюджет
	|ПОМЕСТИТЬ ТаблицаДокумента
	|ИЗ
	|	ВТТаблицаДокумента КАК НачисленнаяЗарплатаИВзносы
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВтТаблицаДанныхСпособовОтражения КАК СтатьиРасходов
	|		ПО НачисленнаяЗарплатаИВзносы.СпособОтраженияЗарплатыВБухучете = СтатьиРасходов.СпособОтражения
	|			И (НачисленнаяЗарплатаИВзносы.ОблагаетсяЕНВД = СтатьиРасходов.ОблагаетсяЕНВД)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// Белгосстрах
	|ВЫБРАТЬ
	|	НачисленнаяЗарплатаИВзносы.Ссылка,
	|	НачисленнаяЗарплатаИВзносы.НомерСтроки,
	|	НачисленнаяЗарплатаИВзносы.Подразделение,
	|	НачисленнаяЗарплатаИВзносы.ВидОперации,
	|	СтатьиРасходов.СтатьяРасходовВзносов,
	|	СтатьиРасходов.НаправлениеДеятельности,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.АналитикаРасходовВзносов = ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Подразделение
	|		КОГДА СтатьиРасходов.АналитикаРасходовВзносов = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.ФизическоеЛицо
	|		КОГДА СтатьиРасходов.АналитикаРасходовВзносов = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ПустаяСсылка)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.Белгосстрах)
	|		КОГДА СтатьиРасходов.АналитикаРасходовВзносов = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Организация
	|		ИНАЧЕ СтатьиРасходов.АналитикаРасходовВзносов
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивовВзносов = ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Подразделение
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивовВзносов = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.ФизическоеЛицо
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивовВзносов = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ПустаяСсылка)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.Белгосстрах)
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивовВзносов = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Организация
	|		ИНАЧЕ СтатьиРасходов.АналитикаАктивовПассивовВзносов
	|	КОНЕЦ,
	|	СтатьиРасходов.СчетУчетаВзносов,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.Субконто1Взносов = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.ФизическоеЛицо
	|		ИНАЧЕ СтатьиРасходов.Субконто1Взносов
	|	КОНЕЦ,
	|	СтатьиРасходов.Субконто2Взносов,
	|	СтатьиРасходов.Субконто3Взносов,
	|	НачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ,
	|	НачисленнаяЗарплатаИВзносы.Белгосстрах,
	|	НачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
	|
	// 4D:ERP для Беларуси, Екатерина, 03.02.2016 15:50:52 
	// , №10801
	// {
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоОбязательномуСтрахованию),
	|
	|	ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.Белгосстрах),
	// }
	// 4D
	|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.Налог) КАК ВидПлатежаВГосБюджет
	|ИЗ
	|	ВТТаблицаДокумента КАК НачисленнаяЗарплатаИВзносы
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВтТаблицаДанныхСпособовОтражения КАК СтатьиРасходов
	|		ПО НачисленнаяЗарплатаИВзносы.СпособОтраженияЗарплатыВБухучете = СтатьиРасходов.СпособОтражения
	|			И (НачисленнаяЗарплатаИВзносы.ОблагаетсяЕНВД = СтатьиРасходов.ОблагаетсяЕНВД)
	|
	// 4D:ERP для Беларуси, Екатерина, 03.02.2016 15:50:52 
	// , №10801
	// {
	// Действие не требуется
	// }
	// 4D
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// ФСЗН
	|ВЫБРАТЬ
	|	НачисленнаяЗарплатаИВзносы.Ссылка,
	|	НачисленнаяЗарплатаИВзносы.НомерСтроки,
	|	НачисленнаяЗарплатаИВзносы.Подразделение,
	|	НачисленнаяЗарплатаИВзносы.ВидОперации,
	|	СтатьиРасходов.СтатьяРасходовВзносов,
	|	СтатьиРасходов.НаправлениеДеятельности,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.АналитикаРасходовВзносов = ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Подразделение
	|		КОГДА СтатьиРасходов.АналитикаРасходовВзносов = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.ФизическоеЛицо
	|		КОГДА СтатьиРасходов.АналитикаРасходовВзносов = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ПустаяСсылка)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ФСЗН)
	|		КОГДА СтатьиРасходов.АналитикаРасходовВзносов = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Организация
	|		ИНАЧЕ СтатьиРасходов.АналитикаРасходовВзносов
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивовВзносов = ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Подразделение
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивовВзносов = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.ФизическоеЛицо
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивовВзносов = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ПустаяСсылка)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ФСЗН)
	|		КОГДА СтатьиРасходов.АналитикаАктивовПассивовВзносов = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.Организация
	|		ИНАЧЕ СтатьиРасходов.АналитикаАктивовПассивовВзносов
	|	КОНЕЦ,
	|	СтатьиРасходов.СчетУчетаВзносов,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.Субконто1Взносов = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|			ТОГДА НачисленнаяЗарплатаИВзносы.ФизическоеЛицо
	|		ИНАЧЕ СтатьиРасходов.Субконто1Взносов
	|	КОНЕЦ,
	|	СтатьиРасходов.Субконто2Взносов,
	|	СтатьиРасходов.Субконто3Взносов,
	|	НачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ,
	|	НачисленнаяЗарплатаИВзносы.ФСЗН,
	|	НачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ФСС),
	|	ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ФСЗН),
	|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.Налог) КАК ВидПлатежаВГосБюджет
	|ИЗ
	|	ВТТаблицаДокумента КАК НачисленнаяЗарплатаИВзносы
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВтТаблицаДанныхСпособовОтражения КАК СтатьиРасходов
	|		ПО НачисленнаяЗарплатаИВзносы.СпособОтраженияЗарплатыВБухучете = СтатьиРасходов.СпособОтражения
	|			И (НачисленнаяЗарплатаИВзносы.ОблагаетсяЕНВД = СтатьиРасходов.ОблагаетсяЕНВД)
	|
	// 4D:ERP для Беларуси, Екатерина, 03.02.2016 16:29:19 
	// , №10801
	// {
	|";
	// }
	// 4D

	ТекстыЗапроса.Добавить(ТекстЗапросаТаблицаДокумента, ИмяРегистра);
	
#КонецОбласти

#Область ВТНачисленнаяЗарплатаИВзносы
	
	ИмяРегистра = "ВТНачисленнаяЗарплатаИВзносы";
	ТекстЗапросаВТНачисленнаяЗарплатаИВзносы =
	"ВЫБРАТЬ
	|	ВТНачисленнаяЗарплатаИВзносы.Ссылка,
	|	МИНИМУМ(ВТНачисленнаяЗарплатаИВзносы.НомерСтроки),
	|	ВТНачисленнаяЗарплатаИВзносы.Подразделение,
	|	ВТНачисленнаяЗарплатаИВзносы.ВидОперации,
	|	ВТНачисленнаяЗарплатаИВзносы.СтатьяРасходов,
	|	ВТНачисленнаяЗарплатаИВзносы.НаправлениеДеятельности,
	|	ВТНачисленнаяЗарплатаИВзносы.АналитикаРасходов,
	|	ВТНачисленнаяЗарплатаИВзносы.АналитикаАктивовПассивов,
	|	ВТНачисленнаяЗарплатаИВзносы.СчетУчета,
	|	ВТНачисленнаяЗарплатаИВзносы.Субконто1,
	|	ВТНачисленнаяЗарплатаИВзносы.Субконто2,
	|	ВТНачисленнаяЗарплатаИВзносы.Субконто3,
	|	ВТНачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ,
	|	СУММА(ВТНачисленнаяЗарплатаИВзносы.Сумма) КАК Сумма,
	|	ВТНачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
	|	ВТНачисленнаяЗарплатаИВзносы.СчетКт,
	|	ВТНачисленнаяЗарплатаИВзносы.ТипНалога,
	|	ВТНачисленнаяЗарплатаИВзносы.ВидПлатежаВГосБюджет,
	|	ВТНачисленнаяЗарплатаИВзносы.СтатьяРасходов.ВариантРаспределенияРасходов КАК ВариантРаспределенияРасходов
	|ПОМЕСТИТЬ ВТНачисленнаяЗарплатаИВзносы
	|ИЗ
	|	ТаблицаДокумента КАК ВТНачисленнаяЗарплатаИВзносы
	|
	|ГДЕ
	|	ВТНачисленнаяЗарплатаИВзносы.ВидОперации Не В(ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.РасходыПоСтрахованиюФСС),
	                                                 
													 // 4D:ERP для Беларуси, АлексейЧ, 15.12.2017 17:08:02 
													 // Локализовать документ "Отражение зарплаты в финансовом учете", №15826
													 // {
	|												  ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.РасходыПоСтрахованиюФСЗН),
													 // }
													 // 4D
	|												  ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.РасходыПоСтрахованиюФССНС),
	|												  ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы))
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТНачисленнаяЗарплатаИВзносы.ТипНалога,
	|	ВТНачисленнаяЗарплатаИВзносы.ВидПлатежаВГосБюджет,
	|	ВТНачисленнаяЗарплатаИВзносы.СчетКт,
	|	ВТНачисленнаяЗарплатаИВзносы.ВидОперации,
	|	ВТНачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
	|	ВТНачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ,
	|	ВТНачисленнаяЗарплатаИВзносы.АналитикаРасходов,
	|	ВТНачисленнаяЗарплатаИВзносы.АналитикаАктивовПассивов,
	|	ВТНачисленнаяЗарплатаИВзносы.СчетУчета,
	|	ВТНачисленнаяЗарплатаИВзносы.Субконто1,
	|	ВТНачисленнаяЗарплатаИВзносы.Субконто2,
	|	ВТНачисленнаяЗарплатаИВзносы.Субконто3,
	|	ВТНачисленнаяЗарплатаИВзносы.СтатьяРасходов,
	|	ВТНачисленнаяЗарплатаИВзносы.НаправлениеДеятельности,
	|	ВТНачисленнаяЗарплатаИВзносы.Ссылка,
	|	ВТНачисленнаяЗарплатаИВзносы.Подразделение,
	|	ВТНачисленнаяЗарплатаИВзносы.СтатьяРасходов.ВариантРаспределенияРасходов
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВТНачисленнаяЗарплатаИВзносы.Сумма) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// отпуска за счет обязательств и резервов
	|ВЫБРАТЬ
	|	НачисленнаяЗарплатаИВзносы.Ссылка,
	|	МИНИМУМ(НачисленнаяЗарплатаИВзносы.НомерСтроки),
	|	НачисленнаяЗарплатаИВзносы.Подразделение,
	|	НачисленнаяЗарплатаИВзносы.ВидОперации,
	|	НачисленнаяЗарплатаИВзносы.СтатьяРасходов,
	|	НачисленнаяЗарплатаИВзносы.НаправлениеДеятельности,
	|	НачисленнаяЗарплатаИВзносы.АналитикаРасходов,
	|	НачисленнаяЗарплатаИВзносы.АналитикаАктивовПассивов,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОценочныеОбязательстваПоВознаграждениям),
	|	ЗНАЧЕНИЕ(Справочник.Резервы.РезервЕжегодныхОтпусков),
	|	НЕОПРЕДЕЛЕНО,
	|	НЕОПРЕДЕЛЕНО,
	|	НачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ,
	|	СУММА(НачисленнаяЗарплатаИВзносы.Сумма),
	|	НачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
	|	НачисленнаяЗарплатаИВзносы.СчетКт,
	|	НачисленнаяЗарплатаИВзносы.ТипНалога,
	|	НачисленнаяЗарплатаИВзносы.ВидПлатежаВГосБюджет,
	|	НачисленнаяЗарплатаИВзносы.СтатьяРасходов.ВариантРаспределенияРасходов
	|ИЗ
	|	ТаблицаДокумента КАК НачисленнаяЗарплатаИВзносы
	|
	|ГДЕ
	|	НачисленнаяЗарплатаИВзносы.ВидОперации В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы))
	|	И НачисленнаяЗарплатаИВзносы.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленнаяЗарплатаИВзносы.Ссылка,
	|	НачисленнаяЗарплатаИВзносы.Подразделение,
	|	НачисленнаяЗарплатаИВзносы.ВидОперации,
	|	НачисленнаяЗарплатаИВзносы.СтатьяРасходов,
	|	НачисленнаяЗарплатаИВзносы.НаправлениеДеятельности,
	|	НачисленнаяЗарплатаИВзносы.АналитикаРасходов,
	|	НачисленнаяЗарплатаИВзносы.АналитикаАктивовПассивов,
	|	НачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ,
	|	НачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
	|	НачисленнаяЗарплатаИВзносы.СчетКт,
	|	НачисленнаяЗарплатаИВзносы.ТипНалога,
	|	НачисленнаяЗарплатаИВзносы.ВидПлатежаВГосБюджет,
	|	НачисленнаяЗарплатаИВзносы.СтатьяРасходов
	|
	|ИМЕЮЩИЕ
	|	СУММА(НачисленнаяЗарплатаИВзносы.Сумма) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// взносы за счет обязательств и резервов
	|ВЫБРАТЬ
	|	НачисленнаяЗарплатаИВзносы.Ссылка,
	|	МИНИМУМ(НачисленнаяЗарплатаИВзносы.НомерСтроки),
	|	НачисленнаяЗарплатаИВзносы.Подразделение,
	|	НачисленнаяЗарплатаИВзносы.ВидОперации,
	|	НачисленнаяЗарплатаИВзносы.СтатьяРасходов,
	|	НачисленнаяЗарплатаИВзносы.НаправлениеДеятельности,
	|	НачисленнаяЗарплатаИВзносы.АналитикаРасходов,
	|	НачисленнаяЗарплатаИВзносы.АналитикаАктивовПассивов,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОценочныеОбязательстваПостраховымВзносам),
	|	ЗНАЧЕНИЕ(Справочник.Резервы.РезервЕжегодныхОтпусков),
	|	НЕОПРЕДЕЛЕНО,
	|	НЕОПРЕДЕЛЕНО,
	|	НачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ,
	|	СУММА(НачисленнаяЗарплатаИВзносы.Сумма),
	|	НачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
	|	НачисленнаяЗарплатаИВзносы.СчетКт,
	|	НачисленнаяЗарплатаИВзносы.ТипНалога,
	|	НачисленнаяЗарплатаИВзносы.ВидПлатежаВГосБюджет,
	|	НачисленнаяЗарплатаИВзносы.СтатьяРасходов.ВариантРаспределенияРасходов
	|ИЗ
	|	ТаблицаДокумента КАК НачисленнаяЗарплатаИВзносы
	|
	|ГДЕ
	|	НачисленнаяЗарплатаИВзносы.ВидОперации В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы))
	|	И НачисленнаяЗарплатаИВзносы.ТипНалога <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленнаяЗарплатаИВзносы.Ссылка,
	|	НачисленнаяЗарплатаИВзносы.Подразделение,
	|	НачисленнаяЗарплатаИВзносы.ВидОперации,
	|	НачисленнаяЗарплатаИВзносы.СтатьяРасходов,
	|	НачисленнаяЗарплатаИВзносы.НаправлениеДеятельности,
	|	НачисленнаяЗарплатаИВзносы.АналитикаРасходов,
	|	НачисленнаяЗарплатаИВзносы.АналитикаАктивовПассивов,
	|	НачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ,
	|	НачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
	|	НачисленнаяЗарплатаИВзносы.СчетКт,
	|	НачисленнаяЗарплатаИВзносы.ТипНалога,
	|	НачисленнаяЗарплатаИВзносы.ВидПлатежаВГосБюджет,
	|	НачисленнаяЗарплатаИВзносы.СтатьяРасходов
	|
	|ИМЕЮЩИЕ
	|	СУММА(НачисленнаяЗарплатаИВзносы.Сумма) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	//***********************************************************
	// расходы по страхованию ФСС  (ФСЗН)
	//***********************************************************
	|ВЫБРАТЬ
	|	НачисленнаяЗарплатаИВзносы.Ссылка,
	|	МИНИМУМ(НачисленнаяЗарплатаИВзносы.НомерСтроки),
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка),
	|	НачисленнаяЗарплатаИВзносы.ВидОперации,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги),
	|	НЕОПРЕДЕЛЕНО,
	|	НЕОПРЕДЕЛЕНО,
	// 4D:ERP для Беларуси, АлексейЧ, 15.12.2017 17:08:02 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ФСЗН),
	// }
	// 4D
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ФСС),
	// 4D:ERP для Беларуси, АлексейЧ, 15.12.2017 17:08:02 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.Налог),
	// }
	// 4D
	|	НЕОПРЕДЕЛЕНО,
	|	НЕОПРЕДЕЛЕНО,
	|	НачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ,
	|	СУММА(НачисленнаяЗарплатаИВзносы.Сумма),
	|	НачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
	|	НачисленнаяЗарплатаИВзносы.СчетКт,
	|	НачисленнаяЗарплатаИВзносы.ТипНалога,
	|	НачисленнаяЗарплатаИВзносы.ВидПлатежаВГосБюджет,
	|	НЕОПРЕДЕЛЕНО
	|ИЗ
	|	ТаблицаДокумента КАК НачисленнаяЗарплатаИВзносы
	|
	|ГДЕ
	// 4D:ERP для Беларуси, АлексейЧ, 15.12.2017 17:08:02 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	НачисленнаяЗарплатаИВзносы.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.РасходыПоСтрахованиюФСЗН)
	// }
	// 4D
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленнаяЗарплатаИВзносы.Ссылка,
	|	НачисленнаяЗарплатаИВзносы.ВидОперации,
	|	НачисленнаяЗарплатаИВзносы.ВидНачисленияОплатыТрудаДляНУ,
	|	НачисленнаяЗарплатаИВзносы.ФизическоеЛицо,
	|	НачисленнаяЗарплатаИВзносы.СчетКт,
	|	НачисленнаяЗарплатаИВзносы.ТипНалога,
	|	НачисленнаяЗарплатаИВзносы.ВидПлатежаВГосБюджет
	|
	|ИМЕЮЩИЕ
	|	СУММА(НачисленнаяЗарплатаИВзносы.Сумма) <> 0
	|
	// 4D:ERP для Беларуси, Екатерина, 03.02.2016 16:40:18 
	// , №10801
	// {
	|";
	// }
	// 4D
	
	ТекстыЗапроса.Добавить(ТекстЗапросаВТНачисленнаяЗарплатаИВзносы, ИмяРегистра);
	
#КонецОбласти

	ТекстЗапроса =
		ТекстЗапросаВтТаблицаДанныхСпособовОтражения +
		";
		|////////////////////////////////////////////////////////////////////////////////
		|" +
		ТекстЗапросаВТТаблицаДокумента +
		";
		|////////////////////////////////////////////////////////////////////////////////
		|" +
		ТекстЗапросаТаблицаДокумента +
		";
		|////////////////////////////////////////////////////////////////////////////////
		|" +
		ТекстЗапросаВТНачисленнаяЗарплатаИВзносы +
		";
		|////////////////////////////////////////////////////////////////////////////////
		|";
		
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаВтВыработкаСотрудников(Запрос, ТекстыЗапроса)
	
	ИмяРегистра = "ВтТаблицаВыработкаСотрудников";
	
	УстановитьПараметрЗапросаТаблицаВыработкаСотрудников(Запрос);
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВыработкаСотрудников.Период,
	|	ВыработкаСотрудников.Организация,
	|	ВыработкаСотрудников.Подразделение,
	|	ВыработкаСотрудников.НаправлениеДеятельности,
	
	|	ВыработкаСотрудников.ПартияПроизводства,
	|	ВыработкаСотрудников.АналитикаУчетаПартийПроизводства,
	|	ВыработкаСотрудников.ЗаказНаПроизводство,
	|	ВыработкаСотрудников.КодСтрокиПродукция,
	|	ВыработкаСотрудников.ВидРабот,
	|	ВыработкаСотрудников.ГруппаПродукции,
	|	ВыработкаСотрудников.Этап,
	
	|	ВыработкаСотрудников.ТипНалога,
	|	ВыработкаСотрудников.ВидПлатежаВГосБюджет,
	|	ВыработкаСотрудников.ВидНачисленияОплатыТруда,
	|	ВыработкаСотрудников.ВидОперацииПоЗарплате,
	|	ВыработкаСотрудников.ВидФондаВзносов,
	
	|	ВыработкаСотрудников.СтатьяКалькуляции,
	|	ВыработкаСотрудников.СтатьяРасходов,
	|	ВыработкаСотрудников.АналитикаРасходов,
	|	ВыработкаСотрудников.АналитикаАктивовПассивов,
	|	ВыработкаСотрудников.СчетУчета,
	|	ВыработкаСотрудников.Субконто1,
	|	ВыработкаСотрудников.Субконто2,
	|	ВыработкаСотрудников.Субконто3,
	|	ВыработкаСотрудников.Сотрудник,
	
	|	ВыработкаСотрудников.Сумма,
	|	ВыработкаСотрудников.СуммаРегл
	
	|ПОМЕСТИТЬ ВтТаблицаВыработкаСотрудников
	|ИЗ
	|	&ТаблицаВыработкаСотрудников КАК ВыработкаСотрудников";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	
	Возврат ТекстЗапроса;
	
КонецФункции

Процедура УстановитьПараметрЗапросаТаблицаВыработкаСотрудников(Запрос)
	
	Если Запрос.Параметры.Свойство("ТаблицаВыработкаСотрудников") Тогда
		Возврат;
	КонецЕсли;
	
	ЗапросВыработка = Новый Запрос;
	ЗапросВыработка.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	ЗапросВыработка.Текст = 
		БазаРаспределенияТрудозатрат() +
		Справочники.СпособыОтраженияЗарплатыВБухУчете.ТекстЗапросаДанныхСпособов();
	
	ЗапросВыработка.УстановитьПараметр("Ссылка",                          Запрос.Параметры.Ссылка);
	ЗапросВыработка.УстановитьПараметр("Период",                          Запрос.Параметры.Период);
	ЗапросВыработка.УстановитьПараметр("Дата",                            Запрос.Параметры.Дата);
	ЗапросВыработка.УстановитьПараметр("Организация",                     Запрос.Параметры.Организация);
	ЗапросВыработка.УстановитьПараметр("ДетализацияПоФизлицам",           Запрос.Параметры.ДетализацияПоФизлицам);
	ЗапросВыработка.УстановитьПараметр("ДатаНачала",                      Запрос.Параметры.ДатаНачала);
	ЗапросВыработка.УстановитьПараметр("ДатаОкончания",                   Запрос.Параметры.ДатаОкончания);
	ЗапросВыработка.УстановитьПараметр("КоэффициентПересчетаВВалютуУпр",  Запрос.Параметры.КоэффициентПересчетаВВалютуУПР);
	ЗапросВыработка.УстановитьПараметр("Сводно",                          Запрос.Параметры.Сводно);
	ЗапросВыработка.УстановитьПараметр("ПроводкиПоРаботникам",            Запрос.Параметры.ПроводкиПоРаботникам);
	ЗапросВыработка.УстановитьПараметр("ВалютаРегл",                      Запрос.Параметры.ВалютаРегл);
	
	КоэффициентПересчетаВВалютуУПР = Запрос.Параметры.КоэффициентПересчетаВВалютуУПР;
	
	МассивРезультатов = ЗапросВыработка.ВыполнитьПакет();
	
	ТаблицаВыработкаСотрудников   = НоваяТаблицаВыработкаСотрудников();
	ВидыВзносов                   = ВидыСуммВзносов();
	БазаРаспределения             = МассивРезультатов[5].Выгрузить();
	СтрокиКРаспределению          = МассивРезультатов[6].Выгрузить();
	ПараметрыСпособовОтражения    = МассивРезультатов[7].Выбрать();
	
	БазаРаспределения.Индексы.Добавить("Сотрудник, Организация, Подразделение, ОблагаетсяЕНВД");
	
	СтруктураОтбора = Новый Структура("Сотрудник, Организация, Подразделение, ОблагаетсяЕНВД");
	
	Для Каждого Строка Из СтрокиКРаспределению Цикл
		
		ЗаполнитьЗначенияСвойств(СтруктураОтбора, Строка);
		
		СтрокиБазы = БазаРаспределения.НайтиСтроки(СтруктураОтбора);
		
		МассивКоэффициентов = Новый Массив;
		
		Для Каждого СтрокаБазы Из СтрокиБазы Цикл
			МассивКоэффициентов.Добавить(СтрокаБазы.Коэффициент);
		КонецЦикла;
		
		Для Каждого ВидВзноса Из ВидыВзносов Цикл
			
			Если Строка[ВидВзноса.Представление] = 0 Тогда
				Продолжить;
			КонецЕсли;
			
			МассивРаспределения = ОбщегоНазначения.РаспределитьСуммуПропорциональноКоэффициентам(Строка[ВидВзноса.Представление], МассивКоэффициентов);
			
			Для Индекс = 0 По СтрокиБазы.Количество()-1 Цикл
				
				СтрокаБазы = СтрокиБазы[Индекс];
				
				Параметры = ПараметрыРаспределенияСтроки(ВидВзноса, СтрокаБазы, ПараметрыСпособовОтражения);
				
				НоваяСтрока = ТаблицаВыработкаСотрудников.Добавить();
				
				ЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаБазы); // производственная аналитика
				ЗаполнитьЗначенияСвойств(НоваяСтрока, Параметры); // аналитика расходов в соответствии со способами отражения
				
				НоваяСтрока.ВидНачисленияОплатыТруда = Строка.ВидНачисленияОплатыТруда;
				НоваяСтрока.ВидОперацииПоЗарплате = Строка.ВидОперации;
				
				НоваяСтрока.Сумма = МассивРаспределения[Индекс]*КоэффициентПересчетаВВалютуУПР;
				НоваяСтрока.СуммаРегл = МассивРаспределения[Индекс];
				
			КонецЦикла;
			
		КонецЦикла;
		
	КонецЦикла;
	
	КолонкиГруппировок = "";
	КолонкиСуммирования = "Сумма, СуммаРегл";
	
	Для Каждого Колонка Из ТаблицаВыработкаСотрудников.Колонки Цикл
		Если СтрНайти(КолонкиСуммирования, Колонка.Имя) = 0 Тогда
			КолонкиГруппировок = КолонкиГруппировок + Колонка.Имя + ",";
		КонецЕсли;
	КонецЦикла;
	КолонкиГруппировок = Лев(КолонкиГруппировок, СтрДлина(КолонкиГруппировок) - 1);
	ТаблицаВыработкаСотрудников.Свернуть(КолонкиГруппировок, КолонкиСуммирования);
	Запрос.УстановитьПараметр("ТаблицаВыработкаСотрудников", ТаблицаВыработкаСотрудников);
	
КонецПроцедуры

#КонецОбласти

Функция ТекстЗапросаТаблицаТрудозатратыНезавершенногоПроизводства(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ТрудозатратыНезавершенногоПроизводства";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	УстановитьПараметрЗапросаТаблицаВыработкаСотрудников(Запрос);
	
	Если НЕ ПроведениеСерверУТ.ЕстьТаблицаЗапроса("ВтТаблицаВыработкаСотрудников", ТекстыЗапроса) Тогда
		ТекстЗапросаВтВыработкаСотрудников(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	&Период                                  КАК Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)   КАК ВидДвижения,
	|	&Организация                             КАК Организация,
	|	ВыработкаСотрудников.Подразделение       КАК Подразделение,
	|	ВыработкаСотрудников.ПартияПроизводства  КАК ПартияПроизводства,
	|	ВыработкаСотрудников.АналитикаУчетаПартийПроизводства  КАК АналитикаУчетаПартийПроизводства,
	|	ВыработкаСотрудников.ЗаказНаПроизводство КАК ЗаказНаПроизводство,
	|	ВыработкаСотрудников.КодСтрокиПродукция  КАК КодСтрокиПродукция,
	|	ВыработкаСотрудников.Этап                КАК Этап,
	|	ВыработкаСотрудников.СтатьяКалькуляции   КАК СтатьяКалькуляции,
	|	ВыработкаСотрудников.ВидРабот            КАК ВидРабот,
	|	ВыработкаСотрудников.ГруппаПродукции     КАК ГруппаПродукции,
	|	ВыработкаСотрудников.ВидФондаВзносов     КАК ВидФондаВзносов,
	|	СУММА(ВыработкаСотрудников.Сумма)        КАК Стоимость,
	|	СУММА(ВыработкаСотрудников.СуммаРегл)    КАК СтоимостьРегл
	|ИЗ
	|	ВтТаблицаВыработкаСотрудников КАК ВыработкаСотрудников
	|ГДЕ
	|	ВыработкаСотрудников.СтатьяРасходов = НЕОПРЕДЕЛЕНО
	|
	|СГРУППИРОВАТЬ ПО
	|	ВыработкаСотрудников.Подразделение,
	|	ВыработкаСотрудников.ПартияПроизводства,
	|	ВыработкаСотрудников.АналитикаУчетаПартийПроизводства,
	|	ВыработкаСотрудников.ЗаказНаПроизводство,
	|	ВыработкаСотрудников.КодСтрокиПродукция,
	|	ВыработкаСотрудников.Этап,
	|	ВыработкаСотрудников.СтатьяКалькуляции,
	|	ВыработкаСотрудников.ВидРабот,
	|	ВыработкаСотрудников.ГруппаПродукции,
	|	ВыработкаСотрудников.ВидФондаВзносов";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаОтражениеЗарплатыВФинансовомУчете(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ОтражениеЗарплатыВФинансовомУчете";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	УстановитьПараметрЗапросаТаблицаВыработкаСотрудников(Запрос);
	
	Если НЕ ПроведениеСерверУТ.ЕстьТаблицаЗапроса("ВтТаблицаВыработкаСотрудников", ТекстыЗапроса) Тогда
		ТекстЗапросаВтВыработкаСотрудников(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	&Период КАК Период,
	|	&Организация КАК Организация,
	|	ВыработкаСотрудников.Подразделение КАК Подразделение,
	|	ВыработкаСотрудников.НаправлениеДеятельности,
	|	ВыработкаСотрудников.ВидНачисленияОплатыТруда,
	|	ВыработкаСотрудников.ВидОперацииПоЗарплате,
	|	ВыработкаСотрудников.СтатьяРасходов,
	|	ВыработкаСотрудников.АналитикаРасходов,
	|	ВыработкаСотрудников.ВидРабот,
	|	ВЫБОР
	|		КОГДА НЕ &Сводно
	|				И &ПроводкиПоРаботникам
	|			ТОГДА ВыработкаСотрудников.Сотрудник
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ КАК ФизическоеЛицо,
	|	ВыработкаСотрудников.ГруппаПродукции,
	|	ВыработкаСотрудников.ТипНалога,
	|	ВыработкаСотрудников.ВидПлатежаВГосБюджет,
	|	ВыработкаСотрудников.АналитикаАктивовПассивов,
	|	ВыработкаСотрудников.СчетУчета,
	|	ВыработкаСотрудников.Субконто1,
	|	ВыработкаСотрудников.Субконто2,
	|	ВыработкаСотрудников.Субконто3,
	|	СУММА(ВыработкаСотрудников.СуммаРегл) КАК СуммаРегл
	|ИЗ
	|	ВтТаблицаВыработкаСотрудников КАК ВыработкаСотрудников
	|
	|СГРУППИРОВАТЬ ПО
	|	ВыработкаСотрудников.Подразделение,
	|	ВыработкаСотрудников.НаправлениеДеятельности,
	|	ВыработкаСотрудников.ВидНачисленияОплатыТруда,
	|	ВыработкаСотрудников.ВидОперацииПоЗарплате,
	|	ВыработкаСотрудников.СтатьяРасходов,
	|	ВыработкаСотрудников.АналитикаРасходов,
	|	ВыработкаСотрудников.ВидРабот,
	|	ВЫБОР
	|		КОГДА НЕ &Сводно
	|				И &ПроводкиПоРаботникам
	|			ТОГДА ВыработкаСотрудников.Сотрудник
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ,
	|	ВыработкаСотрудников.ГруппаПродукции,
	|	ВыработкаСотрудников.ТипНалога,
	|	ВыработкаСотрудников.ВидПлатежаВГосБюджет,
	|	ВыработкаСотрудников.АналитикаАктивовПассивов,
	|	ВыработкаСотрудников.СчетУчета,
	|	ВыработкаСотрудников.Субконто1,
	|	ВыработкаСотрудников.Субконто2,
	|	ВыработкаСотрудников.Субконто3";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаПрочиеРасходы(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ПрочиеРасходы";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	УстановитьПараметрЗапросаТаблицаВыработкаСотрудников(Запрос);
	
	Если НЕ ПроведениеСерверУТ.ЕстьТаблицаЗапроса("ВтТаблицаВыработкаСотрудников", ТекстыЗапроса) Тогда
		ТекстЗапросаВтВыработкаСотрудников(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	Если НЕ ПроведениеСерверУТ.ЕстьТаблицаЗапроса("ВтНачисленнаяЗарплатаИВзносы", ТекстыЗапроса) Тогда
		ТекстЗапросаВтНачисленнаяЗарплатаИВзносы(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Период КАК Период,
	|	&Организация КАК Организация,
	|	ВТРасходыПоСтатьям.Подразделение КАК Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов КАК СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов КАК АналитикаРасходов,
	
	|	СУММА(ВЫРАЗИТЬ(ВТРасходыПоСтатьям.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма,
	
	|	СУММА(ВЫБОР КОГДА ВТРасходыПоСтатьям.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПроизводственныеЗатраты) ТОГДА
	|		ВЫРАЗИТЬ(ВТРасходыПоСтатьям.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2)) 
	|	ИНАЧЕ
	|		0
	|	КОНЕЦ) КАК СуммаБезНДС,
	
	|	СУММА(ВЫБОР КОГДА ВТРасходыПоСтатьям.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы) ТОГДА
	|		0
	|	ИНАЧЕ
	|		ВТРасходыПоСтатьям.Сумма
	|	КОНЕЦ) КАК СуммаРегл,
	
	|	0 КАК ВременнаяРазница,
	
	|	СУММА(ВЫБОР КОГДА ВТРасходыПоСтатьям.ВариантРаспределенияРасходов =  ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы) ТОГДА
	|		0
	|	КОГДА Не ВТРасходыПоСтатьям.СтатьяРасходов.ПринятиеКналоговомуУчету ТОГДА
	|		ВТРасходыПоСтатьям.Сумма
	|	ИНАЧЕ
	|		0
	|	КОНЕЦ) КАК ПостояннаяРазница

	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК ВТРасходыПоСтатьям
	|ГДЕ
	|	ВТРасходыПоСтатьям.ВариантРаспределенияРасходов <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|	И ВТРасходыПоСтатьям.ВидОперации НЕ В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы))
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 15:22:40 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Отчисления в пенсионный фонд не расчитываются, как затраты предприятия  
	// {
	|	И ВТРасходыПоСтатьям.ТипНалога <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПенсионныйФонд)
	// }
	// 4D
	|	И ВТРасходыПоСтатьям.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТРасходыПоСтатьям.Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// выработка по прочим работам
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Период КАК Период,
	|	&Организация КАК Организация,
	|	ВыработкаСотрудников.Подразделение КАК Подразделение,
	|	ВыработкаСотрудников.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВыработкаСотрудников.СтатьяРасходов КАК СтатьяРасходов,
	|	ВыработкаСотрудников.АналитикаРасходов КАК АналитикаРасходов,
	
	|	СУММА(ВыработкаСотрудников.Сумма) КАК Сумма,
	
	|	СУММА(ВЫБОР КОГДА ВыработкаСотрудников.СтатьяРасходов.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПроизводственныеЗатраты) ТОГДА
	|		ВыработкаСотрудников.Сумма 
	|	ИНАЧЕ
	|		0
	|	КОНЕЦ) КАК СуммаБезНДС,
	
	|	СУММА(ВЫБОР КОГДА ВыработкаСотрудников.СтатьяРасходов.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы) ТОГДА
	|		0
	|	ИНАЧЕ
	|		ВыработкаСотрудников.СуммаРегл
	|	КОНЕЦ) КАК СуммаРегл,
	
	|	0 КАК ВременнаяРазница,
	
	|	СУММА(ВЫБОР КОГДА ВыработкаСотрудников.СтатьяРасходов.ВариантРаспределенияРасходов =  ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы) ТОГДА
	|		0
	|	КОГДА Не ВыработкаСотрудников.СтатьяРасходов.ПринятиеКналоговомуУчету ТОГДА
	|		ВыработкаСотрудников.СуммаРегл
	|	ИНАЧЕ
	|		0
	|	КОНЕЦ) КАК ПостояннаяРазница

	|ИЗ
	|	ВтТаблицаВыработкаСотрудников КАК ВыработкаСотрудников
	|ГДЕ
	|	ВыработкаСотрудников.СтатьяРасходов.ВариантРаспределенияРасходов <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|	И ВыработкаСотрудников.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|	И ВыработкаСотрудников.СтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 15:22:40 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	И ВыработкаСотрудников.ТипНалога <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПенсионныйФонд)
	// }
	// 4D
	|
	|СГРУППИРОВАТЬ ПО
	|	ВыработкаСотрудников.Подразделение,
	|	ВыработкаСотрудников.НаправлениеДеятельности,
	|	ВыработкаСотрудников.СтатьяРасходов,
	|	ВыработкаСотрудников.АналитикаРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// ЕжегодныйОтпускОценочныеОбязательства
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Период КАК Период,
	|	&Организация КАК Организация,
	|	ВТРасходыПоСтатьям.Подразделение КАК Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов КАК СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов КАК АналитикаРасходов,
	
	|	0 КАК Сумма,
	|	0 КАК СуммаБезНДС,
	|	0 КАК СуммаРегл,
	
	|	- СУММА(ВТРасходыПоСтатьям.Сумма) КАК ВременнаяРазница,
	
	|	0 КАК ПостояннаяРазница

	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК ВТРасходыПоСтатьям
	|ГДЕ
	|	ВТРасходыПоСтатьям.ВариантРаспределенияРасходов <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|	И ВТРасходыПоСтатьям.ВидОперации В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|										ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства))
	|	И ВТРасходыПоСтатьям.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 15:22:40 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	И ВТРасходыПоСтатьям.ТипНалога <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПенсионныйФонд)
	// }
	// 4D
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТРасходыПоСтатьям.Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// ЕжегодныйОтпускРезервы
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Период КАК Период,
	|	&Организация КАК Организация,
	|	ВТРасходыПоСтатьям.Подразделение КАК Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов КАК СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов КАК АналитикаРасходов,
	
	|	СУММА(ВЫРАЗИТЬ(ВТРасходыПоСтатьям.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма,
	|	0 КАК СуммаБезНДС,
	|	СУММА(ВТРасходыПоСтатьям.Сумма) КАК СуммаРегл,
	
	|	СУММА(ВТРасходыПоСтатьям.Сумма) КАК ВременнаяРазница,
	
	|	0 КАК ПостояннаяРазница

	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК ВТРасходыПоСтатьям
	|ГДЕ
	|	ВТРасходыПоСтатьям.ВариантРаспределенияРасходов <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|	И ВТРасходыПоСтатьям.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы)
	|	И ВТРасходыПоСтатьям.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	// 4D:ERP для Беларуси, АлексейЧ, 23.11.2017 15:22:40 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	И ВТРасходыПоСтатьям.ТипНалога <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПенсионныйФонд)
	// }
	// 4D
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТРасходыПоСтатьям.Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаПартииПрочихРасходов(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ПартииПрочихРасходов";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	УстановитьПараметрЗапросаТаблицаВыработкаСотрудников(Запрос);
	
	Если НЕ ПроведениеСерверУТ.ЕстьТаблицаЗапроса("ВтТаблицаВыработкаСотрудников", ТекстыЗапроса) Тогда
		ТекстЗапросаВтВыработкаСотрудников(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	Если НЕ ПроведениеСерверУТ.ЕстьТаблицаЗапроса("ВтНачисленнаяЗарплатаИВзносы", ТекстыЗапроса) Тогда
		ТекстЗапросаВтНачисленнаяЗарплатаИВзносы(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Период КАК Период,
	|	&Организация КАК Организация,
	|	ВТРасходыПоСтатьям.Подразделение КАК Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов КАК СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов КАК АналитикаРасходов,
	|	&Ссылка КАК ДокументПоступленияРасходов,
	|	ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПартий.ПустаяСсылка)	КАК АналитикаУчетаПартий,
	|	СУММА(ВЫРАЗИТЬ(ВТРасходыПоСтатьям.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Стоимость,
	|	СУММА(ВЫРАЗИТЬ(ВТРасходыПоСтатьям.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК СтоимостьБезНДС,
	|	СУММА(ВТРасходыПоСтатьям.Сумма) КАК СтоимостьРегл,
	|	0 КАК ВременнаяРазница,
	|	СУММА(ВЫБОР
	|		КОГДА ВТРасходыПоСтатьям.СтатьяРасходов.ПринятиеКналоговомуУчету = ЛОЖЬ
	|			ТОГДА ВТРасходыПоСтатьям.Сумма
	|		ИНАЧЕ 0
	|	КОНЕЦ) КАК ПостояннаяРазница,
	|	0 КАК НДСРегл
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК ВТРасходыПоСтатьям
	|ГДЕ
	|	ВТРасходыПоСтатьям.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|	И ВТРасходыПоСтатьям.ВидОперации НЕ В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы))
	|	И ВТРасходыПоСтатьям.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТРасходыПоСтатьям.Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// выработка по прочим работам
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Период КАК Период,
	|	&Организация КАК Организация,
	|	ВыработкаСотрудников.Подразделение КАК Подразделение,
	|	ВыработкаСотрудников.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВыработкаСотрудников.СтатьяРасходов КАК СтатьяРасходов,
	|	ВыработкаСотрудников.АналитикаРасходов КАК АналитикаРасходов,
	|	&Ссылка КАК ДокументПоступленияРасходов,
	|	ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПартий.ПустаяСсылка)	КАК АналитикаУчетаПартий,
	|	СУММА(ВыработкаСотрудников.Сумма) КАК Стоимость,
	|	СУММА(ВыработкаСотрудников.Сумма) КАК СтоимостьБезНДС,
	|	СУММА(ВыработкаСотрудников.СуммаРегл) КАК СтоимостьРегл,
	|	0 КАК ВременнаяРазница,
	|	СУММА(ВЫБОР
	|		КОГДА ВыработкаСотрудников.СтатьяРасходов.ПринятиеКналоговомуУчету = ЛОЖЬ
	|			ТОГДА ВыработкаСотрудников.СуммаРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ) КАК ПостояннаяРазница,
	|	0 КАК НДСРегл
	|ИЗ
	|	ВтТаблицаВыработкаСотрудников КАК ВыработкаСотрудников
	|ГДЕ
	|	ВыработкаСотрудников.СтатьяРасходов.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|	И ВыработкаСотрудников.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|	И ВыработкаСотрудников.СтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВыработкаСотрудников.Подразделение,
	|	ВыработкаСотрудников.НаправлениеДеятельности,
	|	ВыработкаСотрудников.СтатьяРасходов,
	|	ВыработкаСотрудников.АналитикаРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// ЕжегодныйОтпускОценочныеОбязательства
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Период КАК Период,
	|	&Организация КАК Организация,
	|	ВТРасходыПоСтатьям.Подразделение КАК Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов КАК СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов КАК АналитикаРасходов,
	|	&Ссылка КАК ДокументПоступленияРасходов,
	|	ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПартий.ПустаяСсылка)	КАК АналитикаУчетаПартий,
	|	0 КАК Стоимость,
	|	0 КАК СтоимостьБезНДС,
	|	0 КАК СтоимостьРегл,
	|	- СУММА(ВТРасходыПоСтатьям.Сумма) КАК ВременнаяРазница,
	|	0 КАК ПостояннаяРазница,
	|	0 КАК НДСРегл
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК ВТРасходыПоСтатьям
	|ГДЕ
	|	ВТРасходыПоСтатьям.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|	И ВТРасходыПоСтатьям.ВидОперации В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства),
	|										ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства))
	|	И ВТРасходыПоСтатьям.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТРасходыПоСтатьям.Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// ЕжегодныйОтпускРезервы
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Период КАК Период,
	|	&Организация КАК Организация,
	|	ВТРасходыПоСтатьям.Подразделение КАК Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов КАК СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов КАК АналитикаРасходов,
	|	&Ссылка КАК ДокументПоступленияРасходов,
	|	ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПартий.ПустаяСсылка)	КАК АналитикаУчетаПартий,
	|	СУММА(ВЫРАЗИТЬ(ВТРасходыПоСтатьям.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Стоимость,
	|	СУММА(ВЫРАЗИТЬ(ВТРасходыПоСтатьям.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК СтоимостьБезНДС,
	|	СУММА(ВТРасходыПоСтатьям.Сумма) КАК СтоимостьРегл,
	|	СУММА(ВТРасходыПоСтатьям.Сумма) КАК ВременнаяРазница,
	|	0 КАК ПостояннаяРазница,
	|	0 КАК НДСРегл
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК ВТРасходыПоСтатьям
	|ГДЕ
	|	ВТРасходыПоСтатьям.ВариантРаспределенияРасходов = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|	И ВТРасходыПоСтатьям.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы)
	|	И ВТРасходыПоСтатьям.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТРасходыПоСтатьям.Подразделение,
	|	ВТРасходыПоСтатьям.НаправлениеДеятельности,
	|	ВТРасходыПоСтатьям.СтатьяРасходов,
	|	ВТРасходыПоСтатьям.АналитикаРасходов";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаДвиженияДоходыРасходыПрочиеАктивыПассивы(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ДвиженияДоходыРасходыПрочиеАктивыПассивы";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	УстановитьПараметрЗапросаТаблицаВыработкаСотрудников(Запрос);
	
	Если НЕ ПроведениеСерверУТ.ЕстьТаблицаЗапроса("ВтТаблицаВыработкаСотрудников", ТекстыЗапроса) Тогда
		ТекстЗапросаВтВыработкаСотрудников(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	Если НЕ ПроведениеСерверУТ.ЕстьТаблицаЗапроса("ВтНачисленнаяЗарплатаИВзносы", ТекстыЗапроса) Тогда
		ТекстЗапросаВтНачисленнаяЗарплатаИВзносы(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	ТекстЗапроса =
	// начисленная зарплата на расходы
	"ВЫБРАТЬ
	|	&Период КАК Период,
	|	
	|	ВЫБОР КОГДА НачисленнаяЗарплата.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеЗаработнойПлаты)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеНалоговВзносовСЗаработнойПлаты)
	|	КОНЕЦ КАК ХозяйственнаяОперация,
	|	
	|	&Организация КАК Организация,

	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ВЫБОР КОГДА НачисленнаяЗарплата.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги)
	|	КОНЕЦ                                             КАК Статья,
	|	НЕОПРЕДЕЛЕНО                                      КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                      КАК АналитикаРасходов,
	|	ВЫБОР КОГДА НачисленнаяЗарплата.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		НЕОПРЕДЕЛЕНО
	|	ИНАЧЕ
	|		НачисленнаяЗарплата.ТипНалога
	|	КОНЕЦ                                             КАК АналитикаАктивовПассивов,
	|	НачисленнаяЗарплата.Подразделение                 КАК КорПодразделение,
	|	НачисленнаяЗарплата.НаправлениеДеятельности       КАК КорНаправлениеДеятельности,
	|	НачисленнаяЗарплата.СтатьяРасходов                КАК КорСтатья,
	|	НЕОПРЕДЕЛЕНО                                      КАК КорАналитикаДоходов,
	|	НачисленнаяЗарплата.АналитикаРасходов             КАК КорАналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО                                      КАК КорАналитикаАктивовПассивов,

	|	СУММА(ВЫРАЗИТЬ(НачисленнаяЗарплата.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма,
	|	СУММА(НачисленнаяЗарплата.Сумма) КАК СуммаРегл,
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	НЕОПРЕДЕЛЕНО КАК СуммаВВалюте,
	|	
	|	НачисленнаяЗарплата.ВидОперации КАК ВидОперацииПоЗарплате
	|	
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК НачисленнаяЗарплата
	|ГДЕ
	|	НачисленнаяЗарплата.ВидОперации НЕ В (  ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства))
	|	И НачисленнаяЗарплата.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленнаяЗарплата.Подразделение,
	|	НачисленнаяЗарплата.ТипНалога,
	|	НачисленнаяЗарплата.СтатьяРасходов,
	|	НачисленнаяЗарплата.АналитикаРасходов,
	|	НачисленнаяЗарплата.НаправлениеДеятельности,
	|	НачисленнаяЗарплата.ВидОперации
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// выработка на расходы
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|	
	|	ВЫБОР КОГДА ВыработкаСотрудников.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеЗаработнойПлаты)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеНалоговВзносовСЗаработнойПлаты)
	|	КОНЕЦ КАК ХозяйственнаяОперация,
	|	
	|	&Организация КАК Организация,

	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)    КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ВЫБОР КОГДА ВыработкаСотрудников.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги)
	|	КОНЕЦ                                               КАК Статья,
	|	НЕОПРЕДЕЛЕНО                                        КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                        КАК АналитикаРасходов,
	|	ВЫБОР КОГДА ВыработкаСотрудников.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		НЕОПРЕДЕЛЕНО
	|	ИНАЧЕ
	|		ВыработкаСотрудников.ТипНалога
	|	КОНЕЦ                                               КАК АналитикаАктивовПассивов,

	|	ВыработкаСотрудников.Подразделение                  КАК КорПодразделение,
	|	ВыработкаСотрудников.НаправлениеДеятельности        КАК КорНаправлениеДеятельности,
	|	ВыработкаСотрудников.СтатьяРасходов                 КАК КорСтатья,
	|	НЕОПРЕДЕЛЕНО                                        КАК КорАналитикаДоходов,
	|	ВыработкаСотрудников.АналитикаРасходов              КАК КорАналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО                                        КАК КорАналитикаАктивовПассивов,

	|	СУММА(ВыработкаСотрудников.Сумма) КАК Сумма,
	|	СУММА(ВыработкаСотрудников.СуммаРегл) КАК СуммаРегл,
	|	
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	НЕОПРЕДЕЛЕНО КАК СуммаВВалюте,
	|	
	|	ВыработкаСотрудников.ВидОперацииПоЗарплате КАК ВидОперацииПоЗарплате
	|	
	|ИЗ
	|	ВтТаблицаВыработкаСотрудников КАК ВыработкаСотрудников
	|ГДЕ
	|	ВыработкаСотрудников.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|	И ВыработкаСотрудников.СтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВыработкаСотрудников.Подразделение,
	|	ВыработкаСотрудников.ТипНалога,
	|	ВыработкаСотрудников.СтатьяРасходов,
	|	ВыработкаСотрудников.АналитикаРасходов,
	|	ВыработкаСотрудников.НаправлениеДеятельности,
	|	ВыработкаСотрудников.ВидОперацииПоЗарплате
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// начисленная зарплата на прочие активы и пассивы
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|	
	|	ВЫБОР КОГДА НачисленнаяЗарплата.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеЗаработнойПлаты)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеНалоговВзносовСЗаработнойПлаты)
	|	КОНЕЦ КАК ХозяйственнаяОперация,
	|	
	|	&Организация КАК Организация,

	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ВЫБОР КОГДА НачисленнаяЗарплата.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги)
	|	КОНЕЦ                                                  КАК Статья,
	|	НЕОПРЕДЕЛЕНО                                           КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                           КАК АналитикаРасходов,
	|	ВЫБОР КОГДА НачисленнаяЗарплата.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		НЕОПРЕДЕЛЕНО
	|	ИНАЧЕ
	|		НачисленнаяЗарплата.ТипНалога
	|	КОНЕЦ                                                  КАК АналитикаАктивовПассивов,

	|	НачисленнаяЗарплата.Подразделение                      КАК КорПодразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК КорНаправлениеДеятельности,
	|	НачисленнаяЗарплата.СтатьяРасходов                     КАК КорСтатья,
	|	НЕОПРЕДЕЛЕНО                                           КАК КорАналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                           КАК КорАналитикаРасходов,
	|	НачисленнаяЗарплата.АналитикаАктивовПассивов           КАК КорАналитикаАктивовПассивов,

	|	СУММА(ВЫРАЗИТЬ(НачисленнаяЗарплата.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма,
	|	СУММА(НачисленнаяЗарплата.Сумма) КАК СуммаРегл,
	|	
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	НЕОПРЕДЕЛЕНО КАК СуммаВВалюте,
	|
	|	НачисленнаяЗарплата.ВидОперации КАК ВидОперацииПоЗарплате
	|
	|	
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК НачисленнаяЗарплата
	|ГДЕ
	|	НачисленнаяЗарплата.ВидОперации НЕ В (  ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства))
	|	И НачисленнаяЗарплата.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиАктивовПассивов
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленнаяЗарплата.ТипНалога,
	|	НачисленнаяЗарплата.Подразделение,
	|	НачисленнаяЗарплата.СтатьяРасходов,
	|	НачисленнаяЗарплата.АналитикаАктивовПассивов,
	|	НачисленнаяЗарплата.ВидОперации
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// выработка на прочие активы и пассивы
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|	
	|	ВЫБОР КОГДА ВыработкаСотрудников.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеЗаработнойПлаты)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеНалоговВзносовСЗаработнойПлаты)
	|	КОНЕЦ КАК ХозяйственнаяОперация,
	|	
	|	&Организация КАК Организация,
	|
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ВЫБОР КОГДА ВыработкаСотрудников.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги)
	|	КОНЕЦ                                                       КАК Статья,
	|	НЕОПРЕДЕЛЕНО                                                КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                                КАК АналитикаРасходов,
	|	ВЫБОР КОГДА ВыработкаСотрудников.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка) ТОГДА
	|		НЕОПРЕДЕЛЕНО
	|	ИНАЧЕ
	|		ВыработкаСотрудников.ТипНалога
	|	КОНЕЦ                                                       КАК АналитикаАктивовПассивов,

	|	ВыработкаСотрудников.Подразделение                          КАК КорПодразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)   КАК КорНаправлениеДеятельности,
	|	ВыработкаСотрудников.СтатьяРасходов                         КАК КорСтатья,
	|	НЕОПРЕДЕЛЕНО                                                КАК КорАналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                                КАК КорАналитикаРасходов,
	|	ВыработкаСотрудников.АналитикаАктивовПассивов               КАК КорАналитикаАктивовПассивов,

	|	СУММА(ВыработкаСотрудников.Сумма) КАК Сумма,
	|	СУММА(ВыработкаСотрудников.СуммаРегл) КАК СуммаРегл,
	|	
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	НЕОПРЕДЕЛЕНО КАК СуммаВВалюте,
	|
	|	ВыработкаСотрудников.ВидОперацииПоЗарплате КАК ВидОперацииПоЗарплате
	|
	|	
	|ИЗ
	|	ВтТаблицаВыработкаСотрудников КАК ВыработкаСотрудников
	|ГДЕ
	|	ВыработкаСотрудников.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиАктивовПассивов
	|	И ВыработкаСотрудников.СтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВыработкаСотрудников.ТипНалога,
	|	ВыработкаСотрудников.Подразделение,
	|	ВыработкаСотрудников.СтатьяРасходов,
	|	ВыработкаСотрудников.АналитикаАктивовПассивов,
	|	ВыработкаСотрудников.ВидОперацииПоЗарплате
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// взносы, выплачиваемые за счет резервов, двигаются с пустой аналитики на заполненную
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеНалоговВзносовСЗаработнойПлаты) КАК ХозяйственнаяОперация,
	|	
	|	&Организация КАК Организация,
	
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)        КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)     КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги) КАК Статья,
	|	НЕОПРЕДЕЛЕНО                                                  КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                                  КАК АналитикаРасходов,
	|	НачисленнаяЗарплата.ТипНалога                                 КАК АналитикаАктивовПассивов,
	
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)        КАК КорПодразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)     КАК КорНаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги) КАК КорСтатья,
	|	НЕОПРЕДЕЛЕНО                                                  КАК КорАналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                                  КАК КорАналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО                                                  КАК КорАналитикаАктивовПассивов,

	|	СУММА(ВЫРАЗИТЬ(НачисленнаяЗарплата.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма,
	|	СУММА(НачисленнаяЗарплата.Сумма) КАК СуммаРегл,
	|	
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	НЕОПРЕДЕЛЕНО КАК СуммаВВалюте,
	|
	|	НачисленнаяЗарплата.ВидОперации КАК ВидОперацииПоЗарплате
	|
	|	
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК НачисленнаяЗарплата
	|ГДЕ
	|	НачисленнаяЗарплата.ВидОперации В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|											ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства))
	|	И НачисленнаяЗарплата.ТипНалога <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленнаяЗарплата.ТипНалога,
	|	НачисленнаяЗарплата.ВидОперации
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// удержанная зарплата на прочие активы и пассивы
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.УдержаниеИзЗарплатыСотрудника) КАК ХозяйственнаяОперация,
	|	
	|	&Организация КАК Организация,
	
	|	УдержаннаяЗарплата.ПодразделениеПредприятия    КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	УдержаннаяЗарплата.СтатьяАктивовПассивов       КАК Статья,
	|	НЕОПРЕДЕЛЕНО                                   КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                   КАК АналитикаРасходов,
	|	УдержаннаяЗарплата.АналитикаАктивовПассивов    КАК АналитикаАктивовПассивов,

	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)    КАК КорПодразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК КорНаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда) КАК КорСтатья,
	|	НЕОПРЕДЕЛЕНО                                   КАК КорАналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                   КАК КорАналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО                                   КАК КорАналитикаАктивовПассивов,
	
	|	СУММА(ВЫРАЗИТЬ(УдержаннаяЗарплата.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма,
	|	СУММА(УдержаннаяЗарплата.Сумма) КАК СуммаРегл,
	|	
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	НЕОПРЕДЕЛЕНО КАК СуммаВВалюте,
	|
	|	УдержаннаяЗарплата.ВидОперации КАК ВидОперацииПоЗарплате
	|	
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.УдержаннаяЗарплата КАК УдержаннаяЗарплата
	|ГДЕ
	|	УдержаннаяЗарплата.Ссылка = &Ссылка
	|	И УдержаннаяЗарплата.ВидОперации Не В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.УдержаниеНеизрасходованныхПодотчетныхСумм),
	|										   ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ВозвратИзлишнеВыплаченныхСуммВследствиеСчетныхОшибок))
	|	И &ИспользоватьУчетПрочихАктивовПассивов
	|
	|СГРУППИРОВАТЬ ПО
	|	УдержаннаяЗарплата.ПодразделениеПредприятия,
	|	УдержаннаяЗарплата.СтатьяАктивовПассивов,
	|	УдержаннаяЗарплата.АналитикаАктивовПассивов,
	|	УдержаннаяЗарплата.ВидОперации
	|
	// проценты по займам сотрудникам.
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачисленияПоЗаймамВыданным) КАК ХозяйственнаяОперация,
	|
	|	&Организация КАК Организация,
	
	|	ПроцентыПоЗаймам.ПодразделениеПредприятия           КАК Подразделение,
	|	НЕОПРЕДЕЛЕНО                                        КАК НаправлениеДеятельности,
	|	ПроцентыПоЗаймам.СтатьяДоходов                      КАК Статья,
	|	ПроцентыПоЗаймам.АналитикаДоходов                   КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                        КАК АналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО                                        КАК АналитикаАктивовПассивов,
	
	|	ПроцентыПоЗаймам.ПодразделениеПредприятия           КАК КорПодразделение,
	|	НЕОПРЕДЕЛЕНО                                        КАК КорНаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ЗаймыВыданные) КАК КорСтатья,
	|	НЕОПРЕДЕЛЕНО                                        КАК КорАналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                        КАК КорАналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО                                        КАК КорАналитикаАктивовПассивов,
	
	|	СУММА(ВЫРАЗИТЬ(ПроцентыПоЗаймам.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма,
	|	СУММА(ПроцентыПоЗаймам.Сумма) КАК СуммаРегл,
	|	
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	НЕОПРЕДЕЛЕНО КАК СуммаВВалюте,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоПроцентовПоЗайму) КАК ВидОперацииПоЗарплате
	|
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныеПроцентыПоЗаймам КАК ПроцентыПоЗаймам
	|ГДЕ
	|	ПроцентыПоЗаймам.Ссылка = &Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	ПроцентыПоЗаймам.ПодразделениеПредприятия,
	|	ПроцентыПоЗаймам.СтатьяДоходов,
	|	ПроцентыПоЗаймам.АналитикаДоходов
	|
	// возврат излишне выплаченных суммы вследствие счетных ошибок на доходы
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.УдержаниеИзЗарплатыСотрудника) КАК ХозяйственнаяОперация,
	|
	|	&Организация КАК Организация,
	
	|	УдержаннаяЗарплата.ПодразделениеПредприятия   КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	УдержаннаяЗарплата.СтатьяДоходов              КАК Статья,
	|	УдержаннаяЗарплата.АналитикаДоходов           КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                  КАК АналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО                                  КАК АналитикаАктивовПассивов,

	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)    КАК КорПодразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК КорНаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда) КАК КорСтатья,
	|	НЕОПРЕДЕЛЕНО                                  КАК КорАналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                  КАК КорАналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО                                  КАК КорАналитикаАктивовПассивов,
	
	|	СУММА(ВЫРАЗИТЬ(УдержаннаяЗарплата.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма,
	|	СУММА(УдержаннаяЗарплата.Сумма) КАК СуммаРегл,
	|	
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	НЕОПРЕДЕЛЕНО КАК СуммаВВалюте,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ВозвратИзлишнеВыплаченныхСуммВследствиеСчетныхОшибок) КАК ВидОперацииПоЗарплате
	|
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.УдержаннаяЗарплата КАК УдержаннаяЗарплата
	|ГДЕ
	|	УдержаннаяЗарплата.Ссылка = &Ссылка
	|	И УдержаннаяЗарплата.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ВозвратИзлишнеВыплаченныхСуммВследствиеСчетныхОшибок)
	|
	|СГРУППИРОВАТЬ ПО
	|	УдержаннаяЗарплата.ПодразделениеПредприятия,
	|	УдержаннаяЗарплата.СтатьяДоходов,
	|	УдержаннаяЗарплата.АналитикаДоходов
	|
	// НДФЛ корреспондирует со статьей активов\пассивов оплата труда
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеНалоговВзносовСЗаработнойПлаты) КАК ХозяйственнаяОперация,
	|	&Организация КАК Организация,

	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)    КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги) КАК Статья,
	|	НЕОПРЕДЕЛЕНО                                      КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                      КАК АналитикаРасходов,
	|	НачисленныйНДФЛ.ТипНалога                         КАК АналитикаАктивовПассивов,

	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)    КАК КорПодразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК КорНаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда) КАК КорСтатья,
	|	НЕОПРЕДЕЛЕНО                                      КАК КорАналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                      КАК КорАналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО                                      КАК КорАналитикаАктивовПассивов,

	|	СУММА(ВЫРАЗИТЬ(НачисленныйНДФЛ.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма,
	|	СУММА(НачисленныйНДФЛ.Сумма) КАК СуммаРегл,
	|	
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	НЕОПРЕДЕЛЕНО КАК СуммаВВалюте,
	|
	|	НачисленныйНДФЛ.ВидОперации КАК ВидОперацииПоЗарплате
	|
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК НачисленныйНДФЛ
	|ГДЕ
	|	НачисленныйНДФЛ.Ссылка = &Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленныйНДФЛ.ВидОперации,
	|	НачисленныйНДФЛ.ТипНалога
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	// взносы с работников в пенсионный на отражение с зарплаты	
	|ОБЪЕДИНИТЬ ВСЕ
    |
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтражениеНалоговВзносовСЗаработнойПлаты) КАК ХозяйственнаяОперация,
	|	&Организация КАК Организация,

	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)    			КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) 			КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги) 		КАК Статья,
	|	НЕОПРЕДЕЛЕНО                                      					КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                      					КАК АналитикаРасходов,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПенсионныйФонд)					КАК АналитикаАктивовПассивов,

	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)    			КАК КорПодразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) 			КАК КорНаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда) 	КАК КорСтатья,
	|	НЕОПРЕДЕЛЕНО                                      					КАК КорАналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО                                      					КАК КорАналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО                                      					КАК КорАналитикаАктивовПассивов,

	|	СУММА(ВЫРАЗИТЬ(НачисленныйНДФЛ.СуммаПенсионныйФонд * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма,
	|	СУММА(НачисленныйНДФЛ.СуммаПенсионныйФонд) КАК СуммаРегл,
	|	
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	НЕОПРЕДЕЛЕНО КАК СуммаВВалюте,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ПенсионныйФонд) КАК ВидОперацииПоЗарплате
	|
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК НачисленныйНДФЛ
	|ГДЕ
	|	НачисленныйНДФЛ.Ссылка = &Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленныйНДФЛ.ВидОперации,
	|	НачисленныйНДФЛ.ТипНалога
	//}
	//4D
	|";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаДвиженияДенежныеСредстваДоходыРасходы(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ДвиженияДенежныеСредстваДоходыРасходы";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	&Период КАК Период,
	|	Значение(Перечисление.ХозяйственныеОперации.УдержаниеНеизрасходованныхПодотчетныхСумм) КАК ХозяйственнаяОперация,
	|	&Организация КАК Организация,
	|	УдержаннаяЗарплата.ПодразделениеПредприятия КАК Подразделение,
	|
	|	УдержаннаяЗарплата.ФизическоеЛицо КАК ДенежныеСредства,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыДенежныхСредств.ДенежныеСредстваУПодотчетногоЛица) КАК ТипДенежныхСредств,
	|	НЕОПРЕДЕЛЕНО КАК СтатьяДвиженияДенежныхСредств,
	|	&ВалютаРегл КАК Валюта,
	|
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда) КАК СтатьяДоходовРасходов,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаАктивовПассивов,
	|
	|	УдержаннаяЗарплата.Сумма КАК Сумма,
	|	УдержаннаяЗарплата.Сумма КАК СуммаРегл,
	|	УдержаннаяЗарплата.Сумма КАК СуммаВВалюте,
	|
	|	НЕОПРЕДЕЛЕНО КАК ИсточникГФУДенежныхСредств,
	|	НЕОПРЕДЕЛЕНО КАК ИсточникГФУДоходовРасходов
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.УдержаннаяЗарплата КАК УдержаннаяЗарплата
	|	
	|ГДЕ
	|	УдержаннаяЗарплата.Ссылка = &Ссылка
	|	И УдержаннаяЗарплата.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.УдержаниеНеизрасходованныхПодотчетныхСумм)
	|";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаПрочиеАктивыПассивы(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ПрочиеАктивыПассивы";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	УстановитьПараметрЗапросаТаблицаВыработкаСотрудников(Запрос);
	
	Если НЕ ПроведениеСерверУТ.ЕстьТаблицаЗапроса("ВтТаблицаВыработкаСотрудников", ТекстыЗапроса) Тогда
		ТекстЗапросаВтВыработкаСотрудников(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	Если НЕ ПроведениеСерверУТ.ЕстьТаблицаЗапроса("ВтНачисленнаяЗарплатаИВзносы", ТекстыЗапроса) Тогда
		ТекстЗапросаВтНачисленнаяЗарплатаИВзносы(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	ТекстЗапроса =
	// зарплата к выплате на пассивы
	"ВЫБРАТЬ
	|	&Период КАК Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) КАК ВидДвижения,
	|	&Организация КАК Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда) КАК Статья,
	|	НЕОПРЕДЕЛЕНО КАК Аналитика,
	|	СУММА(ВЫРАЗИТЬ(Строки.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК Строки
	|ГДЕ
	|	Строки.Ссылка = &Ссылка
	|	И Строки.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|	И Строки.ВидОперации НЕ В ( ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход),
	|								ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|								ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|								ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства))
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫРАЗИТЬ(Строки.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// выработка к выплате на пассивы
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) КАК ВидДвижения,
	|	&Организация КАК Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда) КАК Статья,
	|	НЕОПРЕДЕЛЕНО КАК Аналитика,
	|	СУММА(ВыработкаСотрудников.Сумма) КАК Сумма
	|ИЗ
	|	ВтТаблицаВыработкаСотрудников КАК ВыработкаСотрудников
	|ГДЕ
	|	ВыработкаСотрудников.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|
	|ИМЕЮЩИЕ
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// В "ВтТаблицаВыработкаСотрудников" суммы по управленческому учету уже расчитаны
	// {
	|	СУММА(ВыработкаСотрудников.Сумма) <> 0
	// }
	// 4D
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// взносы к перечислению на пассивы
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход),
	|	&Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги),
	|	Строки.ТипНалога,
	|	СУММА(ВЫРАЗИТЬ(Строки.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК Строки
	|ГДЕ
	|	Строки.Ссылка = &Ссылка
	|	И Строки.ТипНалога <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|	И Строки.ВидОперации НЕ В ( ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход),
	|								ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|								ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|								ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства))
	|
	|СГРУППИРОВАТЬ ПО
	|	Строки.ТипНалога
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫРАЗИТЬ(Строки.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// взносы с выработки к перечислению на пассивы
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход),
	|	&Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги),
	|	ВыработкаСотрудников.ТипНалога,
	|	СУММА(ВыработкаСотрудников.Сумма) КАК Сумма
	|ИЗ
	|	ВтТаблицаВыработкаСотрудников КАК ВыработкаСотрудников
	|ГДЕ
	|	ВыработкаСотрудников.ТипНалога <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВыработкаСотрудников.ТипНалога
	|
	|ИМЕЮЩИЕ
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// В "ВтТаблицаВыработкаСотрудников" суммы по управленческому учету уже расчитаны
	// {
	|	СУММА(ВыработкаСотрудников.Сумма) <> 0
	// }
	// 4D
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// зарплата и взносы на активы / пассивы
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Организация КАК Организация,
	|	Строки.Подразделение КАК Подразделение,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Строки.СтатьяРасходов КАК Статья,
	|	Строки.АналитикаАктивовПассивов КАК Аналитика,
	|	СУММА(ВЫРАЗИТЬ(Строки.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК Строки
	|ГДЕ
	|	Строки.Ссылка = &Ссылка
	|	И Строки.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиАктивовПассивов
	|	И Строки.ВидОперации НЕ В ( ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход),
	|								ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|								ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|								ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства))
	|СГРУППИРОВАТЬ ПО
	|	Строки.СтатьяРасходов,
	|	Строки.АналитикаАктивовПассивов,
	|	Строки.Подразделение,
	|	Строки.НаправлениеДеятельности
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫРАЗИТЬ(Строки.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// выработка на активы / пассивы
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход),
	|	&Организация,
	|	ВыработкаСотрудников.Подразделение КАК Подразделение,
	|	ВыработкаСотрудников.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВыработкаСотрудников.СтатьяРасходов КАК Статья,
	|	ВыработкаСотрудников.АналитикаАктивовПассивов КАК Аналитика,
	|	СУММА(ВыработкаСотрудников.Сумма) КАК Сумма
	|ИЗ
	|	ВтТаблицаВыработкаСотрудников КАК ВыработкаСотрудников
	|ГДЕ
	|	ВыработкаСотрудников.СтатьяРасходов Ссылка ПланВидовХарактеристик.СтатьиАктивовПассивов
	|
	|СГРУППИРОВАТЬ ПО
	|	ВыработкаСотрудников.СтатьяРасходов,
	|	ВыработкаСотрудников.АналитикаАктивовПассивов,
	|	ВыработкаСотрудников.Подразделение,
	|	ВыработкаСотрудников.НаправлениеДеятельности
	|
	|ИМЕЮЩИЕ
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// В "ВтТаблицаВыработкаСотрудников" суммы по управленческому учету уже расчитаны
	// {
	|	СУММА(ВыработкаСотрудников.Сумма) <> 0
	// }
	// 4D
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// взносы для выплат за счет резерва перекладываем с пустой аналитики на заполненную
	// приход по пустой аналитике
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход),
	|	&Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги) КАК Статья,
	|	НЕОПРЕДЕЛЕНО КАК Аналитика,
	|	СУММА(ВЫРАЗИТЬ(Строки.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК Строки
	|ГДЕ
	|	Строки.Ссылка = &Ссылка
	|	И Строки.ТипНалога <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|	И Строки.ВидОперации В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|							ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|							ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства))
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫРАЗИТЬ(Строки.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// расход с заполненной аналитикой
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход),
	|	&Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги) КАК Статья,
	|	Строки.ТипНалога КАК Аналитика,
	|	СУММА(ВЫРАЗИТЬ(Строки.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) КАК Сумма
	|ИЗ
	|	ВТНачисленнаяЗарплатаИВзносы КАК Строки
	|ГДЕ
	|	Строки.Ссылка = &Ссылка
	|	И Строки.ТипНалога <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)
	|	И Строки.ВидОперации В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы),
	|							ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства),
	|							ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства))
	|СГРУППИРОВАТЬ ПО
	|	Строки.ТипНалога
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫРАЗИТЬ(Строки.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// уменьшаем сумму по оплате труда на величину удержаний
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход),
	|	&Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда),
	|	НЕОПРЕДЕЛЕНО,
	|	СУММА(ВЫРАЗИТЬ(Удержанния.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2)))
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.УдержаннаяЗарплата КАК Удержанния
	|ГДЕ
	|	Удержанния.Ссылка = &Ссылка
	|	И &ИспользоватьУчетПрочихАктивовПассивов
	|
	|СГРУППИРОВАТЬ ПО
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка),
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫРАЗИТЬ(Удержанния.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// уменьшаем сумму по оплате труда на величину НДФЛ
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход),
	|	&Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда),
	|	НЕОПРЕДЕЛЕНО,
	|	СУММА(ВЫРАЗИТЬ(НачисленныйНДФЛ.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2)))
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК НачисленныйНДФЛ
	|ГДЕ
	|	НачисленныйНДФЛ.Ссылка = &Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка),
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫРАЗИТЬ(НачисленныйНДФЛ.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	// уменьшаем сумму по оплате труда на величину взносов в пенсионный фонд
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход),
	|	&Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ОплатаТруда),
	|	НЕОПРЕДЕЛЕНО,
	|	СУММА(ВЫРАЗИТЬ(НачисленныйНДФЛ.СуммаПенсионныйФонд * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2)))
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК НачисленныйНДФЛ
	|ГДЕ
	|	НачисленныйНДФЛ.Ссылка = &Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка),
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫРАЗИТЬ(НачисленныйНДФЛ.СуммаПенсионныйФонд * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2))) <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// }
	// 4D
	// удержания
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход),
	|	&Организация,
	|	Удержанния.ПодразделениеПредприятия КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	Удержанния.СтатьяАктивовПассивов,
	|	Удержанния.АналитикаАктивовПассивов,
	|	СУММА(ВЫРАЗИТЬ(Удержанния.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2)))
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.УдержаннаяЗарплата КАК Удержанния
	|ГДЕ
	|	Удержанния.Ссылка = &Ссылка
	|	И Удержанния.ВидОперации Не В (ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.УдержаниеНеизрасходованныхПодотчетныхСумм),
	|								   ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.ВозвратИзлишнеВыплаченныхСуммВследствиеСчетныхОшибок))
	|	И &ИспользоватьУчетПрочихАктивовПассивов
	|
	|СГРУППИРОВАТЬ ПО
	|	Удержанния.СтатьяАктивовПассивов,
	|	Удержанния.АналитикаАктивовПассивов,
	|	Удержанния.ПодразделениеПредприятия,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// НДФЛ
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход),
	|	&Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги),
	|	НДФЛ.ТипНалога,
	|	СУММА(ВЫРАЗИТЬ(НДФЛ.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2)))
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК НДФЛ
	|ГДЕ
	|	НДФЛ.Ссылка = &Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	НДФЛ.ТипНалога
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	// Пенсионный фонд
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход),
	|	&Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) 						КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) 					КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.Налоги),
	|	ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПенсионныйФонд) 					КАК ТипНалога,
	|	СУММА(ВЫРАЗИТЬ(НДФЛ.СуммаПенсионныйФонд * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2)))
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ 					КАК НДФЛ
	|ГДЕ
	|	НДФЛ.Ссылка = &Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	НДФЛ.ТипНалога
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// }
	// 4D
	// Начисленные проценты по займам
	|ВЫБРАТЬ
	|	&Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход),
	|	&Организация,
	|	Проценты.ПодразделениеПредприятия КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ЗаймыВыданные),
	|	НЕОПРЕДЕЛЕНО,
	|	СУММА(ВЫРАЗИТЬ(Проценты.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2)))
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныеПроцентыПоЗаймам КАК Проценты
	|ГДЕ
	|	Проценты.Ссылка = &Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	Проценты.ПодразделениеПредприятия";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаПрочиеДоходы(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ПрочиеДоходы";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	&Период КАК Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Организация КАК Организация,
	|	НачисленныеПроценты.ПодразделениеПредприятия КАК Подразделение,
	|	НачисленныеПроценты.СтатьяДоходов КАК СтатьяДоходов,
	|	НачисленныеПроценты.АналитикаДоходов КАК АналитикаДоходов,
	|	СУММА(НачисленныеПроценты.Сумма) КАК Сумма,
	|	ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачисленияПоЗаймамВыданным) КАК ХозяйственнаяОперация
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныеПроцентыПоЗаймам КАК НачисленныеПроценты
	|ГДЕ
	|	НачисленныеПроценты.Ссылка = &Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленныеПроценты.СтатьяДоходов,
	|	НачисленныеПроценты.АналитикаДоходов,
	|	НачисленныеПроценты.ПодразделениеПредприятия
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&Период КАК Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	&Организация КАК Организация,
	|	УдержаннаяЗарплата.ПодразделениеПредприятия КАК Подразделение,
	|	УдержаннаяЗарплата.СтатьяДоходов КАК СтатьяДоходов,
	|	УдержаннаяЗарплата.АналитикаДоходов КАК АналитикаДоходов,
	|	СУММА(УдержаннаяЗарплата.Сумма) КАК Сумма,
	|	Неопределено
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.УдержаннаяЗарплата КАК УдержаннаяЗарплата
	|ГДЕ
	|	УдержаннаяЗарплата.Ссылка = &Ссылка
	|	И УдержаннаяЗарплата.ВидОперации = Значение(Перечисление.ВидыОперацийПоЗарплате.ВозвратИзлишнеВыплаченныхСуммВследствиеСчетныхОшибок)
	|
	|СГРУППИРОВАТЬ ПО
	|	УдержаннаяЗарплата.СтатьяДоходов,
	|	УдержаннаяЗарплата.АналитикаДоходов,
	|	УдержаннаяЗарплата.ПодразделениеПредприятия";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаДенежныеСредстваУПодотчетныхЛиц(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ДенежныеСредстваУПодотчетныхЛиц";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	&Период КАК Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) КАК ВидДвижения,
	|	&Организация КАК Организация,
	|	УдержаннаяЗарплата.ФизическоеЛицо КАК ПодотчетноеЛицо,
	|	УдержаннаяЗарплата.ПодразделениеПредприятия КАК Подразделение,
	|	&ВалютаРегл КАК Валюта,
	|
	|	УдержаннаяЗарплата.ЦельВыдачи КАК ЦельВыдачи,
	|	
	|	УдержаннаяЗарплата.Сумма КАК Сумма,
	|	УдержаннаяЗарплата.Сумма КАК СуммаРегл,
	|	ВЫРАЗИТЬ(УдержаннаяЗарплата.Сумма * &КоэффициентПересчетаВВалютуУпр КАК ЧИСЛО(15, 2)) КАК СуммаУпр,
	|	УдержаннаяЗарплата.Сумма КАК КОтчету
	|	
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.УдержаннаяЗарплата КАК УдержаннаяЗарплата
	|	
	|ГДЕ
	|	УдержаннаяЗарплата.Ссылка = &Ссылка
	|	И УдержаннаяЗарплата.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.УдержаниеНеизрасходованныхПодотчетныхСумм)";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаОтражениеДокументовВРеглУчете(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ОтражениеДокументовВРеглУчете";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	&Дата						 КАК Период,
	|	&Организация 				 КАК Организация,
	|	НАЧАЛОПЕРИОДА(&Период, ДЕНЬ) КАК ДатаОтражения";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаПорядокОтраженияПрочихОпераций(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ПорядокОтраженияПрочихОпераций";
	
	Если НЕ ПроведениеСерверУТ.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	ТекстЗапроса =
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	&Дата	КАК Дата,
	|	&Организация КАК Организация,
	|	&Ссылка КАК Документ,
	|	"""" КАК ИдентификаторСтроки
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленнаяЗарплатаИВзносы КАК Строки
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.СпособыОтраженияЗарплатыВБухУчете КАК СпособыОтражения
	|		ПО СпособыОтражения.Ссылка = Строки.СпособОтраженияЗарплатыВБухучете
	|ГДЕ
	|	Строки.Ссылка = &Ссылка
	|	И СпособыОтражения.ЕстьПрочиеОперации";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	Возврат ТекстЗапроса;
	
КонецФункции

#Область СлужебныеПроцедурыИФункцииПроведения

Функция БазаРаспределенияТрудозатрат()
	
	ТекстЗапроса =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	НачисленнаяЗарплата.ФизическоеЛицо КАК Сотрудник,
	|	&Организация КАК Организация,
	|	НачисленнаяЗарплата.ОблагаетсяЕНВД КАК ОблагаетсяЕНВД
	|ПОМЕСТИТЬ ВТСотрудникиСдельная
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленнаяЗарплатаИВзносыПоФизлицам КАК НачисленнаяЗарплата
	|ГДЕ
	|	НачисленнаяЗарплата.Ссылка = &Ссылка
	|	И НачисленнаяЗарплата.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход)
	|	И &ДетализацияПоФизлицам
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленнаяЗарплата.ФизическоеЛицо,
	|	НачисленнаяЗарплата.ПодразделениеПредприятия,
	|	НачисленнаяЗарплата.ОблагаетсяЕНВД
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	НачисленнаяЗарплата.ПодразделениеПредприятия,
	|	ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка),
	|	&Организация,
	|	НачисленнаяЗарплата.ОблагаетсяЕНВД
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленнаяЗарплатаИВзносы КАК НачисленнаяЗарплата
	|ГДЕ
	|	НачисленнаяЗарплата.Ссылка = &Ссылка
	|	И НачисленнаяЗарплата.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход)
	|	И НЕ &ДетализацияПоФизлицам
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленнаяЗарплата.ПодразделениеПредприятия,
	|	НачисленнаяЗарплата.ОблагаетсяЕНВД
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	Подразделение,
	|	Сотрудник,
	|	ОблагаетсяЕНВД
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВыработкаСотрудников.Подразделение КАК Подразделение,
	|	ВЫБОР
	|		КОГДА &ДетализацияПоФизлицам
	|			ТОГДА ВыработкаСотрудниковСотрудники.Сотрудник
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ КАК Сотрудник,
	|	НЕОПРЕДЕЛЕНО КАК ПартияПроизводства,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаПартийПроизводства,
	|	НЕОПРЕДЕЛЕНО КАК ЗаказНаПроизводство,
	|	НЕОПРЕДЕЛЕНО КАК НаправлениеДеятельности,
	|	0 КАК КодСтрокиПродукция,
	|	НЕОПРЕДЕЛЕНО КАК Этап,
	|	ЗНАЧЕНИЕ(Справочник.СтатьиКалькуляции.ПустаяСсылка) КАК СтатьяКалькуляции,
	|	ЗНАЧЕНИЕ(Справочник.ВидыРаботСотрудников.ПустаяСсылка) КАК ВидРабот,
	|	ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка) КАК ГруппаПродукции,
	|	ВыработкаСотрудниковВидыРабот.СпособОтраженияЗарплаты КАК СпособОтражения,
	|	СУММА(ВЫБОР
	|			КОГДА ВыработкаСотрудниковВидыРабот.Ссылка.Автораспределение
	|				ТОГДА ВыработкаСотрудниковСотрудники.НормативныйКТУ * ВыработкаСотрудниковВидыРабот.Сумма / ВыработкаСотрудниковВидыРабот.Ссылка.КТУОбщий
	|			ИНАЧЕ ВыработкаСотрудниковСотрудники.Сумма
	|		КОНЕЦ * &КоэффициентПересчетаВВалютуУПР) КАК НормативнаяСтоимость,
	|	&Организация КАК Организация,
	|	""ПрочиеРасходыАктивыПассивы"" КАК ИдентификаторНабора,
	|	ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаНоменклатуры.ПустаяСсылка) КАК АналитикаУчетаПродукции,
	|	0 КАК Количество,
	|	ВТСотрудникиСдельная.ОблагаетсяЕНВД КАК ОблагаетсяЕНВД,
	|	ВЫБОР ИСТИНА
	//++ НЕ УТКА
	|		КОГДА ИСТИНА
	|			ТОГДА ЗаказНаРемонт.Ссылка.ОбъектЭксплуатации
	//-- НЕ УТКА
	|		КОГДА ИСТИНА
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ОбъектЭксплуатации
	|ПОМЕСТИТЬ ВТТрудозатраты
	|ИЗ
	|	Документ.ВыработкаСотрудников КАК ВыработкаСотрудников
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ВыработкаСотрудников.ВидыРабот КАК ВыработкаСотрудниковВидыРабот
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ВыработкаСотрудников.Сотрудники КАК ВыработкаСотрудниковСотрудники
	|			ПО ВыработкаСотрудниковВидыРабот.Ссылка = ВыработкаСотрудниковСотрудники.Ссылка
	|				И (ВыработкаСотрудниковВидыРабот.Ссылка.Автораспределение
	|					ИЛИ ВыработкаСотрудниковВидыРабот.КлючСтроки = ВыработкаСотрудниковСотрудники.КлючСтроки)
	|		ПО ВыработкаСотрудников.Ссылка = ВыработкаСотрудниковВидыРабот.Ссылка
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСотрудникиСдельная КАК ВТСотрудникиСдельная
	|		ПО (НЕ &ДетализацияПоФизлицам
	|				ИЛИ ВыработкаСотрудниковСотрудники.Сотрудник = ВТСотрудникиСдельная.Сотрудник)
	|			И (&ДетализацияПоФизлицам
	|				ИЛИ ВыработкаСотрудников.Подразделение = ВТСотрудникиСдельная.Подразделение)
	|			И ВыработкаСотрудников.Организация = ВТСотрудникиСдельная.Организация
	//++ НЕ УТКА
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ЗаказНаРемонт.Трудозатраты КАК ЗаказНаРемонт
	|		ПО (ВыработкаСотрудниковВидыРабот.Распоряжение = ЗаказНаРемонт.Ссылка)
	|			И (ВыработкаСотрудниковВидыРабот.КодСтрокиРаспоряжения = ЗаказНаРемонт.КодСтроки)
	//-- НЕ УТКА
	|ГДЕ
	|	ВыработкаСотрудников.ВидНаряда В (ЗНАЧЕНИЕ(Перечисление.ВидыБригадныхНарядов.ПрочиеРаботы), ЗНАЧЕНИЕ(Перечисление.ВидыБригадныхНарядов.Ремонт))
	|	И ВыработкаСотрудников.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания
	|	И ВыработкаСотрудников.Проведен
	|	И ВыработкаСотрудников.Организация = &Организация
	|
	|СГРУППИРОВАТЬ ПО
	//++ НЕ УТКА
	|	ЗаказНаРемонт.Ссылка.ОбъектЭксплуатации,
	//-- НЕ УТКА
	|	ВыработкаСотрудниковВидыРабот.СпособОтраженияЗарплаты,
	|	ВТСотрудникиСдельная.ОблагаетсяЕНВД,
	|	ВЫБОР
	|		КОГДА &ДетализацияПоФизлицам
	|			ТОГДА ВыработкаСотрудниковСотрудники.Сотрудник
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ,
	|	ВыработкаСотрудников.Ссылка,
	|	ВыработкаСотрудников.Подразделение
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ТрудозатратыНЗП.Подразделение,
	|	ВЫБОР
	|		КОГДА &ДетализацияПоФизлицам
	|			ТОГДА ТрудозатратыНЗП.Сотрудник
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ,
	|	ТрудозатратыНЗП.ПартияПроизводства,
	|	ТрудозатратыНЗП.АналитикаУчетаПартийПроизводства,
	|	ТрудозатратыНЗП.ЗаказНаПроизводство,
	|	ВЫБОР
	//++ НЕ УТКА
	|		КОГДА ИСТИНА ТОГДА
	|			ЕСТЬNULL(ПродукцияЗаказа.Назначение.НаправлениеДеятельности,
	|				ЕСТЬNULL(ЭтапПроизводства.Назначение.НаправлениеДеятельности, КлючиПартийПроизводства.Назначение.НаправлениеДеятельности))
	//-- НЕ УТКА
	|		КОГДА ИСТИНА ТОГДА
	|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|	КОНЕЦ КАК НаправлениеДеятельности,
	|	ТрудозатратыНЗП.КодСтрокиПродукция,
	|	ТрудозатратыНЗП.Этап,
	|	ТрудозатратыНЗП.СтатьяКалькуляции,
	|	ТрудозатратыНЗП.ВидРабот,
	|	ТрудозатратыНЗП.ГруппаПродукции,
	|	ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВБухУчете.ПустаяСсылка),
	|	СУММА(ТрудозатратыНЗП.НормативнаяСтоимость),
	|	ТрудозатратыНЗП.Организация,
	|	""ТрудозатратыНезавершенногоПроизводства"",
	|	ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаНоменклатуры.ПустаяСсылка),
	|	ТрудозатратыНЗП.Количество,
	|	ВТСотрудникиСдельная.ОблагаетсяЕНВД,
	|	НЕОПРЕДЕЛЕНО
	|ИЗ
	|	РегистрНакопления.ТрудозатратыНезавершенногоПроизводства КАК ТрудозатратыНЗП
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСотрудникиСдельная КАК ВТСотрудникиСдельная
	|		ПО (ВЫБОР
	|				КОГДА &ДетализацияПоФизлицам ТОГДА ТрудозатратыНЗП.Сотрудник = ВТСотрудникиСдельная.Сотрудник
	|				ИНАЧЕ ТрудозатратыНЗП.Подразделение = ВТСотрудникиСдельная.Подразделение
	|			КОНЕЦ)
	|			И ТрудозатратыНЗП.Организация = ВТСотрудникиСдельная.Организация
	//++ НЕ УТКА
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ЗаказНаПроизводство.Продукция КАК ПродукцияЗаказа
	|		ПО ТрудозатратыНЗП.ЗаказНаПроизводство = ПродукцияЗаказа.Ссылка
	|			И ТрудозатратыНЗП.КодСтрокиПродукция = ПродукцияЗаказа.КодСтроки
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ЭтапПроизводства2_2 КАК ЭтапПроизводства
	|		ПО ТрудозатратыНЗП.ПартияПроизводства = ЭтапПроизводства.Ссылка
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПартийПроизводства КАК КлючиПартийПроизводства
	|		ПО ТрудозатратыНЗП.АналитикаУчетаПартийПроизводства = КлючиПартийПроизводства.КлючАналитики
	//-- НЕ УТКА
	|
	|ГДЕ
	|	ТрудозатратыНЗП.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
	|	И ТрудозатратыНЗП.Организация В
	|			(ВЫБРАТЬ
	|				Т.Организация
	|			ИЗ
	|				ВТСотрудникиСдельная КАК Т)
	|	И ТрудозатратыНЗП.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|	И ТрудозатратыНЗП.НормативнаяСтоимость > 0
	|	И ТрудозатратыНЗП.Регистратор Ссылка Документ.ВыработкаСотрудников
	|
	|СГРУППИРОВАТЬ ПО
	|	ТрудозатратыНЗП.Организация,
	|	ТрудозатратыНЗП.Подразделение,
	|	ВТСотрудникиСдельная.ОблагаетсяЕНВД,
	|	ВЫБОР
	|		КОГДА &ДетализацияПоФизлицам
	|			ТОГДА ТрудозатратыНЗП.Сотрудник
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ,
	|	ТрудозатратыНЗП.ПартияПроизводства,
	|	ТрудозатратыНЗП.АналитикаУчетаПартийПроизводства,
	|	ТрудозатратыНЗП.ЗаказНаПроизводство,
	|	ТрудозатратыНЗП.Этап,
	|	ТрудозатратыНЗП.СтатьяКалькуляции,
	|	ТрудозатратыНЗП.ВидРабот,
	|	ТрудозатратыНЗП.ГруппаПродукции,
	|	ТрудозатратыНЗП.КодСтрокиПродукция,
	//++ НЕ УТКА
	|	ПродукцияЗаказа.Назначение.НаправлениеДеятельности,
	|	ЭтапПроизводства.Назначение.НаправлениеДеятельности,
	|	КлючиПартийПроизводства.Назначение.НаправлениеДеятельности,
	//-- НЕ УТКА
	|	ТрудозатратыНЗП.Количество
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	Подразделение,
	|	Сотрудник
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	НЕОПРЕДЕЛЕНО КАК ЗаказНаПроизводство,
	|	НЕОПРЕДЕЛЕНО КАК КодСтрокиПродукция,
	|	НЕОПРЕДЕЛЕНО КАК ПартияПроизводства,
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// Локализовать настройку "Статьи калькуляции для взносов в фонды", № 15952
	// {
	|	ЗНАЧЕНИЕ(Справочник.СтатьиКалькуляции.ПустаяСсылка) КАК СтатьяКалькуляцииБелгосстрах,
	|	ЗНАЧЕНИЕ(Справочник.СтатьиКалькуляции.ПустаяСсылка) КАК СтатьяКалькуляцииФСЗН
	// }
	// 4D
	|ПОМЕСТИТЬ ВТСтатьиКалькуляцииВзносов
	//++ НЕ УТКА
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	// Статьи калькуляции могут настраиваться в ресурсной спецификации, при этом должны быть заполнены либо все статьи, либо ни одной.
	// Выбираем статьи из спецификации, если они заполнены.
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ВТТрудозатраты.ЗаказНаПроизводство,
	|	ВТТрудозатраты.КодСтрокиПродукция,
	|	НЕОПРЕДЕЛЕНО КАК ПартияПроизводства,
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826 
	// Локализовать настройку "Статьи калькуляции для взносов в фонды", № 15952
	// {
	|	РесурсныеСпецификации.СтатьяКалькуляцииБелгосстрах,
	|	РесурсныеСпецификации.СтатьяКалькуляцииФСЗН
	// }
	// 4D
	|ИЗ
	|	ВТТрудозатраты КАК ВТТрудозатраты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗаказНаПроизводство.Продукция КАК ЗаказНаПроизводствоПродукция
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.РесурсныеСпецификации КАК РесурсныеСпецификации
	|			ПО ЗаказНаПроизводствоПродукция.Спецификация = РесурсныеСпецификации.Ссылка
	|		ПО ВТТрудозатраты.ЗаказНаПроизводство = ЗаказНаПроизводствоПродукция.Ссылка
	|			И ВТТрудозатраты.КодСтрокиПродукция = ЗаказНаПроизводствоПродукция.КодСтроки
	|ГДЕ
	|	ВТТрудозатраты.ИдентификаторНабора = ""ТрудозатратыНезавершенногоПроизводства""
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826 
	// Локализовать настройку "Статьи калькуляции для взносов в фонды", № 15952
	// {
	|	И РесурсныеСпецификации.СтатьяКалькуляцииБелгосстрах <> ЗНАЧЕНИЕ(Справочник.СтатьиКалькуляции.ПустаяСсылка)
	// }
	// 4D
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ЗНАЧЕНИЕ(Документ.ЗаказНаПроизводство.ПустаяСсылка) КАК ЗаказНаПроизводство,
	|	0 КАК КодСтрокиПродукция,
	|	ВТТрудозатраты.ПартияПроизводства КАК ПартияПроизводства,
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826 
	// Локализовать настройку "Статьи калькуляции для взносов в фонды", № 15952
	// {
	|	РесурсныеСпецификации.СтатьяКалькуляцииБелгосстрах,
	|	РесурсныеСпецификации.СтатьяКалькуляцииФСЗН
	// }
	// 4D
	|ИЗ
	|	ВТТрудозатраты КАК ВТТрудозатраты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЭтапПроизводства2_2 КАК ЭтапПроизводства2_2
	|		ПО ВТТрудозатраты.ПартияПроизводства = ЭтапПроизводства2_2.Ссылка
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.РесурсныеСпецификации КАК РесурсныеСпецификации
	|		ПО ЭтапПроизводства2_2.Спецификация = РесурсныеСпецификации.Ссылка
	|ГДЕ
	|	ВТТрудозатраты.ИдентификаторНабора = ""ТрудозатратыНезавершенногоПроизводства""
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826 
	// Локализовать настройку "Статьи калькуляции для взносов в фонды", № 15952
	// {
	|	И РесурсныеСпецификации.СтатьяКалькуляцииБелгосстрах <> ЗНАЧЕНИЕ(Справочник.СтатьиКалькуляции.ПустаяСсылка)
	// }
	// 4D
	//-- НЕ УТКА
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ВТТрудозатраты.СпособОтражения КАК СпособОтражения
	|ПОМЕСТИТЬ ВтСписокСпособовОтражения
	|ИЗ
	|	ВТТрудозатраты КАК ВТТрудозатраты
	|ГДЕ
	|	ВТТрудозатраты.ИдентификаторНабора = ""ПрочиеРасходыАктивыПассивы""
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТТрудозатраты.НормативнаяСтоимость КАК Коэффициент,
	|	ВТТрудозатраты.Подразделение КАК Подразделение,
	|	ВТТрудозатраты.Сотрудник КАК Сотрудник,
	|	ВТТрудозатраты.ОблагаетсяЕНВД КАК ОблагаетсяЕНВД,
	|	ВТТрудозатраты.ПартияПроизводства КАК ПартияПроизводства,
	|	ВТТрудозатраты.АналитикаУчетаПартийПроизводства КАК АналитикаУчетаПартийПроизводства,
	|	ВТТрудозатраты.ЗаказНаПроизводство КАК ЗаказНаПроизводство,
	|	ВТТрудозатраты.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ВТТрудозатраты.КодСтрокиПродукция КАК КодСтрокиПродукция,
	|	ВТТрудозатраты.Этап КАК Этап,
	|	ВТТрудозатраты.СтатьяКалькуляции КАК СтатьяКалькуляции,
	|	ВТТрудозатраты.ВидРабот КАК ВидРабот,
	|	ВТТрудозатраты.ГруппаПродукции,
	|	ВТТрудозатраты.Организация КАК Организация,
	|	ВТТрудозатраты.АналитикаУчетаПродукции КАК АналитикаУчетаПродукции,
	|	ВТТрудозатраты.ИдентификаторНабора КАК ИдентификаторНабора,
	|	ВТТрудозатраты.Количество,
	// Если статьи заданы в спецификации, то выбираем их.
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826 
	// Локализовать настройку "Статьи калькуляции для взносов в фонды", № 15952
	// {
	|	ЕСТЬNULL(СтатьиВзносов.СтатьяКалькуляцииБелгосстрах, ВТТрудозатраты.СтатьяКалькуляции) КАК СтатьяКалькуляцииБелгосстрах,
	|	ЕСТЬNULL(СтатьиВзносов.СтатьяКалькуляцииФСЗН, ВТТрудозатраты.СтатьяКалькуляции) КАК СтатьяКалькуляцииФСЗН,
	// }
	// 4D
	|	ВТТрудозатраты.СпособОтражения,
	|	ВТТрудозатраты.ОбъектЭксплуатации
	|ПОМЕСТИТЬ База
	|ИЗ
	|	ВТТрудозатраты КАК ВТТрудозатраты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТСтатьиКалькуляцииВзносов КАК СтатьиВзносов
	|		ПО ВТТрудозатраты.ЗаказНаПроизводство = СтатьиВзносов.ЗаказНаПроизводство
	|			И ВТТрудозатраты.КодСтрокиПродукция = СтатьиВзносов.КодСтрокиПродукция
	|			И ВТТрудозатраты.ПартияПроизводства = СтатьиВзносов.ПартияПроизводства
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	База.Подразделение КАК Подразделение,
	|	База.Сотрудник КАК Сотрудник,
	|	База.ОблагаетсяЕНВД КАК ОблагаетсяЕНВД,
	|	База.ПартияПроизводства КАК ПартияПроизводства,
	|	База.АналитикаУчетаПартийПроизводства КАК АналитикаУчетаПартийПроизводства,
	|	База.ЗаказНаПроизводство КАК ЗаказНаПроизводство,
	|	База.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	База.КодСтрокиПродукция КАК КодСтрокиПродукция,
	|	База.Этап КАК Этап,
	|	База.СтатьяКалькуляции КАК СтатьяКалькуляции,
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826 
	// Локализовать настройку "Статьи калькуляции для взносов в фонды", № 15952
	// {
	|	База.СтатьяКалькуляцииБелгосстрах КАК СтатьяКалькуляцииБелгосстрах,
	|	База.СтатьяКалькуляцииФСЗН КАК СтатьяКалькуляцииФСЗН,
	// }
	// 4D
	|	База.ВидРабот КАК ВидРабот,
	|	База.ГруппаПродукции,
	|	База.Коэффициент КАК Коэффициент,
	|	&Период КАК Период,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	База.Организация КАК Организация,
	|	База.ИдентификаторНабора КАК ИдентификаторНабора,
	|	База.СпособОтражения,
	|	База.ОбъектЭксплуатации
	|ИЗ
	|	База КАК База
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Начислено.НомерСтроки КАК НомерСтроки,
	|	Начислено.ФизическоеЛицо КАК Сотрудник,
	|	Начислено.ПодразделениеПредприятия КАК Подразделение,
	|	Начислено.ОблагаетсяЕНВД КАК ОблагаетсяЕНВД,
	|	Начислено.ВидНачисленияОплатыТрудаДляНУ КАК ВидНачисленияОплатыТруда,
	|	&Организация КАК Организация,
	|	Начислено.Сумма КАК Сумма,
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826 
	// {
	// Действие не требуется
	// }
	// 4D
	// 4D:ERP для Беларуси, Яна, 04.09.2017 11:19:44 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	Начислено.ФСЗН КАК ФСЗН,
	//|	Начислено.ПенсионныйФонд КАК ПенсионныйФонд,
	|	Начислено.Белгосстрах КАК Белгосстрах,
	//|	Начислено.ПС КАК ПС,
	//|	Начислено.СС КАК СС,
	// }
	// 4D
	|	Начислено.ВидОперации
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленнаяЗарплатаИВзносыПоФизлицам КАК Начислено
	|ГДЕ
	|	Начислено.Ссылка = &Ссылка
	|	И Начислено.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход)
	|	И НЕ &Сводно
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Начислено.НомерСтроки,
	|	ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка),
	|	Начислено.ПодразделениеПредприятия,
	|	Начислено.ОблагаетсяЕНВД,
	|	Начислено.ВидНачисленияОплатыТрудаДляНУ,
	|	&Организация,
	|	Начислено.Сумма,
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826 
	// {
	// Действие не требуется
	// }
	// 4D
	// 4D:ERP для Беларуси, Яна, 04.09.2017 11:19:44 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	|	Начислено.ФСЗН,
	//|	Начислено.ПенсионныйФонд,
	|	Начислено.Белгосстрах,
	//|	Начислено.ПС,
	//|	Начислено.СС,
	// }
	// 4D
	|	Начислено.ВидОперации
	|ИЗ
	|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленнаяЗарплатаИВзносы КАК Начислено
	|ГДЕ
	|	Начислено.Ссылка = &Ссылка
	|	И Начислено.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийПоЗарплате.НачисленоСдельноДоход)
	|	И &Сводно
	|
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки";
	
	ТекстЗапроса = ТекстЗапроса +
	";
	|////////////////////////////////////////////////////////////////////////////////
	|";
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция НоваяТаблицаВыработкаСотрудников()
	
	Таблица = Новый ТаблицаЗначений;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ ПЕРВЫЕ 0
		|	ОтражениеЗарплатыВФинансовомУчете.Период,
		|	ОтражениеЗарплатыВФинансовомУчете.Регистратор,
		|	ОтражениеЗарплатыВФинансовомУчете.НомерСтроки,
		|	ОтражениеЗарплатыВФинансовомУчете.Активность,
		|	ОтражениеЗарплатыВФинансовомУчете.Организация,
		|	ОтражениеЗарплатыВФинансовомУчете.Подразделение,
		|	ОтражениеЗарплатыВФинансовомУчете.НаправлениеДеятельности,
		|	ОтражениеЗарплатыВФинансовомУчете.ВидНачисленияОплатыТруда,
		|	ОтражениеЗарплатыВФинансовомУчете.ВидОперацииПоЗарплате,
		|	ОтражениеЗарплатыВФинансовомУчете.СтатьяРасходов,
		|	ОтражениеЗарплатыВФинансовомУчете.АналитикаРасходов,
		|	ОтражениеЗарплатыВФинансовомУчете.ВидРабот,
		|	ОтражениеЗарплатыВФинансовомУчете.ФизическоеЛицо КАК Сотрудник,
		|	ОтражениеЗарплатыВФинансовомУчете.ГруппаПродукции,
		|	ОтражениеЗарплатыВФинансовомУчете.ТипНалога,
		|	ОтражениеЗарплатыВФинансовомУчете.АналитикаАктивовПассивов,
		|	ОтражениеЗарплатыВФинансовомУчете.СчетУчета,
		|	ОтражениеЗарплатыВФинансовомУчете.Субконто1,
		|	ОтражениеЗарплатыВФинансовомУчете.Субконто2,
		|	ОтражениеЗарплатыВФинансовомУчете.Субконто3,
		|	ОтражениеЗарплатыВФинансовомУчете.СуммаРегл,
		|	0 КАК Сумма,
		|	&ЗаказНаПроизводство                                   КАК ЗаказНаПроизводство,
		|	0                                                      КАК КодСтрокиПродукция,
		|	ЗНАЧЕНИЕ(Справочник.ЭтапыПроизводства.ПустаяСсылка)    КАК Этап,
		|	ЗНАЧЕНИЕ(Справочник.СтатьиКалькуляции.ПустаяСсылка)    КАК СтатьяКалькуляции,
		|	ЗНАЧЕНИЕ(Перечисление.ВидыФондовВзносов.ПустаяСсылка)  КАК ВидФондаВзносов,
		|	&ПартияПроизводства                                    КАК ПартияПроизводства,
		|	&АналитикаУчетаПартийПроизводства                      КАК АналитикаУчетаПартийПроизводства,
		|	ОтражениеЗарплатыВФинансовомУчете.ВидПлатежаВГосБюджет КАК ВидПлатежаВГосБюджет
		|ИЗ
		|	РегистрНакопления.ОтражениеЗарплатыВФинансовомУчете КАК ОтражениеЗарплатыВФинансовомУчете
		//++ НЕ УТКА
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ ПЕРВЫЕ 0
		|							ТрудозатратыНезавершенногоПроизводства.ПартияПроизводства,
		|							ТрудозатратыНезавершенногоПроизводства.АналитикаУчетаПартийПроизводства
		|						ИЗ
		|							РегистрНакопления.ТрудозатратыНезавершенногоПроизводства КАК ТрудозатратыНезавершенногоПроизводства
		|						) КАК ТрудозатратыНезавершенногоПроизводства
		|		ПО ИСТИНА
		//-- НЕ УТКА
		|";
		
	Если НЕ ПолучитьФункциональнуюОпцию("УправлениеПредприятием") Тогда
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&ЗаказНаПроизводство", """ """);
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&ПартияПроизводства", """ """);
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&АналитикаУчетаПартийПроизводства", """ """);
	//++ НЕ УТКА
	Иначе
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&ЗаказНаПроизводство", "ЗНАЧЕНИЕ(Документ.ЗаказНаПроизводство.ПустаяСсылка)");
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&ПартияПроизводства", "ТрудозатратыНезавершенногоПроизводства.ПартияПроизводства");
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&АналитикаУчетаПартийПроизводства", "ТрудозатратыНезавершенногоПроизводства.АналитикаУчетаПартийПроизводства");
	//-- НЕ УТКА
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Таблица = Результат.Выгрузить();
	
	Возврат Таблица;
	
КонецФункции

Функция ПараметрыРаспределенияСтроки(ВидСуммы, СтрокаБазы, ДанныеСпособа)
	
	Параметры = Новый Структура("ИдентификаторНабора, ТипНалога, ВидФондаВзносов, ВидПлатежаВГосБюджет");
	
	Параметры.ТипНалога            = ВидСуммы.ТипНалога;
	Параметры.ВидФондаВзносов      = ВидСуммы.ВидФондаВзносов;
	Параметры.ВидПлатежаВГосБюджет = ВидСуммы.ВидПлатежаВГосБюджет;
	
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826 
	// Локализовать настройку "Статьи калькуляции для взносов в фонды", № 15952
	// {
	Если ВидСуммы.ВидФондаВзносов = Перечисления.ВидыФондовВзносов.Белгосстрах Тогда
		Параметры.Вставить("СтатьяКалькуляции", СтрокаБазы.СтатьяКалькуляцииБелгосстрах);
	ИначеЕсли ВидСуммы.ВидФондаВзносов = Перечисления.ВидыФондовВзносов.ФСЗН Тогда
		Параметры.Вставить("СтатьяКалькуляции", СтрокаБазы.СтатьяКалькуляцииФСЗН);
	// {	
	// 4D	
		
	КонецЕсли;
	
	Если СтрокаБазы.ИдентификаторНабора = "ПрочиеРасходыАктивыПассивы" Тогда
		
		СтруктураОтбора = Новый Структура("СпособОтражения, ОблагаетсяЕНВД", СтрокаБазы.СпособОтражения, СтрокаБазы.ОблагаетсяЕНВД);
		ДанныеСпособа.НайтиСледующий(СтруктураОтбора);
		
		Параметры.Вставить("СтатьяРасходов", ДанныеСпособа["СтатьяРасходов" + ВидСуммы.Постфикс]);
		Параметры.Вставить("НаправлениеДеятельности", ДанныеСпособа["НаправлениеДеятельности"]);
		
		Если ТипЗнч(Параметры.СтатьяРасходов) = Тип("ПланВидовХарактеристикСсылка.СтатьиРасходов") Тогда
			Параметры.ИдентификаторНабора = "ПрочиеРасходы";
			Параметры.Вставить("АналитикаРасходов",         ДанныеСпособа["АналитикаРасходов" + ВидСуммы.Постфикс]);
			
			ИмяАналитики = "АналитикаРасходов";
			
		Иначе
			Параметры.ИдентификаторНабора = "ПрочиеАктивыПассивы";
			Параметры.Вставить("АналитикаАктивовПассивов",  ДанныеСпособа["АналитикаАктивовПассивов" + ВидСуммы.Постфикс]);
			Параметры.Вставить("СчетУчета",                 ДанныеСпособа["СчетУчета" + ВидСуммы.Постфикс]);
			Параметры.Вставить("Субконто1",                 ДанныеСпособа["Субконто1" + ВидСуммы.Постфикс]);
			Параметры.Вставить("Субконто2",                 ДанныеСпособа["Субконто2" + ВидСуммы.Постфикс]);
			Параметры.Вставить("Субконто3",                 ДанныеСпособа["Субконто3" + ВидСуммы.Постфикс]);
			
			ИмяАналитики = "АналитикаАктивовПассивов";
			
			// автоматический подбор Субконто
			Для НомерСубконто = 1 По 3 Цикл
				
				ИмяСубконто = "Субконто" + Строка(НомерСубконто);
				
				Если Не ЗначениеЗаполнено(Параметры[ИмяСубконто]) Тогда
					Если ТипЗнч(Параметры[ИмяСубконто]) = Тип("СправочникСсылка.ФизическиеЛица") Тогда
						Параметры[ИмяСубконто] = СтрокаБазы.Сотрудник;
					ИначеЕсли ТипЗнч(Параметры[ИмяСубконто]) = Тип("СправочникСсылка.ОбъектыЭксплуатации") Тогда
						Параметры[ИмяСубконто] = СтрокаБазы.ОбъектЭксплуатации;
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
			
		КонецЕсли;
		
		// автоматический подбор аналитики
		Если Не ЗначениеЗаполнено(Параметры[ИмяАналитики]) Тогда
			
			Если ТипЗнч(Параметры[ИмяАналитики]) = Тип("СправочникСсылка.Организации") Тогда
				Параметры[ИмяАналитики] = СтрокаБазы.Организация;
			ИначеЕсли ТипЗнч(Параметры[ИмяАналитики]) = Тип("СправочникСсылка.ФизическиеЛица") Тогда
				Параметры[ИмяАналитики] = СтрокаБазы.Сотрудник;
			ИначеЕсли ТипЗнч(Параметры[ИмяАналитики]) = Тип("СправочникСсылка.СтруктураПредприятия") Тогда
				Параметры[ИмяАналитики] = СтрокаБазы.Подразделение;
			ИначеЕсли ТипЗнч(Параметры[ИмяАналитики]) = Тип("СправочникСсылка.ОбъектыЭксплуатации") Тогда
				Параметры[ИмяАналитики] = СтрокаБазы.ОбъектЭксплуатации;
			КонецЕсли;
			
		КонецЕсли;
		
		ДанныеСпособа.Сбросить();
		
	КонецЕсли;
	
	Возврат Параметры;
	
КонецФункции

Функция ДополнительныеИсточникиДанныхДляДвижений(ИмяРегистра) Экспорт
	
	ИсточникиДанных = Новый Соответствие;
	
	Возврат ИсточникиДанных; 
	
КонецФункции

#КонецОбласти

#КонецОбласти

#Область Отчеты

// Заполняет список команд отчетов.
// 
// Параметры:
//   КомандыОтчетов - ТаблицаЗначений - состав полей см. в функции МенюОтчеты.СоздатьКоллекциюКомандОтчетов
//
Процедура ДобавитьКомандыОтчетов(КомандыОтчетов) Экспорт

	ВариантыОтчетовУТПереопределяемый.ДобавитьКомандуДвиженияДокумента(КомандыОтчетов);

КонецПроцедуры

#КонецОбласти

// Заполняет список команд печати.
// 
// Параметры:
//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	
	
КонецПроцедуры

Процедура ЗаполнитьПодразделениеПредприятияНачисленоСдельно(ДанныеДляОтражения, СтруктураПараметров)
	
	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	ТрудозатратыНЗП.Подразделение КАК ПодразделениеПредприятия,
	|	СУММА(ТрудозатратыНЗП.НормативнаяСтоимость) КАК НормативнаяСтоимость,
	|	ТрудозатратыНЗП.Сотрудник КАК ФизическоеЛицо
	|ПОМЕСТИТЬ ВТБазаРаспределения
	|ИЗ
	|	РегистрНакопления.ТрудозатратыНезавершенногоПроизводства КАК ТрудозатратыНЗП
	|ГДЕ
	|	ТрудозатратыНЗП.Регистратор ССЫЛКА Документ.ВыработкаСотрудников
	|	И ТрудозатратыНЗП.Сотрудник В(&СписокФизическихЛиц)
	|	И ТрудозатратыНЗП.Организация = &Организация
	|	И ТрудозатратыНЗП.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|
	|СГРУППИРОВАТЬ ПО
	|	ТрудозатратыНЗП.Подразделение,
	|	ТрудозатратыНЗП.Сотрудник
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Выработка.Подразделение,
	|	ТЧСотрудники.Сумма,
	|	ТЧСотрудники.Сотрудник
	|ИЗ
	|	Документ.ВыработкаСотрудников.Сотрудники КАК ТЧСотрудники
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ВыработкаСотрудников КАК Выработка
	|		ПО ТЧСотрудники.Ссылка = Выработка.Ссылка
	|ГДЕ
	|	ТЧСотрудники.Сотрудник В(&СписокФизическихЛиц)
	|	И Выработка.Проведен
	|	И Выработка.Организация = &Организация
	|	И Выработка.Дата МЕЖДУ &НачалоПериода И &КонецПериода
	|	И Выработка.ВидНаряда <> ЗНАЧЕНИЕ(Перечисление.ВидыБригадныхНарядов.Производство)
	|
	|СГРУППИРОВАТЬ ПО
	|	ТЧСотрудники.Сотрудник,
	|	Выработка.Подразделение,
	|	ТЧСотрудники.Сумма
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТБазаРаспределения.ПодразделениеПредприятия,
	|	СУММА(ВТБазаРаспределения.НормативнаяСтоимость) КАК Коэффициент,
	|	ВТБазаРаспределения.ФизическоеЛицо КАК ФизическоеЛицо
	|ИЗ
	|	ВТБазаРаспределения КАК ВТБазаРаспределения
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТБазаРаспределения.ПодразделениеПредприятия,
	|	ВТБазаРаспределения.ФизическоеЛицо
	|ИТОГИ ПО
	|	ФизическоеЛицо
	|;");
	
	СписокФизическихЛиц = ДанныеДляОтражения.НачисленнаяЗарплатаИВзносы.ВыгрузитьКолонку("ФизическоеЛицо");
	
	Запрос.УстановитьПараметр("СписокФизическихЛиц",    СписокФизическихЛиц);
	Запрос.УстановитьПараметр("НачалоПериода",          НачалоМесяца(СтруктураПараметров.ПериодРегистрации));
	Запрос.УстановитьПараметр("КонецПериода",           КонецМесяца(СтруктураПараметров.ПериодРегистрации));
	Запрос.УстановитьПараметр("Организация",            СтруктураПараметров.Организация);
	
	УстановитьПривилегированныйРежим(Истина);
	МассивРезультатов = Запрос.ВыполнитьПакет();
	
	ПодразделенияСдельщиков = МассивРезультатов[1].Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 4D:ERP для Беларуси, Яна, 04.09.2017 11:28:45 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826
	// {
	//Колонки = "ПФРЗаЗанятыхНаПодземныхИВредныхРаботах,ПФРЗаЗанятыхНаТяжелыхИПрочихРаботах,ПФРНаДоплатуЛетчикам,ПФРНаДоплатуШахтерам,ПФРНакопительная,ПФРПоСуммарномуТарифу,ПФРСтраховая,Сумма,ТФОМС,ФСС,ФССНесчастныеСлучаи,ФФОМС,ПФРСПревышения,ПФРДоПредельнойВеличины, ФСЗН, ПенсионныйФонд, Белгосстрах, ПС, СС";
	Колонки = "Сумма, ФСЗН, Белгосстрах";
	// }
	// 4D
		
	ТаблицаДополнения = ДанныеДляОтражения.НачисленнаяЗарплатаИВзносы.СкопироватьКолонки();
	
	МассивУдаляемыхСтрок = Новый Массив;
	
	Для Каждого Строка Из ДанныеДляОтражения.НачисленнаяЗарплатаИВзносы Цикл
		
		Если Строка.ВидОперации <> Перечисления.ВидыОперацийПоЗарплате.НачисленоСдельноДоход Тогда
			Продолжить;
		КонецЕсли;
		
		ПодразделенияСдельщиков.Сбросить();
		ПодразделенияСдельщиков.НайтиСледующий(Строка.ФизическоеЛицо, "ФизическоеЛицо");
		Выборка = ПодразделенияСдельщиков.Выбрать();
		
		Если Выборка.Количество() = 0 Тогда
			Продолжить;
		ИначеЕсли Выборка.Количество() = 1 Тогда
			
			Выборка.Следующий();
			Строка.ПодразделениеПредприятия = Выборка.ПодразделениеПредприятия;
			
			Продолжить;
		КонецЕсли;
		
		МассивКоэффициентов = Новый Массив;
		МассивПодразделений = Новый Массив;
		
		Пока Выборка.Следующий() Цикл
			МассивКоэффициентов.Добавить(Выборка.Коэффициент);
			МассивПодразделений.Добавить(Выборка.ПодразделениеПредприятия);
		КонецЦикла;
		
		МассивКолонок = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Колонки);
		
		МассивыРаспределений = Новый Структура();
		
		Для Каждого Колонка Из МассивКолонок Цикл
			
			Если Строка[Колонка] = 0 Тогда
				РезультатРаспределения = Новый Массив;
				Для Каждого Коэффициент Из МассивКоэффициентов Цикл
					РезультатРаспределения.Добавить(0);
				КонецЦикла;
			Иначе
				РезультатРаспределения = ОбщегоНазначения.РаспределитьСуммуПропорциональноКоэффициентам(Строка[Колонка], МассивКоэффициентов);
			КонецЕсли;
			
			МассивыРаспределений.Вставить(Колонка, РезультатРаспределения);
			
		КонецЦикла;
		
		Индекс = 0;
		
		Для Каждого Коэффициент Из МассивКоэффициентов Цикл
			
			НоваяСтрока = ТаблицаДополнения.Добавить();
			ЗаполнитьЗначенияСвойств(НоваяСтрока, Строка, , Колонки);
			
			Для Каждого Колонка Из МассивКолонок Цикл
				НоваяСтрока[Колонка] = МассивыРаспределений[Колонка][Индекс];
			КонецЦикла;
			
			НоваяСтрока.ПодразделениеПредприятия = МассивПодразделений[Индекс];
			
			Индекс = Индекс + 1;
			
		КонецЦикла;
		
		МассивУдаляемыхСтрок.Добавить(Строка);
		
	КонецЦикла;
	
	Для Каждого Строка Из МассивУдаляемыхСтрок Цикл
		ДанныеДляОтражения.НачисленнаяЗарплатаИВзносы.Удалить(Строка);
	КонецЦикла;
	
	ОбщегоНазначенияКлиентСервер.ДополнитьТаблицу(ТаблицаДополнения, ДанныеДляОтражения.НачисленнаяЗарплатаИВзносы);
	
КонецПроцедуры

Функция ВидыСуммВзносов()
	
	СписокВидовСумм = Новый Массив;
	
	// Начисление.
	ВидСуммыВзносов = СформироватьСтруктуруВидаСуммыВзноса(
		Перечисления.ВидыФондовВзносов.ПустаяСсылка(),
		Перечисления.ТипыНалогов.ПустаяСсылка(),
		"Сумма",
		Перечисления.ВидыПлатежейВГосБюджет.ПустаяСсылка(),
		"");
	СписокВидовСумм.Добавить(ВидСуммыВзносов);
	
	// 4D:ERP для Беларуси, АлексейЧ, 30.11.2017 9:28:32 
	// Локализовать документ "Отражение зарплаты в финансовом учете", №15826 
	// {
	
	// ФСЗН - страховые взносы.
	ВидСуммыВзносов = СформироватьСтруктуруВидаСуммыВзноса(
		Перечисления.ВидыФондовВзносов.ФСЗН,
		Перечисления.ТипыНалогов.ФСЗН,
		"ФСЗН",
		Перечисления.ВидыПлатежейВГосБюджет.Налог);
		
	СписокВидовСумм.Добавить(ВидСуммыВзносов);
	
	// Белгосстрах
	ВидСуммыВзносов = СформироватьСтруктуруВидаСуммыВзноса(
		Перечисления.ВидыФондовВзносов.Белгосстрах,
		Перечисления.ТипыНалогов.Белгосстрах,
		"Белгосстрах",
		Перечисления.ВидыПлатежейВГосБюджет.Налог);
		
	СписокВидовСумм.Добавить(ВидСуммыВзносов);
	
	// {	
	// 4D	
	
	Возврат СписокВидовСумм;
	
КонецФункции

Функция СформироватьСтруктуруВидаСуммыВзноса(ВидФондаВзносов, ТипНалога, Представление, ВидПлатежаВГосБюджет, Постфикс = "Взносов")
	
	ВидСуммыВзносов = Новый Структура();
	ВидСуммыВзносов.Вставить("ВидФондаВзносов",      ВидФондаВзносов);
	ВидСуммыВзносов.Вставить("ТипНалога",            ТипНалога);
	ВидСуммыВзносов.Вставить("Представление",        Представление);
	ВидСуммыВзносов.Вставить("Постфикс",             Постфикс);
	ВидСуммыВзносов.Вставить("ВидПлатежаВГосБюджет", ВидПлатежаВГосБюджет);
	
	Возврат ВидСуммыВзносов;
	
КонецФункции

Процедура ЗаполнитьСтатьиАналитикуРасходовПоУмолчанию(Объект, СтрокаТаблицы)
	
	// Получаем последние используемые значения по совпадающим сочетаниям заполненных полей
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Удержания.ФизическоеЛицо КАК ФизическоеЛицо,
	|	Удержания.ВидОперации КАК ВидОперации,
	|	Удержания.ПодразделениеПредприятия КАК ПодразделениеПредприятия,
	|	Удержания.Контрагент КАК Контрагент,
	|	Удержания.СтатьяАктивовПассивов КАК СтатьяАктивовПассивов
	|ПОМЕСТИТЬ ВТУдержаннаяЗарплата
	|ИЗ
	|	&УдержаннаяЗарплата КАК Удержания
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	НачисленныеПроценты.ФизическоеЛицо КАК ФизическоеЛицо,
	|	НачисленныеПроценты.ПодразделениеПредприятия КАК ПодразделениеПредприятия,
	|	НачисленныеПроценты.СтатьяДоходов КАК СтатьяДоходов
	|ПОМЕСТИТЬ ВТНачисленныеПроценты
	|ИЗ
	|	&НачисленныеПроцентыПоЗаймам КАК НачисленныеПроценты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Удержания.ФизическоеЛицо КАК ФизическоеЛицо,
	|	Удержания.ВидОперации КАК ВидОперации,
	|	Удержания.ПодразделениеПредприятия КАК ПодразделениеПредприятия,
	|	Удержания.Контрагент КАК Контрагент
	|ПОМЕСТИТЬ ВТНезаполненнаяАналитика
	|ИЗ
	|	ВТУдержаннаяЗарплата КАК Удержания
	|ГДЕ
	|	Удержания.СтатьяАктивовПассивов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ПустаяСсылка)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Удержания.ВидОперации
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	НачисленныеПроценты.ФизическоеЛицо КАК ФизическоеЛицо,
	|	НачисленныеПроценты.ПодразделениеПредприятия КАК ПодразделениеПредприятия
	|ПОМЕСТИТЬ ВТНезаполненнаяАналитикаДоходов
	|ИЗ
	|	ВТНачисленныеПроценты КАК НачисленныеПроценты
	|ГДЕ
	|	НачисленныеПроценты.СтатьяДоходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НачисленныеПроценты.ФизическоеЛицо,
	|	НачисленныеПроценты.ПодразделениеПредприятия";
	
	МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("УдержаннаяЗарплата",          Объект.УдержаннаяЗарплата.Выгрузить());
	Запрос.УстановитьПараметр("НачисленныеПроцентыПоЗаймам", Объект.НачисленныеПроцентыПоЗаймам.Выгрузить());
	Запрос.Выполнить();
	
	Документы.ОтражениеЗарплатыВФинансовомУчете.СоздатьВТАналитикаДругихДокументов(МенеджерВременныхТаблиц, Объект.Ссылка, Объект.Дата);
	
	Если Найти(СтрокаТаблицы, "УдержаннаяЗарплата") Тогда
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	АналитикаДругихДокументов.ФизическоеЛицо КАК ФизическоеЛицо,
		|	АналитикаДругихДокументов.ВидОперации КАК ВидОперации,
		|	АналитикаДругихДокументов.ПодразделениеПредприятия КАК ПодразделениеПредприятия,
		|	АналитикаДругихДокументов.СтатьяАктивовПассивов КАК СтатьяАктивовПассивов,
		|	АналитикаДругихДокументов.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
		|	АналитикаДругихДокументов.СчетУчета КАК СчетУчета,
		|	АналитикаДругихДокументов.Субконто1 КАК Субконто1,
		|	АналитикаДругихДокументов.Субконто2 КАК Субконто2,
		|	АналитикаДругихДокументов.Субконто3 КАК Субконто3,
		|	3 КАК ТипСтатьи
		|ИЗ
		|	ЗаполненнаяСтатьяПассивов КАК АналитикаДругихДокументов";
		
		Запрос = Новый Запрос(ТекстЗапроса);
		Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;
		РезультатЗапроса = Запрос.Выполнить();
		
		ОтборСтрок = Новый Структура("ФизическоеЛицо, ВидОперации, ПодразделениеПредприятия");
		
		Выборка = РезультатЗапроса.Выбрать();
		Пока Выборка.Следующий() Цикл
			ЗаполнитьЗначенияСвойств(ОтборСтрок, Выборка);
			
			НайденныеСтроки = Объект.УдержаннаяЗарплата.НайтиСтроки(ОтборСтрок);
			
			Для Каждого НайденнаяСтрока Из НайденныеСтроки Цикл
				
				ИсключаемыеПоля = "";
				Если ТипЗнч(Выборка.Субконто1) = Тип("СправочникСсылка.Контрагенты") И ЗначениеЗаполнено(НайденнаяСтрока.Контрагент) Тогда
					НайденнаяСтрока.Субконто1 = НайденнаяСтрока.Контрагент;
					ИсключаемыеПоля = "Субконто1";
				КонецЕсли;
				
				Если ТипЗнч(Выборка.Субконто1) = Тип("СправочникСсылка.СтруктураПредприятия") И ЗначениеЗаполнено(НайденнаяСтрока.ПодразделениеПредприятия) Тогда
					НайденнаяСтрока.Субконто1 = НайденнаяСтрока.ПодразделениеПредприятия;
					Если ЗначениеЗаполнено(ИсключаемыеПоля) Тогда
						ИсключаемыеПоля = ИсключаемыеПоля + ",ПодразделениеПредприятия";
					Иначе
						ИсключаемыеПоля = "ПодразделениеПредприятия";
					КонецЕсли;
				КонецЕсли;
				
				Если ТипЗнч(Выборка.Субконто1) = Тип("СправочникСсылка.СтатьиДвиженияДенежныхСредств") И ЗначениеЗаполнено(НайденнаяСтрока.ЦельВыдачи) Тогда
					НайденнаяСтрока.Субконто1 = НайденнаяСтрока.ЦельВыдачи;
					Если ЗначениеЗаполнено(ИсключаемыеПоля) Тогда
						ИсключаемыеПоля = ИсключаемыеПоля + ",ЦельВыдачи";
					Иначе
						ИсключаемыеПоля = "ЦельВыдачи";
					КонецЕсли;
				КонецЕсли;
				
				Если ТипЗнч(Выборка.Субконто1) = Тип("СправочникСсылка.ФизическиеЛица") И ЗначениеЗаполнено(НайденнаяСтрока.ФизическоеЛицо) Тогда
					НайденнаяСтрока.Субконто1 = НайденнаяСтрока.ФизическоеЛицо;
					Если ЗначениеЗаполнено(ИсключаемыеПоля) Тогда
						ИсключаемыеПоля = ИсключаемыеПоля + ",ФизическоеЛицо";
					Иначе
						ИсключаемыеПоля = "ФизическоеЛицо";
					КонецЕсли;
				КонецЕсли;
				
				ЗаполнитьЗначенияСвойств(НайденнаяСтрока, Выборка,,ИсключаемыеПоля);
				Если ТипЗнч(Объект) <> Тип("ДокументОбъект.ОтражениеЗарплатыВФинансовомУчете") Тогда
					НайденнаяСтрока.ПредставлениеОтраженияВРеглУчете = РеглУчетВызовСервера.ПредставлениеОтраженияВРеглУчете(НайденнаяСтрока)
				КонецЕсли;
			КонецЦикла;
			
		КонецЦикла;
	КонецЕсли;
	
	Если Найти(СтрокаТаблицы, "НачисленныеПроцентыПоЗаймам") Тогда
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	АналитикаДругихДокументов.ФизическоеЛицо КАК ФизическоеЛицо,
		|	АналитикаДругихДокументов.ПодразделениеПредприятия КАК ПодразделениеПредприятия,
		|	АналитикаДругихДокументов.СтатьяДоходов КАК СтатьяДоходов,
		|	АналитикаДругихДокументов.АналитикаДоходов КАК АналитикаДоходов
		|ИЗ
		|	ВТЗаполненнаяСтатьяДоходов КАК АналитикаДругихДокументов";
		
		Запрос = Новый Запрос(ТекстЗапроса);
		Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;
		РезультатЗапроса = Запрос.Выполнить();
		
		ОтборСтрок = Новый Структура("ФизическоеЛицо, ПодразделениеПредприятия");
		
		Выборка = РезультатЗапроса.Выбрать();
		Пока Выборка.Следующий() Цикл
			ЗаполнитьЗначенияСвойств(ОтборСтрок, Выборка);
			
			НайденныеСтроки = Объект.НачисленныеПроцентыПоЗаймам.НайтиСтроки(ОтборСтрок);
			Для Каждого НайденнаяСтрока Из НайденныеСтроки Цикл
				НайденнаяСтрока.СтатьяДоходов    = Выборка.СтатьяДоходов;
				НайденнаяСтрока.АналитикаДоходов = Выборка.АналитикаДоходов;
			КонецЦикла;
			
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры

Процедура ВыделитьОтпускаЗаСчетОценочныхОбязательств(ДанныеДляОтражения, СтруктураПараметров)
	
	Если Не ДанныеДляОтражения.Свойство("НачисленнаяЗарплатаИВзносы") Тогда
		Возврат;
	КонецЕсли;
	
	Если Не ОбщегоНазначения.ПодсистемаСуществует("ЗарплатаКадрыПриложения.ОценочныеОбязательстваЗарплатаКадры") Тогда
		Возврат;
	КонецЕсли;
	
	НастройкиРезервов = РезервОтпусков.НастройкиРезервовОтпусков(СтруктураПараметров.Организация, СтруктураПараметров.ПериодРегистрации);
	
	Если Не НастройкиРезервов.ФормироватьРезервОтпусковБУ Тогда
		Возврат;
	КонецЕсли;
	
	Если НастройкиРезервов.ФормироватьРезервОтпусковНУ Тогда
		ВидОперацииРезервы   = Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательстваИРезервы;
	Иначе
		ВидОперацииРезервы = Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускОценочныеОбязательства;
	КонецЕсли;
	
	НачисленнаяЗарплатаИВзносы = ДанныеДляОтражения.НачисленнаяЗарплатаИВзносы;
	
	КолонкиДляСуммированияСтрокой = КолонкиДляСуммирования(Ложь);
	КолонкиДляСуммирования = Новый Структура(КолонкиДляСуммированияСтрокой);

	ТаблицаВыплатЗаСчетРезерва = ТаблицаВыплатЗаСчетРезерва(СтруктураПараметров);
	
	РаспределяемыеСтроки = НачисленнаяЗарплатаИВзносы.НайтиСтроки(Новый Структура("ВидОперации", Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпуск));
	
	ДопРаспределяемыеСтроки = НачисленнаяЗарплатаИВзносы.НайтиСтроки(Новый Структура("ВидОперации", Перечисления.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпуска));
	
	ОбщегоНазначенияКлиентСервер.ДополнитьМассив(РаспределяемыеСтроки, ДопРаспределяемыеСтроки);
	
	ОтборСотрудник = Новый Структура("Сотрудник");
	
	Для Каждого Строка Из РаспределяемыеСтроки Цикл
		
		ОтборСотрудник.Сотрудник = Строка.Сотрудник;
		
		ВыплатыЗаСчетРезерва = ТаблицаВыплатЗаСчетРезерва.НайтиСтроки(ОтборСотрудник);
		
		Если ВыплатыЗаСчетРезерва.Количество() = 0 Тогда
			Продолжить;
		КонецЕсли;
		
		СтрокаВыплаты = ВыплатыЗаСчетРезерва[0];
		
		ВзносыПоСтроке = СтруктураВзносовПоСтроке(Строка, КолонкиДляСуммирования);
		
		Если Строка.Сумма <= СтрокаВыплаты.СуммаВыбыло И ВзносыПоСтроке.Взносы <= СтрокаВыплаты.ВзносыВыбыло И ВзносыПоСтроке.ВзносыФССНС <= СтрокаВыплаты.ВзносыФССНСВыбыло Тогда
			
			Если Строка.ВидОперации = Перечисления.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпуска Тогда
				Строка.ВидОперации = Перечисления.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства;
			Иначе
				Строка.ВидОперации = ВидОперацииРезервы;
			КонецЕсли;
			
			СтрокаВыплаты.СуммаВыбыло = СтрокаВыплаты.СуммаВыбыло - Строка.Сумма;
			СтрокаВыплаты.ВзносыВыбыло = СтрокаВыплаты.ВзносыВыбыло -  ВзносыПоСтроке.Взносы;
			СтрокаВыплаты.ВзносыФССНСВыбыло = СтрокаВыплаты.ВзносыФССНСВыбыло -  ВзносыПоСтроке.ВзносыФССНС;
			
		ИначеЕсли Строка.Сумма > СтрокаВыплаты.СуммаВыбыло Или ВзносыПоСтроке.Взносы > СтрокаВыплаты.ВзносыВыбыло Или ВзносыПоСтроке.ВзносыФССНС > СтрокаВыплаты.ВзносыФССНСВыбыло Тогда
			
			НоваяСтрока = НачисленнаяЗарплатаИВзносы.Вставить(НачисленнаяЗарплатаИВзносы.Индекс(Строка) + 1);
			
			ЗаполнитьЗначенияСвойств(НоваяСтрока, Строка, , "Сумма, " + КолонкиДляСуммированияСтрокой);
			
			Если Строка.ВидОперации = Перечисления.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпуска Тогда
				НоваяСтрока.ВидОперации = Перечисления.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпускаОценочныеОбязательства;
			Иначе
				НоваяСтрока.ВидОперации = ВидОперацииРезервы;
			КонецЕсли;
			
			СуммаРезерв = Мин(Строка.Сумма, СтрокаВыплаты.СуммаВыбыло);
			НоваяСтрока.Сумма = СуммаРезерв;
			Строка.Сумма = Строка.Сумма - НоваяСтрока.Сумма;
			
			ФССНСРезерв = Мин(Строка.ФССНесчастныеСлучаи, СтрокаВыплаты.ВзносыФССНСВыбыло);
			НоваяСтрока.ФССНесчастныеСлучаи = ФССНСРезерв;
			Строка.ФССНесчастныеСлучаи = Строка.ФССНесчастныеСлучаи - НоваяСтрока.ФССНесчастныеСлучаи;
			
			ВзносыРезерв    = Мин(ВзносыПоСтроке.Взносы, СтрокаВыплаты.ВзносыВыбыло);
			Распределение = ОбщегоНазначения.РаспределитьСуммуПропорциональноКоэффициентам(ВзносыРезерв, ВзносыПоСтроке.МассивВзносов);
			
			Если Распределение <> Неопределено Тогда
				Индекс = 0;
				Для Каждого Взнос Из КолонкиДляСуммирования Цикл
					НоваяСтрока[Взнос.Ключ] = Распределение[Индекс];
					Строка[Взнос.Ключ] = Строка[Взнос.Ключ] - НоваяСтрока[Взнос.Ключ];
					Индекс = Индекс + 1;
				КонецЦикла;
			КонецЕсли;
			
			СтрокаВыплаты.СуммаВыбыло = СтрокаВыплаты.СуммаВыбыло - СуммаРезерв;
			СтрокаВыплаты.ВзносыВыбыло = СтрокаВыплаты.ВзносыВыбыло - ВзносыРезерв;
			СтрокаВыплаты.ВзносыФССНСВыбыло = СтрокаВыплаты.ВзносыФССНСВыбыло - ФССНСРезерв;
			
			Если НастройкиРезервов.ФормироватьРезервОтпусковНУ И Строка.ВидОперации <> Перечисления.ВидыОперацийПоЗарплате.КомпенсацияЕжегодногоОтпуска Тогда
				Строка.ВидОперации = Перечисления.ВидыОперацийПоЗарплате.ЕжегодныйОтпускРезервы;
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЦикла;
	
КонецПроцедуры

Функция ТаблицаВыплатЗаСчетРезерва(СтруктураПараметров)
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	Выплаты.Сотрудник КАК Сотрудник,
		|	СУММА(Выплаты.СуммаРезерваВыбылоОборот) КАК СуммаВыбыло,
		|	СУММА(Выплаты.СуммаРезерваСтраховыхВзносовВыбылоОборот) КАК ВзносыВыбыло,
		|	СУММА(Выплаты.СуммаРезерваФССНесчастныеСлучаиВыбылоОборот) КАК ВзносыФССНСВыбыло
		|ИЗ
		|	РегистрНакопления.ВыплатаОтпусковЗаСчетРезерва.Обороты(&НачалоПериода, &КонецПериода, , Организация = &Организация) КАК Выплаты
		|
		|СГРУППИРОВАТЬ ПО
		|	Выплаты.Сотрудник";
	
	Запрос.УстановитьПараметр("НачалоПериода", НачалоМесяца(СтруктураПараметров.ПериодРегистрации));
	Запрос.УстановитьПараметр("КонецПериода", КонецМесяца(СтруктураПараметров.ПериодРегистрации));
	Запрос.УстановитьПараметр("Организация", СтруктураПараметров.Организация);
	
	Возврат Запрос.Выполнить().Выгрузить();
	
КонецФункции

Функция СтруктураВзносовПоСтроке(Строка, КолонкиДляСуммирования)
	
	Взносы = 0;
	ВзносыФСС = 0;
	МассивВзносов = Новый Массив;
	
	Для Каждого Колонка Из КолонкиДляСуммирования Цикл
		Взносы = Взносы + Строка[Колонка.Ключ];
		МассивВзносов.Добавить(Строка[Колонка.Ключ]);
	КонецЦикла;
	
	Возврат Новый Структура("Взносы, ВзносыФССНС, МассивВзносов", Взносы, Строка.ФССНесчастныеСлучаи, МассивВзносов);
	
КонецФункции

#Область ОбновлениеИнформационнойБазы

Функция ПолноеИмяОбъекта()
	Возврат "Документ.ОтражениеЗарплатыВФинансовомУчете";
КонецФункции

Процедура ЗарегистрироватьДанныеКОбработкеДляПереходаНаНовуюВерсию(Параметры) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст =
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ОтражениеЗарплатыВФинансовомУчетеНачисленныйНДФЛ.Ссылка
		|ИЗ
		|	Документ.ОтражениеЗарплатыВФинансовомУчете.НачисленныйНДФЛ КАК ОтражениеЗарплатыВФинансовомУчетеНачисленныйНДФЛ
		|ГДЕ
		|	ОтражениеЗарплатыВФинансовомУчетеНачисленныйНДФЛ.ТипНалога = ЗНАЧЕНИЕ(Перечисление.ТипыНалогов.ПустаяСсылка)";
	
	ОбновлениеИнформационнойБазы.ОтметитьКОбработке(Параметры, Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Ссылка"));
	
КонецПроцедуры
Процедура ОбработатьДанныеДляПереходаНаНовуюВерсию(Параметры) Экспорт
	
	МетаданныеДокумента = Метаданные.НайтиПоПолномуИмени(ПолноеИмяОбъекта());
	Выборка = ОбновлениеИнформационнойБазы.ВыбратьСсылкиДляОбработки(Параметры.Очередь, ПолноеИмяОбъекта());
	
	Пока Выборка.Следующий() Цикл
		
		НачатьТранзакцию();
		
		Попытка
			
			Блокировка = Новый БлокировкаДанных;
			ЭлементБлокировки = Блокировка.Добавить(ПолноеИмяОбъекта());
			ЭлементБлокировки.УстановитьЗначение("Ссылка", Выборка.Ссылка);
			Блокировка.Заблокировать();
			
		Исключение
			
			ОтменитьТранзакцию();
			ТекстСообщения = НСтр("ru = 'Не удалось заблокировать документ: %Ссылка% по причине: %Причина%'");
			ТекстСообщения = СтрЗаменить(ТекстСообщения, "%Ссылка%", Выборка.Ссылка);
			ТекстСообщения = СтрЗаменить(ТекстСообщения, "%Причина%", ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
			ЗаписьЖурналаРегистрации(ОбновлениеИнформационнойБазы.СобытиеЖурналаРегистрации(),
									УровеньЖурналаРегистрации.Предупреждение,
									МетаданныеДокумента,
									Выборка.Ссылка,
									ТекстСообщения);
			Продолжить;
			
		КонецПопытки;
			
		ДокументОбъект = Выборка.Ссылка.ПолучитьОбъект();
		
		Если ДокументОбъект = Неопределено Тогда
			
			ОтменитьТранзакцию();
			Продолжить;
			
		КонецЕсли;
		
		Для Каждого НДФЛ Из ДокументОбъект.НачисленныйНДФЛ Цикл
			
			Если Не ЗначениеЗаполнено(НДФЛ.ТипНалога) Тогда
				НДФЛ.ТипНалога = Перечисления.ТипыНалогов.ТипНалогаОперацииПоЗарплаты(НДФЛ.ВидОперации);
			КонецЕсли;
			
		КонецЦикла;
		
		Если ДокументОбъект.Модифицированность() Тогда
			
			Попытка
				
				ОбновлениеИнформационнойБазы.ЗаписатьОбъект(ДокументОбъект, , , РежимЗаписиДокумента.Запись);
				ЗафиксироватьТранзакцию();
				
			Исключение
				
				ОтменитьТранзакцию();
				ТекстСообщения = НСтр("ru = 'Не удалось обработать документ: %Ссылка% по причине: %Причина%'");
				ТекстСообщения = СтрЗаменить(ТекстСообщения, "%Ссылка%", Выборка.Ссылка);
				ТекстСообщения = СтрЗаменить(ТекстСообщения, "%Причина%", ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
				ЗаписьЖурналаРегистрации(ОбновлениеИнформационнойБазы.СобытиеЖурналаРегистрации(),
					УровеньЖурналаРегистрации.Предупреждение,
					МетаданныеДокумента,
					Выборка.Ссылка,
					ТекстСообщения);
					
				ВызватьИсключение;
				
			КонецПопытки;
			
		Иначе
			
			ОбновлениеИнформационнойБазы.ОтметитьВыполнениеОбработки(Выборка.Ссылка);
			ЗафиксироватьТранзакцию();
			
		КонецЕсли;
		
	КонецЦикла;
	
	Параметры.ОбработкаЗавершена = Не ОбновлениеИнформационнойБазы.ЕстьДанныеДляОбработки(Параметры.Очередь, ПолноеИмяОбъекта());
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти

#Область БлокировкаПриОбновленииИБ

Процедура ПроверитьБлокировкуВходящихДанныхПриОбновленииИБ(ПредставлениеОперации)
	
	ВходящиеДанные = Новый Соответствие;
	
	// из БазаРаспределенияТрудозатрат()
	ВходящиеДанные.Вставить(Метаданные.Документы.ВыработкаСотрудников);
	//++ НЕ УТКА
	ВходящиеДанные.Вставить(Метаданные.Документы.ЗаказНаПроизводство);
	ВходящиеДанные.Вставить(Метаданные.Документы.ЗаказНаРемонт);
	//-- НЕ УТКА
	ВходящиеДанные.Вставить(Метаданные.Документы.ОтражениеЗарплатыВФинансовомУчете);
	ВходящиеДанные.Вставить(Метаданные.РегистрыНакопления.ТрудозатратыНезавершенногоПроизводства);
	
	ЗакрытиеМесяцаУТВызовСервера.ПроверитьБлокировкуВходящихДанныхПриОбновленииИБ(ВходящиеДанные, ПредставлениеОперации);
	
КонецПроцедуры

#КонецОбласти

#Область Прочее

Функция ПараметрыВыбораСтруктурой(ПараметрыВыбора)
	
	ПараметрыСтруктурой = Новый Структура;
	ПараметрыСтруктурой.Вставить("СтрокаПоиска", "");
	
	Отбор = Новый Структура;
	
	Для Каждого ПараметрВыбора Из ПараметрыВыбора Цикл
		
		ИмяПараметра = НРег(ПараметрВыбора.Имя);
		Если СтрНайти(ИмяПараметра, "отбор.") > 0 Тогда
			
			ИмяПараметра = Сред(ПараметрВыбора.Имя, Найти(ИмяПараметра, "отбор.") + 6);
			Отбор.Вставить(ИмяПараметра, ПараметрВыбора.Значение);
			
		Иначе
			ПараметрыСтруктурой.Вставить(ПараметрВыбора.Имя, ПараметрВыбора.Значение);
		КонецЕсли;
		
	КонецЦикла;
	
	ПараметрыСтруктурой.Вставить("Отбор", Отбор);
	
	Возврат ПараметрыСтруктурой;
	
КонецФункции

#КонецОбласти

#КонецЕсли
